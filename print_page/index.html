<!-- Elements added to main will be displayed on all pages -->

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Building Microservices with Containers (A Practical Guide)  ">
      
      
        <meta name="author" content="Anji Keesari">
      
      
        <link rel="canonical" href="https://akeesari.github.io/microservices/print_page/">
      
      
      
      
      <link rel="icon" href="../assets/images/ak-logo.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Print - Building Microservices with Containers (A Practical Guide)</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("/microservices/",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-KR7ZFHXJM1"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-KR7ZFHXJM1",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-KR7ZFHXJM1",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();
        })
        </script>
        </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#section-1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Building Microservices with Containers (A Practical Guide)" class="md-header__button md-logo" aria-label="Building Microservices with Containers (A Practical Guide)" data-md-component="logo">
      
  <img src="../assets/images/ak-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Building Microservices with Containers (A Practical Guide)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href=".." class="md-tabs__link">
          
  
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../introduction/toc/" class="md-tabs__link">
          
  
  
    
  
  Introduction

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../microservices/1.getting-started/" class="md-tabs__link">
          
  
  
    
  
  Microservices

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../appendix/git-cheat-sheet/" class="md-tabs__link">
          
  
  
    
  
  Appendix

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  Print

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Building Microservices with Containers (A Practical Guide)" class="md-nav__button md-logo" aria-label="Building Microservices with Containers (A Practical Guide)" data-md-component="logo">
      
  <img src="../assets/images/ak-logo.png" alt="logo">

    </a>
    Building Microservices with Containers (A Practical Guide)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href=".." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/toc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Table of Contents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/about-author/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About the Author
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/acknowledgments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Acknowledgments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Microservices
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Microservices
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../microservices/1.getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started with Microservices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../microservices/2.docker-fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker Fundamentals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../microservices/3-docker-getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started with Docker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../microservices/4.aspnet-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Containerize a .NET Core Web API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../microservices/5.node-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Containerize a Node.js API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../microservices/6.aspnet-app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Containerize a .NET Core MVC Application
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../microservices/7.react-app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Containerize a React.js Application
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../microservices/8.sqlserver-db/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create Your First Database with SQL server
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../microservices/9.postgresql-db/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create Your Second Database with PostgreSQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../microservices/10.keycloak/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running Keycloak application in a Docker Container
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../microservices/11.drupal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running Drupal Website in a Docker Container
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Appendix
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Appendix
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../appendix/git-cheat-sheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git Cheat Sheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../appendix/docker-cheat-sheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker Cheat Sheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../appendix/dockerfile-cheat-sheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dockerfile Cheat Sheet
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Print
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Print
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#section-1" class="md-nav__link">
    <span class="md-ellipsis">
      Home
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-2" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction-toc" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#introduction-about-author" class="md-nav__link">
    <span class="md-ellipsis">
      About the Author
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#introduction-acknowledgments" class="md-nav__link">
    <span class="md-ellipsis">
      Acknowledgments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#introduction-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-3" class="md-nav__link">
    <span class="md-ellipsis">
      Microservices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Microservices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microservices-1.getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started with Microservices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-2.docker-fundamentals" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Fundamentals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-3-docker-getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started with Docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-4.aspnet-api" class="md-nav__link">
    <span class="md-ellipsis">
      Containerize a .NET Core Web API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-5.node-api" class="md-nav__link">
    <span class="md-ellipsis">
      Containerize a Node.js API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-6.aspnet-app" class="md-nav__link">
    <span class="md-ellipsis">
      Containerize a .NET Core MVC Application
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-7.react-app" class="md-nav__link">
    <span class="md-ellipsis">
      Containerize a React.js Application
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-8.sqlserver-db" class="md-nav__link">
    <span class="md-ellipsis">
      Create Your First Database with SQL server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-9.postgresql-db" class="md-nav__link">
    <span class="md-ellipsis">
      Create Your Second Database with PostgreSQL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-10.keycloak" class="md-nav__link">
    <span class="md-ellipsis">
      Running Keycloak application in a Docker Container
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-11.drupal" class="md-nav__link">
    <span class="md-ellipsis">
      Running Drupal Website in a Docker Container
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-4" class="md-nav__link">
    <span class="md-ellipsis">
      Appendix
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Appendix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#appendix-git-cheat-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      Git Cheat Sheet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#appendix-docker-cheat-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Cheat Sheet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#appendix-dockerfile-cheat-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerfile Cheat Sheet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#section-1" class="md-nav__link">
    <span class="md-ellipsis">
      Home
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-2" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction-toc" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#introduction-about-author" class="md-nav__link">
    <span class="md-ellipsis">
      About the Author
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#introduction-acknowledgments" class="md-nav__link">
    <span class="md-ellipsis">
      Acknowledgments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#introduction-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-3" class="md-nav__link">
    <span class="md-ellipsis">
      Microservices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Microservices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microservices-1.getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started with Microservices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-2.docker-fundamentals" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Fundamentals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-3-docker-getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started with Docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-4.aspnet-api" class="md-nav__link">
    <span class="md-ellipsis">
      Containerize a .NET Core Web API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-5.node-api" class="md-nav__link">
    <span class="md-ellipsis">
      Containerize a Node.js API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-6.aspnet-app" class="md-nav__link">
    <span class="md-ellipsis">
      Containerize a .NET Core MVC Application
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-7.react-app" class="md-nav__link">
    <span class="md-ellipsis">
      Containerize a React.js Application
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-8.sqlserver-db" class="md-nav__link">
    <span class="md-ellipsis">
      Create Your First Database with SQL server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-9.postgresql-db" class="md-nav__link">
    <span class="md-ellipsis">
      Create Your Second Database with PostgreSQL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-10.keycloak" class="md-nav__link">
    <span class="md-ellipsis">
      Running Keycloak application in a Docker Container
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-11.drupal" class="md-nav__link">
    <span class="md-ellipsis">
      Running Drupal Website in a Docker Container
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-4" class="md-nav__link">
    <span class="md-ellipsis">
      Appendix
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Appendix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#appendix-git-cheat-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      Git Cheat Sheet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#appendix-docker-cheat-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Cheat Sheet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#appendix-dockerfile-cheat-sheet" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerfile Cheat Sheet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                




                  



<div id="print-site-page" class="">
                    <section class='print-page md-section' id='section-1' heading-number='1'>
                        <h1>Home<a class='headerlink' href='#section-1' title='Permanent link'></a>
                        </h1>
                    </section>
                    <section class='print-page md-section' id='section-2' heading-number='2'>
                        <h1>Introduction<a class='headerlink' href='#section-2' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="introduction-toc" heading-number="2.1"><h1 id="introduction-toc-table-of-contents">Table of Contents</h1>
<ul>
<li><a href="#introduction-about-author">About the Author</a></li>
<li><a href="#introduction-acknowledgments">Acknowledgments</a></li>
<li><a href="#introduction-introduction">Introduction</a></li>
</ul>
<!-- [**Building Containerized Microservices**](../microservices/1.getting-started.md) -->

<ul>
<li><a href="#microservices-1.getting-started">Chapter-1: Getting Started with Microservices</a><ul>
<li><a href="#microservices-1.getting-started-what-are-microservices">What are Microservices?</a></li>
<li><a href="#microservices-1.getting-started-microservices-vs-monolithic-architectures">Microservices vs Monolithic Architectures</a></li>
<li><a href="#microservices-1.getting-started-advantages-of-microservices">Advantages of Microservices</a></li>
<li><a href="#microservices-1.getting-started-challenges-and-considerations">Challenges and Considerations</a></li>
<li><a href="#microservices-1.getting-started-key-technologies-and-tools">Key Technologies and Tools</a></li>
<li><a href="#microservices-1.getting-started-microservices-communication">Microservices Communication</a></li>
<li><a href="#microservices-1.getting-started-domain-driven-design-ddd">Domain-Driven Design (DDD)</a></li>
<li><a href="#microservices-1.getting-started-task-1-identify-microservices-for-the-book">Task-1: Identify Microservices for the book</a></li>
<li><a href="#microservices-1.getting-started-task-2-identify-the-list-of-git-repositories-needed">Task-2: Identify the List of Git Repositories Needed</a></li>
<li><a href="#microservices-1.getting-started-task-3-create-new-azure-devops-organization">Task-3: Create new Azure DevOps Organization</a></li>
<li><a href="#microservices-1.getting-started-task-4-create-new-azure-devops-project">Task-4: Create new Azure DevOps Project</a></li>
</ul>
</li>
<li><a href="#microservices-2.docker-fundamentals">Chapter-2: Docker Fundamentals</a><ul>
<li><a href="#microservices-2.docker-fundamentals-overview">Overview</a></li>
<li><a href="#microservices-2.docker-fundamentals-what-is-docker">What is Docker?</a></li>
<li><a href="#microservices-2.docker-fundamentals-why-use-docker">Why use Docker?</a></li>
<li><a href="#microservices-2.docker-fundamentals-docker-concepts">Docker concepts</a></li>
<li><a href="#microservices-2.docker-fundamentals-container-orchestration">Container orchestration</a></li>
<li><a href="#microservices-2.docker-fundamentals-docker-desktop">Docker Desktop</a></li>
<li><a href="#microservices-2.docker-fundamentals-install-docker">Install Docker</a></li>
<li><a href="#microservices-2.docker-fundamentals-docker-commands">Docker Commands</a></li>
</ul>
</li>
<li><a href="#microservices-3-docker-getting-started">Chapter-3: Getting Started with Docker</a><ul>
<li><a href="#microservices-3-docker-getting-started-step-1-get-the-sample-application">Step 1: Get the Sample Application</a></li>
<li><a href="#microservices-3-docker-getting-started-step-2-create-docker-image">Step 2: Create Docker Image</a></li>
<li><a href="#microservices-3-docker-getting-started-step-3-create-docker-container">Step 3: Create Docker Container</a></li>
<li><a href="#microservices-3-docker-getting-started-step-4-port-binding">Step 4: Port Binding</a></li>
<li><a href="#microservices-3-docker-getting-started-step-5-browse-the-frontend-application">Step 5: Browse the Frontend Application</a></li>
<li><a href="#microservices-3-docker-getting-started-step-6-view-docker-logs">Step 6: View Docker Logs</a></li>
<li><a href="#microservices-3-docker-getting-started-step-7-docker-commands">Step 7: Docker Commands</a></li>
</ul>
</li>
<li><a href="#microservices-4.aspnet-api">Chapter-4: Create Your First Microservice with .NET Core Web API</a><ul>
<li><a href="#microservices-4.aspnet-api-step-1-create-a-new-repo-in-azure-devops">Step-1: Create a new repo in azure DevOps</a></li>
<li><a href="#microservices-4.aspnet-api-step-2-clone-the-repo-from-azure-devops">Step-2: Clone the repo from azure DevOps</a></li>
<li><a href="#microservices-4.aspnet-api-step-3-create-a-new-net-core-web-api-project">Step-3: Create a new .NET Core Web API project</a></li>
<li><a href="#microservices-4.aspnet-api-step-4-test-the-new-net-core-web-api-project">Step-4: Test the new .NET core Web API project</a></li>
<li><a href="#microservices-4.aspnet-api-step-5-add-dockerfiles-to-the-api-project">Step-5: Add Dockerfiles to the API project</a></li>
<li><a href="#microservices-4.aspnet-api-step-6-docker-build--run">Step-6: Docker Build &amp; Run</a></li>
<li><a href="#microservices-4.aspnet-api-step-7-push-docker-container-to-acr">Step-7: Push docker container to ACR</a></li>
<li><a href="#microservices-4.aspnet-api-step-8-pull-docker-container-from-acr">Step-8: Pull docker container from ACR</a></li>
</ul>
</li>
<li><a href="#microservices-5.node-api">Chapter-5: Create Your Second Microservice with Node.js</a><ul>
<li><a href="#microservices-5.node-api-step-1-setup-repository-in-azure-devops">Step-1: Setup repository in Azure DevOps.</a></li>
<li><a href="#microservices-5.node-api-step-2-create-a-new-node-js-api-project">Step-2: Create a new Node JS API project</a></li>
<li><a href="#microservices-5.node-api-step-3-test-the-node-js-api-project">Step-3: Test the Node JS API project</a></li>
<li><a href="#microservices-5.node-api-step-4-add-dockerfiles-to-the-mvc-project">Step-4: Add Dockerfiles to the MVC project</a></li>
<li><a href="#microservices-5.node-api-step-5-docker-build-locally">Step-5: Docker build locally</a></li>
<li><a href="#microservices-5.node-api-step-6-docker-run-locally">Step-6: Docker run locally</a></li>
<li><a href="#microservices-5.node-api-step-7-push-docker-container-to-acr">Step-7: Push docker container to ACR</a></li>
</ul>
</li>
<li><a href="#microservices-6.aspnet-app-step-1-create-a-new-aspnet-core-web-app-mvc-project">Chapter-6: Create Your First Website using .NET Core MVC Application</a><ul>
<li><a href="#microservices-6.aspnet-app-step-2-test-the-new-aspnet-core-web-app-project">Step-1: Create a new ASP.NET Core Web App (MVC project)</a></li>
<li><a href="#microservices-6.aspnet-app-step-2-test-the-new-aspnet-core-web-app-project">Step-2: Test the new ASP.NET core Web App project</a></li>
<li><a href="#microservices-6.aspnet-app-step-3-update-home-page-contentsoptional">Step-3: Update home page contents[Optional]</a></li>
<li><a href="#microservices-6.aspnet-app-step-4-add-dockerfiles-to-the-mvc-project">Step-4: Add Dockerfiles to the MVC project</a></li>
<li><a href="#microservices-6.aspnet-app-step-5-docker-build-locally">Step-5: Docker Build locally</a></li>
<li><a href="#microservices-6.aspnet-app-step-6-docker-run-locally">Step-6: Docker Run locally</a></li>
<li><a href="#microservices-6.aspnet-app-step-7-push-docker-container-to-acr">Step-7: Push docker container to ACR</a></li>
</ul>
</li>
<li><a href="#microservices-7.react-app">Chapter-7: Create Your Second Website using React.js</a><ul>
<li><a href="#microservices-7.react-app-step-1-install-nodejs-and-npm">Step-1: Install Node.js and NPM</a></li>
<li><a href="#microservices-7.react-app-step-2-create-a-new-react-js-application">Step-2: Create a new React JS application</a></li>
<li><a href="#microservices-7.react-app-step-3-add-dockerfiles-to-the-mvc-project">Step-3: Add Dockerfiles to the MVC project</a></li>
<li><a href="#microservices-7.react-app-step-4-docker-build-locally">Step-4: Docker Build locally</a></li>
<li><a href="#microservices-7.react-app-step-5-docker-run-locally">Step-5: Docker Run locally</a></li>
<li><a href="#microservices-7.react-app-step-6-push-docker-container-to-acr">Step-6: Push docker container to ACR</a></li>
</ul>
</li>
<li><a href="#microservices-8.sqlserver-db">Chapter-8: Create your First Database with SQL Server</a><ul>
<li><a href="#microservices-8.sqlserver-db">Benefits of SQL Server Container</a></li>
<li><a href="#microservices-8.sqlserver-db-step-1-setup-git-repository-for-sql-server-database">Step-1: Setup Git Repository for SQL Server database</a></li>
<li><a href="#microservices-8.sqlserver-db-step-2-create-folder-structure-for-sql-server-database">Step-2: Create Folder Structure for SQL Server database</a></li>
<li><a href="#microservices-8.sqlserver-db-step-3-add-dockerfiles-to-the-database-project">Step-3: Add Dockerfiles to the Database Project</a></li>
<li><a href="#microservices-8.sqlserver-db-step-4-test-the-sql-server-database-connection-using-ssms">Step-4: Test the SQL Server database connection using SSMS</a></li>
<li><a href="#microservices-8.sqlserver-db-step-5-test-the-sql-server-database-connection-using-azure-data-studio">Step-5: Test the SQL server database connection using Azure Data Studio</a></li>
<li><a href="#microservices-8.sqlserver-db-step-6-push-docker-container-to-acr">Step-6: Push Docker Container to ACR</a></li>
</ul>
</li>
<li><a href="#microservices-9.postgresql-db">Chapter-9: Setting up PostgreSQL database in a Docker Container</a><ul>
<li><a href="#microservices-9.postgresql-db-step-1-setup-git-repository-for-postgresql-database">Step-1: Setup Git Repository for PostgreSQL database</a></li>
<li><a href="#microservices-9.postgresql-db-step-2-create-folder-structure-for-postgresql-database">Step-2: Create Folder Structure for PostgreSQL database</a></li>
<li><a href="#microservices-9.postgresql-db-step-3-add-dockerfiles-to-the-database-project">Step-3: Add Dockerfiles to the Database Project</a></li>
<li><a href="#microservices-9.postgresql-db-step-4-create-docker-compose-file">Step-4: Create Docker Compose file</a></li>
<li><a href="#microservices-9.postgresql-db-step-5-test-the-postgresql-database-connection-from-psql-tool">Step-5: Test the PostgreSQL database connection from psql tool</a></li>
<li><a href="#microservices-9.postgresql-db-step-6-test-the-postgresql-database-from-pgadmin4-tool">Step-6: Test the PostgreSQL database from pgadmin4 tool</a></li>
<li><a href="#microservices-9.postgresql-db-step-7-push-docker-container-to-acr">Step-7: Push Docker Container to ACR</a></li>
</ul>
</li>
<li><a href="#microservices-10.keycloak">Chapter-10: Setting up Keycloak in a Docker Container</a><ul>
<li><a href="#microservices-10.keycloak-step-1-setup-repository-for-keycloak-in-azure-devops">Step-1: Setup repository for Keycloak in Azure DevOps</a></li>
<li><a href="#microservices-10.keycloak-step-2-create-keycloak-project">Step-2: Create Keycloak project</a></li>
<li><a href="#microservices-10.keycloak-step-3-keycloak-setup-with-docker-compose">Step-3: Keycloak setup with docker compose</a></li>
<li><a href="#microservices-10.keycloak-setup-keycloak-service">Step-3.1: Setup Keycloak Service</a></li>
<li><a href="#microservices-10.keycloak-setup-keycloak-service-with-postgresql-database">Step-3.2: Setup Keycloak Service with PostgreSQL database</a></li>
<li><a href="#microservices-10.keycloak-step-4-keycloak-setup-with-dockerfile">Step-4: Keycloak setup with Dockerfile</a></li>
<li><a href="#microservices-10.keycloak-step-41-create-dockerfile">Step-4.1: Create Dockerfile</a></li>
<li><a href="#microservices-10.keycloak-step-42-docker-build-locally">Step-4.2: Docker build locally</a></li>
<li><a href="#microservices-10.keycloak-step-43-docker-run-locally">Step-4.3: Docker run locally</a></li>
<li><a href="#microservices-10.keycloak-step-5-publish-the-keycloak-docker-container-to-container-registry">Step-5: Publish the Keycloak docker container to container registry</a></li>
</ul>
</li>
<li><a href="#microservices-11.drupal">Chapter-11: Setting up Drupal in a Docker Container</a><ul>
<li><a href="#microservices-11.drupal-step-1-setup-git-repository-for-drupal">Step-1: Setup Git Repository for Drupal</a></li>
<li><a href="#microservices-11.drupal-step-2-create-drupal-project">Step-2: Create Drupal Project</a></li>
<li><a href="#microservices-11.drupal-step-3-create-docker-compose-file">Step-3: Create Docker Compose file</a></li>
<li><a href="#microservices-11.drupal-step-4-build-drupal-locally">Step-4: Build Drupal locally</a></li>
<li><a href="#microservices-11.drupal-step-43-run-drupal-container-locally">Step-4.3: Run Drupal Container locally</a></li>
</ul>
</li>
<li><a href="#appendix-git-cheat-sheet">Appendix:</a><ul>
<li><a href="#appendix-git-cheat-sheet">Appendix-A: Git Cheat Sheet</a></li>
<li><a href="#appendix-docker-cheat-sheet">Appendix-B: Docker Cheat Sheet</a></li>
<li><a href="#appendix-dockerfile-cheat-sheet">Appendix-C: Dockerfile Cheat Sheet</a></li>
</ul>
</li>
</ul></section><section class="print-page" id="introduction-about-author" heading-number="2.2"><h1 id="introduction-about-author-about-the-author">About the Author</h1>
<p><strong>Anji Keesari</strong> is a software engineer and cloud architect with over 20 years of experience in the technology industry. He has been involved in numerous projects related to cloud computing, microservices architecture, and technologies such as Kubernetes, Terraform, and containers.</p>
<p>Anji has hands-on experience deploying and managing Kubernetes clusters in production environments. He is also proficient in tools like ArgoCD and Helm, utilizing them to deploy microservices applications on Kubernetes. Anji also has extensive knowledge of containers and containerization technologies, including Docker and container orchestration tools such as Kubernetes.</p>
<p>Apart from his expertise in Kubernetes and related tools, Anji has a strong background in Terraform, utilizing it to deploy infrastructure on various cloud platforms, including Azure and AWS.</p>
<p>Anji has a passion for teaching and sharing his knowledge with others. He has written numerous articles and tutorials on Kubernetes, ArgoCD, and Helm, and published in Medium website.</p>
<p>With his extensive knowledge and experience in Kubernetes, ArgoCD, and Helm, Anji is the perfect author for following two books:</p>
<ul>
<li><em>Building Microservices with Containers (A Practical Guide)</em></li>
<li><em>Building Scalable Kubernetes Infrastructure for Microservices (A Practical Guide)</em></li>
</ul>
<p>Throughout his career, Anji have worked with various companies in diverse domains such as Banking, Healthcare, and Finance, across countries such as India, UK, and US. He is dedicated to making a significant impact in his workplace and helping others along the way.</p>
<p>During his free time, Anji finds joy in various activities such as playing soccer, going hiking, exploring new places, and most importantly, spending quality time with his loved ones.</p>
<p>For any questions, suggestions, or topic requests, feel free to drop him a message, and he'll get in touch when his schedule permits.</p>
<p><strong>Contact Information:</strong></p>
<ul>
<li>Email: <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#97;&#110;&#106;&#107;&#101;&#101;&#115;&#97;&#114;&#105;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;">&#97;&#110;&#106;&#107;&#101;&#101;&#115;&#97;&#114;&#105;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;</a></li>
<li>Website: <a href="https://anjikeesari.com" target="_blank">https://anjikeesari.com</a></li>
</ul></section><section class="print-page" id="introduction-acknowledgments" heading-number="2.3"><h1 id="introduction-acknowledgments-acknowledgments">Acknowledgments</h1>
<p>Writing a book is a collaborative effort, and I could not have done it without the help and support of many people.</p>
<p>First and foremost, I would like to thank my family for their patience, understanding, and encouragement throughout this project, they scarified lot of (long) weekends. Their love and support kept me going during the long hours of writing and editing.</p>
<!-- I would like to thank my editor and the entire team at [publisher name] for their guidance and support throughout the entire publishing process. Their expertise and professionalism made this book possible. -->

<p>During this book writing I had to refer lot of online materials, I would also like to thank the many individuals and organizations who have contributed to the development of Kubernetes, ArgoCD, Helm, Terraform, and containerization technologies. Without their hard work and dedication, this book would not be possible.</p>
<p>Finally, I would like to thank the readers of this book for their interest and support. I hope that this book will be a valuable resource for anyone who wants to learn how to build and deploy microservices applications on a Kubernetes using ArgoCD and Helm.</p>
<p>Thank you all for your contributions and support.</p>
<p>Warm regards,</p>
<p>Anji Keesari</p></section><section class="print-page" id="introduction-introduction" heading-number="2.4"><h1 id="introduction-introduction-introduction">Introduction</h1>
<p>Welcome to <code>Building Microservices with Containers: A Practical Guide</code>. In today's rapidly growing technological landscape, the demand for scalable, flexible, and resilient software solutions is necessary. In response to this demand, the architecture of choice for many modern applications is microservices. Microservices enables the development of complex systems as a set of small, independently deployable services.</p>
<p>This book is your detailed guide to understanding and implementing microservices architecture using containerization technology, specifically Docker. Whether you're a regular application developer looking to adopt microservices or a new to the technology, this book will provide you with the knowledge and hands-on experience necessary to succeed in building scalable and maintainable applications.</p>
<h2 id="introduction-introduction-why-microservices">Why Microservices?</h2>
<p>Before looking into the technical details, let's briefly explore why microservices have become the architecture of choice for many organizations. Microservices offer several advantages over traditional monolithic architectures, including:</p>
<ul>
<li><strong>Scalability:</strong> Microservices allow individual components of an application to scale independently, enabling better resource utilization and improved performance.</li>
<li><strong>Flexibility:</strong> With microservices, teams can choose the most appropriate technology stack for each service, leading to greater flexibility and innovation.</li>
<li><strong>Resilience:</strong> Isolating services from each other reduces the impact of failures, making the overall system more resilient.</li>
<li><strong>Continuous Delivery:</strong> Microservices facilitate continuous delivery and deployment practices, enabling teams to release updates quickly and frequently.</li>
</ul>
<h2 id="introduction-introduction-why-containers">Why Containers?</h2>
<p>While microservices offer numerous benefits, managing a large number of services can be challenging. This is where containerization comes into play. Containers provide lightweight, portable, and isolated environments for running applications, making it easier to package, deploy, and manage microservices at scale. Docker, one of the most popular containerization platforms, has revolutionized the way developers build, ship, and run applications.</p>
<h2 id="introduction-introduction-what-youll-learn">What You'll Learn</h2>
<p>In this book, we'll start by covering the fundamentals of microservices architecture and Docker containerization. We'll then guide you through the process of building and deploying microservices using a variety of technologies, including .NET Core, Node.js, React.js, and SQL databases. Along the way, you'll learn how to:</p>
<ul>
<li>Containerize microservices using Docker.</li>
<li>Orchestrate containers with Docker Compose.</li>
<li>Implement authentication and authorization using Keycloak.</li>
<li>Build web applications with popular frameworks like .NET Core MVC and React.js.</li>
<li>Set up and manage databases within containers using SQL Server and PostgreSQL.</li>
<li>Deploy and scale microservices in a production environment.</li>
</ul>
<p>Each chapter includes practical, hands-on tutorials and real-world examples to help reinforce your understanding of the concepts covered. By the end of this book, you'll have the knowledge and skills to design, build, and deploy microservices-based applications with confidence.</p>
<h2 id="introduction-introduction-who-this-book-is-for">Who This Book Is For</h2>
<p>This book is designed for developers, architects, and DevOps engineers who are interested in adopting microservices architecture using containerization technology. Whether you're new to microservices or looking to expand your knowledge, this book will provide you with the essential tools and techniques to succeed in today's growing software development landscape.</p>
<p><strong>Developers:</strong></p>
<ul>
<li>If you're a developer looking to moving from traditional monolithic architectures to microservices, this book will provide you with the necessary knowledge and practical skills to design, develop, and deploy microservices-based applications using containerization technology.</li>
<li>Whether you specialize in a specific programming language or framework, the hands-on tutorials and real-world examples in this book will help you gain a deeper understanding of how to implement microservices using a variety of technologies, including .NET Core, Node.js, React.js, SQL databases, and more.</li>
</ul>
<p><strong>Architects:</strong></p>
<ul>
<li>For architects responsible for designing and planning the architecture of modern applications, this book will serve as a comprehensive guide to understanding the principles, patterns, and best practices of microservices architecture.</li>
<li>You'll learn how to design scalable, resilient, and maintainable systems using microservices and containerization technology, and how to address common challenges such as service discovery, communication, and data management in distributed environments.</li>
</ul>
<p><strong>DevOps Engineers:</strong></p>
<ul>
<li>If you're a DevOps engineer tasked with managing the deployment, scaling, and monitoring of microservices-based applications, this book will help you with the necessary skills to leverage containerization tools like Docker and orchestration platforms like Kubernetes.</li>
<li>You'll learn how to automate the deployment process, implement continuous integration and continuous delivery (CI/CD) pipelines, and ensure the reliability and performance of microservices in production environments.</li>
</ul>
<p><strong>Students and Researchers:</strong></p>
<ul>
<li>This book can also be valuable for students and researchers studying software engineering,  and cloud computing. It provides a practical, hands-on approach to learning about microservices architecture and containerization technology, with real-world examples and case studies to illustrate key concepts.</li>
</ul>
<h2 id="introduction-introduction-key-benefits-of-reading-this-book">Key Benefits of Reading This Book:</h2>
<p><code>Building Microservices with Containers: A Practical Guide</code> offers a lot of benefits to readers at various stages of their application development journey in understanding and implementing microservices architecture with containerization technology. Here are some key benefits you can expect from reading this book:</p>
<p><strong>Hands-On Tutorials:</strong></p>
<ul>
<li>Benefit from step-by-step tutorials and real-world examples that guide you through the process of building and deploying microservices using Docker containers.</li>
<li>Gain practical experience by working on hands-on exercises and projects designed to reinforce your learning and enhance your skills.</li>
</ul>
<p><strong>Diverse Technology Stack:</strong></p>
<ul>
<li>Explore a diverse range of technologies and frameworks, including .NET Core, Node.js, React.js, SQL databases, Docker, and Kubernetes.</li>
<li>Learn how to choose the right tools and technologies for your specific use case, and how to integrate them effectively to build scalable and resilient applications.</li>
</ul>
<p><strong>Transition from Monolithic to Microservices:</strong></p>
<ul>
<li>Understand the benefits and challenges of transitioning from monolithic architectures to microservices, and how to plan and execute a successful migration strategy.</li>
<li>Learn how to decompose monolithic applications into smaller, loosely-coupled services, and how to leverage containerization to improve scalability, flexibility, and resilience.</li>
</ul>
<p>Whether you're a developer, architect, DevOps engineer, student, or researcher, <code>Building Microservices with Containers: A Practical Guide</code> offers valuable insights, practical skills, and career advancement opportunities that will empower you to succeed in today's dynamic and fast-paced software development landscape.</p>
<h2 id="introduction-introduction-hands-on-labs">Hands-On Labs</h2>
<p>Here is the high-level list of labs we will cover in this chapter:</p>
<p><strong>Lab-1: Getting Started with Microservices</strong> - In this lab, we'll introduce you to the concept of microservices and explain their importance in modern application development. You'll gain a high-level understanding of microservices architecture and its benefits.</p>
<p><strong>Lab-2: Getting Started with Docker</strong> - Here, we'll look into Docker, the modern containerization technology. You'll learn how to install docker, run your first container, and explore basic docker commands.</p>
<p><strong>Lab-3: Create your First Containerized Microservice with .NET Core</strong> - This lab guides you through creating a microservice using .NET Core and containerizing it with Docker. You'll learn how to write Dockerfiles and build container images for .NET Core microservices.</p>
<p><strong>Lab-5: Create your Second Containerized Microservice with Node.js</strong> - In this lab, we switch gears to Node.js and create another microservice. You'll containerize a Node.js-based microservice and understand the differences compared to .NET Core.</p>
<p><strong>Lab-6: Create your First Containerized Website using ASP.NET Core MVC</strong> - Now, it's time to create a containerized website using ASP.NET Core MVC. You'll build a web application, package it as a Docker image, and run it as a container.</p>
<p><strong>Lab-7: Create your Second Containerized Website using React JS</strong> - In this lab, we'll focus on front-end development by creating a React.js-based website. You'll containerize a React application and understand how to work with front-end containers.</p>
<p><strong>Lab-8: Create your First Database with SQL Server</strong> - Databases are an essential part of microservices. In this lab, we'll set up a SQL Server database within a container. You'll learn how to create and connect to containerized databases.</p>
<p><strong>Lab-9: Create your Second Database with PostgreSQL</strong> - PostgreSQL is another popular database choice. This lab guides you through running PostgreSQL in a docker container and executing scripts. You'll understand how to work with different database engines within containers.</p>
<p><strong>Lab-10: Running Keycloak application in a Docker Container</strong> - External services play a important role in microservices. In this lab, we'll run Keycloak application, an identity and access management system, in a Docker container. You'll configure and interact with Keycloak within the containerized environment.</p>
<p><strong>Lab-11: Running Drupal website in a Docker Container</strong> - Continuing with external services, we'll set up Drupal website, a content management system, in a Docker container. You'll explore how to work with content management systems within containers.</p>
<p>These hands-on labs provide a practical foundation for building and containerizing microservices. By the end of these labs, you'll have hands-on experience with various technologies and a clear understanding of how to create and run microservices and external services in containers. This knowledge will be invaluable as we progress through the chapters and explore more advanced microservices concepts and deployment strategies.</p>
<!-- ## Labs categorized into three areas: -->
<h2 id="introduction-introduction-categories-of-labs">Categories of Labs:</h2>
<p>Labs in this Chapter are categorized into four areas, these categories provide a structured approach to learning containerization across different aspects of web development, from APIs and websites to databases and external services. By completing labs in each category, participants will gain comprehensive knowledge and skills essential for modern application development  practices. </p>
<ul>
<li>Creating Containerized APIs (API Development)</li>
<li>Creating Containerized Websites (Website Development)</li>
<li>Setting Up Databases in Containers (Database Containers)</li>
<li>Running External Services in Docker Containers (External Services)</li>
</ul>
<h2 id="introduction-introduction-creating-containerized-apis">Creating Containerized APIs</h2>
<p>Labs created within this category, you'll learn how to create containerized APIs using technologies like .NET Core Web API, Node.js.</p>
<p><strong>.NET Core Web API:</strong></p>
<ol>
<li>
<p><strong>Introduction to .NET Core Web API</strong>: We'll start by introducing you to .NET Core Web API, a cross-platform framework for building Restful services.</p>
</li>
<li>
<p><strong>Setting Up an .NET Core Web API Project</strong>: We'll guide you through setting up a new .NET Core Web API project.</p>
</li>
<li>
<p><strong>Containerization with Docker</strong>: You'll learn how to package your .NET Core Web API as a Docker container. We'll provide guidance on creating a Dockerfile for your web application.</p>
</li>
<li>
<p><strong>Running the Containerized .NET Core Web API</strong>: You'll see how to run your containerized .NET Core Web API locally and understand how containers simplify deployment.</p>
</li>
</ol>
<p><strong>Node.js APIs:</strong></p>
<ol>
<li>
<p><strong>Introduction to Node.js</strong>: Node.js is a popular JavaScript library for building Restful services. We'll introduce you to Node.js and explain its role in modern Rest APIs development.</p>
</li>
<li>
<p><strong>Creating a Node.js Rest API</strong>: You'll learn how to create a Node.js API from scratch. </p>
</li>
<li>
<p><strong>Containerization with Docker</strong>: Similar to .NET Core Web API, we'll guide you through containerizing your Node.js API. You'll create a Dockerfile for your Restful service.</p>
</li>
<li>
<p><strong>Running the Containerized Node.js API</strong>: You'll see how to run your containerized Node.js API locally. </p>
</li>
</ol>
<p>By the end of these labs, you'll have hands-on experience with .NET Core Web API and Node.js along with the knowledge of how to containerize web applications. These skills are essential as we move forward to deploy these containerized websites alongside microservices in later chapters. </p>
<h2 id="introduction-introduction-creating-containerized-websites">Creating Containerized Websites</h2>
<p>Labs created within this category, you'll learn how to create containerized websites using technologies like ASP.NET Core, MVC and React.js.</p>
<p><strong>ASP.NET Core MVC:</strong></p>
<ol>
<li>
<p><strong>Introduction to ASP.NET Core MVC</strong>: We'll start by introducing you to ASP.NET Core MVC, a cross-platform framework for building web applications. You'll understand its role in creating dynamic web content.</p>
</li>
<li>
<p><strong>Setting Up an ASP.NET Core MVC Project</strong>: We'll guide you through setting up a new ASP.NET Core MVC project.</p>
</li>
<li>
<p><strong>Containerization with Docker</strong>: You'll learn how to package your ASP.NET Core MVC application as a Docker container. We'll provide guidance on creating a Dockerfile for your web application.</p>
</li>
<li>
<p><strong>Running the Containerized ASP.NET Core MVC Application</strong>: You'll see how to run your containerized ASP.NET Core MVC application locally and understand how containers simplify deployment.</p>
</li>
</ol>
<p><strong>React.js:</strong></p>
<ol>
<li>
<p><strong>Introduction to React.js</strong>: React.js is a popular JavaScript library for building user interfaces. We'll introduce you to React.js and explain its role in modern web development.</p>
</li>
<li>
<p><strong>Creating a React.js Application</strong>: You'll learn how to create a React.js application from scratch. </p>
</li>
<li>
<p><strong>Containerization with Docker</strong>: Similar to ASP.NET Core MVC, we'll guide you through containerizing your React.js application. You'll create a Dockerfile for your web app.</p>
</li>
<li>
<p><strong>Running the Containerized React.js Application</strong>: You'll see how to run your containerized React.js application locally. </p>
</li>
</ol>
<p>By the end of these labs, you'll have hands-on experience with ASP.NET Core MVC and React.js, along with the knowledge of how to containerize web applications. These skills are essential as we move forward to deploy these containerized websites alongside microservices in later chapters. </p>
<h2 id="introduction-introduction-setting-up-databases-in-containers">Setting Up Databases in Containers</h2>
<p>Labs created within this category, we'll learn setting up databases within containers for microservices data storage. You'll learn how to create containerized database instances using SQL Server and PostgreSQL.</p>
<p>Microservices often rely on databases to store and manage data. Containerizing databases offers numerous advantages, such as isolation, portability, and versioning. In this section, we'll focus on two popular database systems: SQL Server and PostgreSQL.</p>
<p><strong>SQL Server:</strong></p>
<ol>
<li>
<p><strong>Introduction to SQL Server</strong>: We'll introduce you to SQL Server, a robust relational database management system (RDBMS) developed by Microsoft.</p>
</li>
<li>
<p><strong>Containerization with Docker</strong>: You'll learn how to containerize SQL Server by pulling an official SQL Server Docker image from the Azure Container registry or Docker Hub.</p>
</li>
<li>
<p><strong>Running SQL Server in a Docker Container</strong>: We'll guide you through running a SQL Server container, configuring database settings, and connecting to the containerized SQL Server instance.</p>
</li>
<li>
<p><strong>Data Management</strong>: You'll explore data management tasks within a containerized SQL Server, such as creating databases, tables, and performing CRUD (Create, Read, Update, Delete) operations.</p>
</li>
<li>
<p><strong>Connecting to database locally</strong>: Finally you'll explore different tools like SQL Server Management Studio (SSMS) and Azure data studio for connecting to containerized SQL Server database.</p>
</li>
</ol>
<p><strong>PostgreSQL:</strong></p>
<ol>
<li>
<p><strong>Introduction to PostgreSQL</strong>: We'll introduce you to PostgreSQL, a powerful open-source relational database system known for its scalability and extensibility.</p>
</li>
<li>
<p><strong>Containerization with Docker</strong>: You'll learn how to containerize PostgreSQL by pulling an official PostgreSQL Docker image from the Docker Hub.</p>
</li>
<li>
<p><strong>Running PostgreSQL in a Docker Container</strong>: We'll guide you through running a PostgreSQL container, configuring database settings, and connecting to the containerized PostgreSQL instance.</p>
</li>
<li>
<p><strong>Data Management</strong>: You'll explore data management tasks within a containerized PostgreSQL database, including creating databases, tables, and executing SQL queries.</p>
</li>
<li>
<p><strong>Connecting to database locally</strong>: Finally you'll explore different tools like <code>PSQL</code> and Pgadmin4 for connecting to containerized PostgreSQL database.</p>
</li>
</ol>
<p>By the end of these labs, you'll have hands-on experience with containerized SQL Server and PostgreSQL databases, understanding their role in microservices data storage. These skills are important as you proceed through the chapters, where microservices will interact with these containerized databases to retrieve and store data. </p>
<h2 id="introduction-introduction-running-external-services-in-containers">Running External Services in Containers</h2>
<p>Labs created within this category, we'll learn integration of external services into your microservices architecture. You'll learn how to run external services like Keycloak and Drupal in Docker containers, enhancing the capabilities of your microservices.</p>
<p>External services play a importent role in microservices architecture, providing essential functionalities such as authentication and content management. Containerizing these external services offers several advantages, including consistency and simplified deployment. In this section, we'll focus on two prominent external services: Keycloak and Drupal.</p>
<p><strong>Keycloak:</strong></p>
<ol>
<li>
<p><strong>Introduction to Keycloak</strong>: Keycloak is an open-source identity and access management system. We'll introduce you to Keycloak and explain its significance in microservices authentication.</p>
</li>
<li>
<p><strong>Containerization with Docker</strong>: You'll learn how to containerize Keycloak by pulling an official Keycloak Docker image from the Docker Hub.</p>
</li>
<li>
<p><strong>Running Keycloak in a Docker Container</strong>: We'll guide you through running a Keycloak container, configuring realms, users, and roles within the containerized Keycloak instance.</p>
</li>
<li>
<p><strong>Testing the Keycloak Application Locally</strong>: Finally you'll see how to browse your containerized Keycloak application locally and login into admin portal and intacting with Keycloak application. </p>
</li>
</ol>
<!-- 4. **Microservices Integration**: You'll understand how to integrate microservices with Keycloak for secure authentication and authorization. Keycloak serves as an identity provider for your microservices. -->

<p><strong>Drupal:</strong></p>
<ol>
<li>
<p><strong>Introduction to Drupal</strong>: Drupal is a popular open-source content management system (CMS). We'll introduce you to Drupal and its role in managing content for microservices.</p>
</li>
<li>
<p><strong>Containerization with Docker</strong>: You'll learn how to containerize Drupal by pulling an official Drupal Docker image from the Docker Hub.</p>
</li>
<li>
<p><strong>Running Drupal in a Docker Container</strong>: We'll guide you through running a Drupal container, setting up a website, and managing content within the containerized Drupal instance.</p>
</li>
<li>
<p><strong>Testing the Drupal Website Locally</strong>: Finally you'll see how to browse your containerized Drupal Website locally and login into drupal portal and intacting with drupal website.</p>
</li>
</ol>
<!-- 4. **Microservices Integration**: You'll explore how to integrate microservices with Drupal for content management. Drupal can serve as a content source for your microservices. -->

<p>By the end of these labs, you'll have hands-on experience with containerized Keycloak and Drupal instances, understanding how to integrate them seamlessly into your microservices ecosystem. These skills are essential as you proceed through the chapters, where microservices will rely on these external services for authentication, authorization, and content management.</p></section></section>
                    <section class='print-page md-section' id='section-3' heading-number='3'>
                        <h1>Microservices<a class='headerlink' href='#section-3' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="microservices-1.getting-started" heading-number="3.1"><h1 id="microservices-1.getting-started-chapter-1-getting-started-with-microservices">Chapter-1: Getting Started with Microservices</h1>
<h2 id="microservices-1.getting-started-overview">Overview</h2>
<p>Welcome to the first chapter of our book. In this chapter, we will begin our journey by understanding microservices architectures and how they are different comparing with traditional monolithic architectures. We'll also learn the advantages of the microservices architectures, including scalability, flexibility, and easier maintenance. we will also learn challenges with microservices and considerations that need to be carefully addressed, key technologies and communication patterns. Finally we will perform four tasks such as identifying list of microservices, git repos needed, create org and project in azure devops to continue our journey in this book.</p>
<h2 id="microservices-1.getting-started-objective">Objective</h2>
<p>In this exercise, our objective is to accomplish and learn the following tasks:</p>
<ul>
<li><a href="#microservices-1.getting-started-what-are-microservices">What are Microservices?</a></li>
<li><a href="#microservices-1.getting-started-microservices-vs-monolithic-architectures">Microservices vs Monolithic Architectures</a></li>
<li><a href="#microservices-1.getting-started-advantages-of-microservices">Advantages of Microservices</a></li>
<li><a href="#microservices-1.getting-started-challenges-and-considerations">Challenges and Considerations</a></li>
<li><a href="#microservices-1.getting-started-key-technologies-and-tools">Key Technologies and Tools</a></li>
<li><a href="#microservices-1.getting-started-microservices-communication">Microservices Communication</a></li>
<li><a href="#microservices-1.getting-started-domain-driven-design-ddd">Domain-Driven Design (DDD)</a></li>
<li><a href="#microservices-1.getting-started-task-1-identify-microservices-for-the-book">Task-1: Identify Microservices for the book</a></li>
<li><a href="#microservices-1.getting-started-task-2-identify-the-list-of-git-repositories-needed">Task-2: Identify the List of Git Repositories Needed</a></li>
<li><a href="#microservices-1.getting-started-task-3-create-new-azure-devops-organization">Task-3: Create new Azure DevOps Organization</a></li>
<li><a href="#microservices-1.getting-started-task-4-create-new-azure-devops-project">Task-4: Create new Azure DevOps Project</a></li>
</ul>
<h2 id="microservices-1.getting-started-what-are-microservices">What are Microservices?</h2>
<p><code>Microservices</code> are architectural style that structures an application as a collection of small, independent, and loosely coupled services. These services, known as microservices  , are designed to be self-contained and focused on specific functions or features of the application. Unlike monolithic applications, where all components are tightly integrated into a single codebase, microservices allow for the decomposition of an application into smaller, manageable parts.</p>
<p>Key Characteristics:</p>
<ul>
<li>Autonomous and independently deployable</li>
<li>Organized around business capabilities</li>
<li>Technology-agnostic (can be built using different languages/platforms)</li>
<li>Decentralized data management</li>
<li>Fault isolation</li>
</ul>
<h2 id="microservices-1.getting-started-microservices-vs-monolithic-architectures">Microservices vs Monolithic Architectures</h2>
<p><em>Monolithic Architectures:</em></p>
<ul>
<li>In a monolithic architecture, the entire application is built as a single, unified codebase.</li>
<li>All components of the application, including user interfaces, business logic, and data access layers, are tightly coupled.</li>
<li>Scaling a monolithic application typically involves replicating the entire application, even if only specific parts require additional resources.</li>
<li>Maintenance and updates often require making changes to the entire codebase, making it challenging to isolate and fix issues.</li>
</ul>
<p><em>Microservices:</em></p>
<ul>
<li>Microservices architecture promotes breaking down the application into smaller, independent services.</li>
<li>Each microservice is responsible for a specific application's functionality.</li>
<li>Microservices can be developed, deployed, and scaled independently.</li>
<li>Updates and maintenance are easier to manage, as changes to one microservice do not impact the entire system.</li>
</ul>
<h2 id="microservices-1.getting-started-advantages-of-microservices">Advantages of Microservices</h2>
<p>Microservices architecture offers several advantages, including:</p>
<ul>
<li>
<p><strong>Scalability:</strong> Microservices can be easily scaled horizontally to handle increased traffic, ensuring that the system remains responsive during high-demand periods.</p>
</li>
<li>
<p><strong>Flexibility:</strong> Developers can work on individual microservices without affecting the entire application. This makes it easier to introduce new features, fix bugs, or update a specific service without disrupting the entire system.</p>
</li>
<li>
<p><strong>Easy Maintenance:</strong> Smaller, self-contained services are typically easier to maintain and manage. Updates and changes can be isolated to specific microservices, reducing the risk of unintended consequences.</p>
</li>
<li>
<p><strong>Improved Fault Isolation:</strong> When a microservice fails, it usually doesn't bring down the entire system. Failures are contained within the affected service, minimizing the impact on the overall application.</p>
</li>
<li>
<p><strong>Technology Agnosticism:</strong> Microservices allow you to use different technologies and programming languages for different services, which can be chosen based on the specific requirements of each service.</p>
</li>
<li>
<p><strong>Rapid Development:</strong> Smaller teams can work independently on microservices, enabling faster development cycles and quicker time-to-market for new features or products.</p>
</li>
<li>
<p><strong>Enhanced Testing:</strong> Isolated microservices can be tested more thoroughly, leading to better quality assurance and reduced testing complexity compared to monolithic applications.</p>
</li>
<li>
<p><strong>Easier Deployment:</strong> Smaller, independent services are easier to deploy, reducing the risk of deployment failures and making it possible to implement continuous integration and continuous delivery (CI/CD) practices.</p>
</li>
</ul>
<h2 id="microservices-1.getting-started-challenges-and-considerations">Challenges and Considerations</h2>
<p>While microservices offer numerous advantages, they also come with their set of challenges and considerations that need to be carefully addressed. Careful planning and architectural decisions are important for realizing the benefits of microservices while mitigating their challenges.</p>
<p><em>Challenges of microservices</em></p>
<ul>
<li>
<p><strong>Complexity</strong>: Microservices introduce complexity, as an application is divided into multiple services, each with its own codebase, data store, and dependencies. Managing the interactions between microservices and ensuring the overall system's integrity can be challenging.</p>
</li>
<li>
<p><strong>Data Consistency</strong>: Maintaining data consistency in a distributed microservices architecture can be complex. With each microservice managing its data, ensuring data synchronization and integrity across services is important.</p>
</li>
<li>
<p><strong>Distributed Systems Issues</strong>: Microservices are inherently distributed, which introduces challenges such as network latency, message serialization, and handling communication failures. Implementing robust error handling and resilience mechanisms becomes essential.</p>
</li>
<li>
<p><strong>Operational Complexity</strong>: Managing and monitoring a large number of microservices in a production environment can be operationally complex.  Tools and practices for deployment, monitoring, and scaling need to be in place to ensure smooth operations.</p>
</li>
</ul>
<p><em>Considerations for Microservices Adoption</em></p>
<ul>
<li>
<p><strong>Application Complexity</strong>: Microservices are well-suited for complex, large-scale applications with multiple modules or functionalities. For simpler applications, a monolithic architecture may be more appropriate.</p>
</li>
<li>
<p><strong>Team Structure</strong>: Consider your organization's team structure. Microservices often align with small, cross-functional teams that can own and manage individual microservices. Ensure your teams have the necessary skills for microservices development and operations.</p>
</li>
<li>
<p><strong>Scalability and Performance</strong>: Microservices can provide scalability benefits, particularly for applications with varying workloads. Evaluate whether your application requires the ability to scale individual components independently.</p>
</li>
<li>
<p><strong>Frequent Updates</strong>: If your application requires frequent updates and releases, microservices can support continuous integration and deployment practices. Ensure you have the necessary CI/CD pipelines and infrastructure.</p>
</li>
</ul>
<p><em>Choosing the Right Architecture</em></p>
<p>The choice between monolithic and microservices architecture depends on various factors, including the complexity of the application, team structure, scalability requirements, and development speed. Monolithic architectures excel in simplicity and are suitable for smaller applications with straightforward requirements. Microservices, on the other hand, offer flexibility and scalability for larger, more complex applications but introduce operational complexities.</p>
<h2 id="microservices-1.getting-started-key-technologies-and-tools">Key Technologies and Tools</h2>
<p>Microservices development relies on a set of essential technologies and tools that facilitate the creation, deployment, and management of individual microservices. </p>
<ul>
<li>
<p><strong>Docker:</strong> Docker is a containerization platform that allows developers to package applications and their dependencies into lightweight containers.  Docker containers provide consistency in deployment across different environments, ensuring that microservices run reliably on any system.</p>
</li>
<li>
<p><strong>DevContainers:</strong> DevContainers streamline the development and testing of microservices locally by providing a controlled, isolated, and consistent environment that enhances collaboration among team members and simplifies the management of complex microservices ecosystems.</p>
</li>
<li>
<p><strong>Kubernetes:</strong> Kubernetes is a container orchestration platform that automates the deployment, scaling, and management of containerized applications, including microservices. Kubernetes simplifies the management of microservices at scale, enabling features like load balancing, auto-scaling, and rolling updates.</p>
</li>
</ul>
<!-- - **Service Mesh:** Service mesh technologies enhance microservices communication, offering features like traffic management, load balancing, security, and observability. Service meshes improve the reliability and resilience of microservices by handling communication between services, implementing policies, and providing insights into traffic. -->

<ul>
<li>
<p><strong>API Gateways:</strong> API gateways act as a front-end for microservices, providing a unified entry point for clients and handling tasks such as authentication, rate limiting, and request routing. API gateways simplify client interactions with microservices, centralize security controls, and enable API versioning and documentation.</p>
</li>
<li>
<p><strong>Continuous Integration/Continuous Deployment (CI/CD) Tools:</strong> CI/CD tools such as Azure DevOps, Argocd, Helmcharts automate the building, testing, and deployment of microservices, supporting rapid development and delivery. CI/CD pipelines streamline the development process, allowing for frequent updates and reducing the risk of errors.</p>
</li>
<li>
<p><strong>Monitoring and Observability Tools (e.g., Prometheus, Grafana, Jaeger):</strong> Monitoring and observability tools provide insights into the performance, availability, and behavior of microservices, helping to detect and troubleshoot issues. These tools ensure the reliability of microservices in production by offering real-time monitoring, logging, and tracing capabilities.</p>
</li>
</ul>
<h2 id="microservices-1.getting-started-microservices-communication">Microservices Communication</h2>
<p>Microservices can communicate with each other using different communication patterns, both synchronous and asynchronous.</p>
<p><strong>Synchronous:</strong></p>
<ul>
<li>
<p><em>HTTP/HTTPS</em>: Microservices can communicate over standard HTTP/HTTPS protocols, making it easy to create RESTful APIs or web services.
   Synchronous communication is suitable for scenarios where immediate responses are required.</p>
</li>
<li>
<p><em>gRPC</em>: gRPC is a high-performance, language-agnostic remote procedure call (RPC) framework that allows microservices to communicate efficiently. It is ideal for scenarios where low-latency, binary-encoded communication is needed.</p>
</li>
</ul>
<p><strong>Asynchronous:</strong></p>
<ul>
<li>
<p><em>Message Queues (e.g., RabbitMQ, Apache Kafka)</em>: Microservices can exchange messages through message queues or publish-subscribe systems.
Asynchronous communication is useful for decoupling services and handling background tasks or event-driven scenarios.</p>
</li>
<li>
<p><em>Event Sourcing and Event-driven Architecture</em>: In event-driven architecture, microservices issue and consume events to communicate changes or trigger actions. This pattern is beneficial for building scalable, loosely coupled systems that respond to real-time events.</p>
</li>
</ul>
<h2 id="microservices-1.getting-started-domain-driven-design-ddd">Domain-Driven Design (DDD)</h2>
<p>Domain-Driven Design (DDD) is a set of principles, patterns, and techniques for designing applicatio with a focus on the domain of the problem being solved. In the context of microservices architecture, DDD plays a importantent role in helping you define the boundaries of your microservices and ensure that they align with your business domain. Here's how DDD techniques can be applied in microservices architecture:</p>
<ul>
<li>
<p><strong>Bounded Contexts</strong>:In DDD, a bounded context is a specific boundary within which a domain model is defined and applicable. In microservices, each microservice typically corresponds to a bounded context. Bounded contexts ensure that each microservice has a well-defined scope and encapsulates a specific aspect of the business domain.</p>
</li>
<li>
<p><strong>Aggregates</strong>: Aggregates in DDD represent a cluster of domain objects treated as a single unit. In microservices, an aggregate can be considered a microservice that manages a set of related entities. Microservices encapsulate aggregates and provide APIs for manipulating them. This helps maintain data consistency and isolation.</p>
</li>
<li>
<p><strong>Entities and Value Objects</strong>: DDD distinguishes between entities (objects with a distinct identity) and value objects (objects with no distinct identity). In microservices, entities and value objects are used to model domain concepts within the microservice's scope, helping to define data structures and behavior.</p>
</li>
<li>
<p><strong>Context Mapping</strong>: Context mapping in DDD deals with defining relationships and interactions between bounded contexts. It helps manage the integration points between different parts of the system.
 In microservices architecture, context mapping is essential for specifying how microservices interact and communicate with each other, either through APIs or messaging.</p>
</li>
</ul>
<!-- 
- **Small, Independent, and Loosely Coupled:** Microservices are designed to be small and focused on specific business capabilities. They are independent entities that can be developed, deployed, and scaled individually. This loose coupling allows for greater flexibility and agility.

- **Self-Contained Services:** Each microservice is self-contained and encapsulates a specific functionality or feature. It can be developed and maintained by a small team of developers, promoting autonomy and faster iteration.

- **Bounded Context and Business Capabilities:** Microservices are designed to implement a single business capability within a bounded context. They are responsible for a specific task or function and should strive to be cohesive and aligned with a well-defined domain.

- **Separate Codebases and Teams:** Each microservice has its own separate codebase, enabling independent development and deployment. A small development team can manage and maintain a microservice, fostering ownership and accountability.

- **Data and State Responsibility:** Microservices are responsible for persisting their own data or managing external state relevant to their specific functionality. This allows for better encapsulation and isolation of data within each microservice.

By using microservices architecture, organizations can achieve greater scalability, maintainability, and resilience in their applications. It promotes modularity, enables independent development and deployment, and supports the evolution of complex systems.

In the labs ahead, we will explore the practical implementation of microservices using Kubernetes and related tools. Let's continue our journey and delve deeper into building and deploying microservices in a distributed environment. -->

<h2 id="microservices-1.getting-started-domain-driven-design-ddd-example">Domain-Driven Design (DDD) Example</h2>
<p>Let’s take a <code>detailed real-world example</code> of a microservices-based application following <code>Domain-Driven Design (DDD)</code> principles. This example will helps you to understand how to identify bounded contexts, define microservices, map databases per service, and see how this all ties together into a cohesive system.</p>
<p>Scenario: Online Retail Platform (E-Commerce System)</p>
<p>You are building a modern online retail platform similar to Amazon or Flipkart. The platform needs to handle:</p>
<ul>
<li>Product management</li>
<li>Customer management</li>
<li>Orders and payments</li>
<li>Inventory tracking</li>
<li>Notifications</li>
<li>Authentication and authorization</li>
</ul>
<p>Applying DDD: Identify Bounded Contexts</p>
<p>In DDD, each bounded context becomes a candidate for a microservice. Here’s how the domain breaks down:</p>
<table>
<thead>
<tr>
<th>Bounded Context</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Product Catalog</strong></td>
<td>Manages product details, categories, pricing</td>
</tr>
<tr>
<td><strong>Customer Management</strong></td>
<td>Handles user registration, profile, and address</td>
</tr>
<tr>
<td><strong>Order Management</strong></td>
<td>Creates and tracks customer orders</td>
</tr>
<tr>
<td><strong>Inventory</strong></td>
<td>Manages stock levels per product and location</td>
</tr>
<tr>
<td><strong>Payment</strong></td>
<td>Handles payment processing, refunds</td>
</tr>
<tr>
<td><strong>Notification</strong></td>
<td>Sends emails/SMS for order updates</td>
</tr>
<tr>
<td><strong>Authentication</strong></td>
<td>User login, token issuance, role-based access</td>
</tr>
</tbody>
</table>
<hr />
<p>Microservices List with Databases</p>
<table>
<thead>
<tr>
<th>Microservice</th>
<th>Responsibility</th>
<th>Database</th>
<th>Technology Stack</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ProductService</strong></td>
<td>Add/update product catalog, categories, pricing</td>
<td>SQL Server / PostgreSQL</td>
<td>.NET Core Web API</td>
</tr>
<tr>
<td><strong>CustomerService</strong></td>
<td>Manage user profile, address, contact info</td>
<td>PostgreSQL</td>
<td>.NET Core Web API</td>
</tr>
<tr>
<td><strong>OrderService</strong></td>
<td>Place order, track order status, order history</td>
<td>SQL Server</td>
<td>.NET Core Web API</td>
</tr>
<tr>
<td><strong>InventoryService</strong></td>
<td>Check and update stock, warehouse mapping</td>
<td>MongoDB / PostgreSQL</td>
<td>Node.js / .NET</td>
</tr>
<tr>
<td><strong>PaymentService</strong></td>
<td>Handle payments, payment status, refunds</td>
<td>PostgreSQL</td>
<td>Node.js</td>
</tr>
<tr>
<td><strong>NotificationService</strong></td>
<td>Send order/shipping alerts via email/SMS</td>
<td>No DB / Redis Queue</td>
<td>Node.js</td>
</tr>
<tr>
<td><strong>AuthService</strong></td>
<td>Register/login users, token issuance, RBAC</td>
<td>PostgreSQL (Keycloak DB)</td>
<td>Keycloak (Docker)</td>
</tr>
</tbody>
</table>
<p>Each microservice:</p>
<ul>
<li>Has its own isolated <strong>data store</strong></li>
<li>Manages its own <strong>business rules</strong></li>
<li>Communicates with others via <strong>REST APIs</strong> or <strong>message queues</strong></li>
</ul>
<p>Microservice Interactions (Example Flow)</p>
<p>User places an order:</p>
<ol>
<li><strong>AuthService</strong> validates user token.</li>
<li><strong>OrderService</strong> creates order, validates customer and product.</li>
<li><strong>ProductService</strong> provides product pricing.</li>
<li><strong>InventoryService</strong> checks and reserves stock.</li>
<li><strong>PaymentService</strong> processes payment.</li>
<li><strong>NotificationService</strong> sends confirmation email/SMS.</li>
<li><strong>OrderService</strong> updates order status.</li>
</ol>
<p>These services can be chained using <strong>REST</strong> (synchronous) or <strong>Kafka/RabbitMQ</strong> (asynchronous).</p>
<p>Databases per Microservice (DB-per-Service Pattern)</p>
<p>Each microservice owns its own database schema and is responsible for reading/writing to it.</p>
<table>
<thead>
<tr>
<th>Microservice</th>
<th>Database Type</th>
<th>Reason</th>
</tr>
</thead>
<tbody>
<tr>
<td>ProductService</td>
<td>PostgreSQL</td>
<td>Relational data, joins for categories</td>
</tr>
<tr>
<td>CustomerService</td>
<td>PostgreSQL</td>
<td>Structured customer records</td>
</tr>
<tr>
<td>OrderService</td>
<td>SQL Server</td>
<td>Order lifecycle with transactional guarantees</td>
</tr>
<tr>
<td>InventoryService</td>
<td>MongoDB</td>
<td>High write-read throughput, document model</td>
</tr>
<tr>
<td>PaymentService</td>
<td>PostgreSQL</td>
<td>Transactional ACID compliance</td>
</tr>
<tr>
<td>NotificationService</td>
<td>Redis (Optional)</td>
<td>Queueing and retry tracking</td>
</tr>
<tr>
<td>AuthService</td>
<td>PostgreSQL</td>
<td>Used internally by Keycloak</td>
</tr>
</tbody>
</table>
<h2 id="microservices-1.getting-started-task-1-identify-microservices-for-the-book">Task-1: Identify Microservices for the book</h2>
<p>To fully explore the microservices architecture in this book, we will create several containerized microservices and microfrontend applications and couple of databases. These applications will allow us to demonstrate real-world scenarios and provide a practical understanding of microservices implementation. In this case study, we will create the following microservices, which will be developed in the upcoming labs.  we have purposely selected diverse options to ensure a broader learning experience.</p>
<table>
<thead>
<tr>
<th>Microservice/Website/Database</th>
<th>Technology Used</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>First Microservice</td>
<td>.NET Core Web API (C#)</td>
<td>aspnet-api</td>
</tr>
<tr>
<td>Second Microservice</td>
<td>Node.js (Node)</td>
<td>nodejs-api</td>
</tr>
<tr>
<td>First Website</td>
<td>ASP.NET Core MVC (C#)</td>
<td>aspnet-app</td>
</tr>
<tr>
<td>Second Website</td>
<td>React.js (Node)</td>
<td>react-app</td>
</tr>
<tr>
<td>First Database</td>
<td>SQL Server</td>
<td>sqlserver-db</td>
</tr>
<tr>
<td>Second Database</td>
<td>PostgreSQL</td>
<td>postgresql-db</td>
</tr>
<tr>
<td>Keycloak</td>
<td>Identity and Access Management</td>
<td>keycloak-service</td>
</tr>
<tr>
<td>Drupal</td>
<td>Content Management System</td>
<td>drupal-service</td>
</tr>
</tbody>
</table>
<!-- 
- Create the first containerized microservice with .NET Core Web API with C#
    - name of the api is called `aspnet-api`
- Create the second containerized microservice with Node JS (Node)
    - name of the api is called  `nodejs-api`
- Create the first containerized website with ASP.NET Core MVC (C#)
    - name of the app is called `aspnet-app`
- Create the second containerized website with React JS (Node)
    - name of the app is called `react-app`
- Create the third containerized website with Blazor (C#)
    - name of the app is called `blazor-app`
- Create first containerized database with SQL server
    - name of the database app is called `sqlserver-db`
- Create second containerized database with PostgreSQL
    - name of the database app is called `postgresql-db` -->

<!-- 
    - Create the third Microservice with Java 
    - name of the api is called `java-api` 

-->

<p>for example, here is how the folder structure of our Microservices and MicroFrontend Applications looks like    .</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#microservices-1.getting-started-__codelineno-0-1"></a>Microservices/
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#microservices-1.getting-started-__codelineno-0-2"></a>├──<span class="w"> </span>aspnet-api/
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#microservices-1.getting-started-__codelineno-0-3"></a>│<span class="w">   </span>├──<span class="w"> </span>Controllers/
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#microservices-1.getting-started-__codelineno-0-4"></a>│<span class="w">   </span>├──<span class="w"> </span>Models/
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#microservices-1.getting-started-__codelineno-0-5"></a>│<span class="w">   </span>├──<span class="w"> </span>appsettings.json
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#microservices-1.getting-started-__codelineno-0-6"></a>│<span class="w">   </span>├──<span class="w"> </span>Program.cs
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#microservices-1.getting-started-__codelineno-0-7"></a>│<span class="w">   </span>├──<span class="w"> </span>Startup.cs
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#microservices-1.getting-started-__codelineno-0-8"></a>│<span class="w">   </span>└──<span class="w"> </span>Dockerfile
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#microservices-1.getting-started-__codelineno-0-9"></a>│<span class="w">   </span>└──<span class="w"> </span>aspnet-api.csproj
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#microservices-1.getting-started-__codelineno-0-10"></a>└──<span class="w"> </span>node-api/
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#microservices-1.getting-started-__codelineno-0-11"></a><span class="w">    </span>├──<span class="w"> </span>routes/
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#microservices-1.getting-started-__codelineno-0-12"></a><span class="w">    </span>├──<span class="w"> </span>models/
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#microservices-1.getting-started-__codelineno-0-13"></a><span class="w">    </span>├──<span class="w"> </span>package.json
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#microservices-1.getting-started-__codelineno-0-14"></a><span class="w">    </span>├──<span class="w"> </span>app.js
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#microservices-1.getting-started-__codelineno-0-15"></a><span class="w">    </span>└──<span class="w"> </span>Dockerfile
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#microservices-1.getting-started-__codelineno-0-16"></a>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#microservices-1.getting-started-__codelineno-0-17"></a>Websites/
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#microservices-1.getting-started-__codelineno-0-18"></a>├──<span class="w"> </span>aspnet-app/
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#microservices-1.getting-started-__codelineno-0-19"></a>│<span class="w">   </span>├──<span class="w"> </span>Controllers/
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#microservices-1.getting-started-__codelineno-0-20"></a>│<span class="w">   </span>├──<span class="w"> </span>Models/
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#microservices-1.getting-started-__codelineno-0-21"></a>│<span class="w">   </span>├──<span class="w"> </span>Views/
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#microservices-1.getting-started-__codelineno-0-22"></a>│<span class="w">   </span>├──<span class="w"> </span>appsettings.json
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#microservices-1.getting-started-__codelineno-0-23"></a>│<span class="w">   </span>├──<span class="w"> </span>Program.cs
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#microservices-1.getting-started-__codelineno-0-24"></a>│<span class="w">   </span>├──<span class="w"> </span>Startup.cs
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#microservices-1.getting-started-__codelineno-0-25"></a>│<span class="w">   </span>└──<span class="w"> </span>Dockerfile
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#microservices-1.getting-started-__codelineno-0-26"></a>│<span class="w">   </span>└──<span class="w"> </span>aspnet-app.csproj
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#microservices-1.getting-started-__codelineno-0-27"></a>├──<span class="w"> </span>react-app/
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#microservices-1.getting-started-__codelineno-0-28"></a>│<span class="w">   </span>├──<span class="w"> </span>src/
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#microservices-1.getting-started-__codelineno-0-29"></a>│<span class="w">   </span>├──<span class="w"> </span>package.json
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#microservices-1.getting-started-__codelineno-0-30"></a>│<span class="w">   </span>├──<span class="w"> </span>public/
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#microservices-1.getting-started-__codelineno-0-31"></a>│<span class="w">   </span>└──<span class="w"> </span>Dockerfile
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#microservices-1.getting-started-__codelineno-0-32"></a>│<span class="w">   </span>├──<span class="w"> </span>node_modules/
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#microservices-1.getting-started-__codelineno-0-33"></a>│<span class="w">   </span>└──<span class="w"> </span>README.md
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#microservices-1.getting-started-__codelineno-0-34"></a>└──<span class="w"> </span>...
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#microservices-1.getting-started-__codelineno-0-35"></a>Databases/
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#microservices-1.getting-started-__codelineno-0-36"></a>├──<span class="w"> </span>sqlserver-db/
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#microservices-1.getting-started-__codelineno-0-37"></a>│<span class="w">   </span>├──<span class="w"> </span>tables/
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#microservices-1.getting-started-__codelineno-0-38"></a>│<span class="w">   </span>├──<span class="w"> </span>procedures/
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#microservices-1.getting-started-__codelineno-0-39"></a>│<span class="w">   </span>├──<span class="w"> </span>views/
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#microservices-1.getting-started-__codelineno-0-40"></a>│<span class="w">   </span>├──<span class="w"> </span>functions/
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#microservices-1.getting-started-__codelineno-0-41"></a>│<span class="w">   </span>└──<span class="w"> </span>triggers/
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#microservices-1.getting-started-__codelineno-0-42"></a>│<span class="w">   </span>└──<span class="w"> </span>Dockerfile
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#microservices-1.getting-started-__codelineno-0-43"></a><span class="p">|</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#microservices-1.getting-started-__codelineno-0-44"></a>└──<span class="w"> </span>postgresql-db/
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#microservices-1.getting-started-__codelineno-0-45"></a><span class="w">    </span>├──<span class="w"> </span>tables/
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#microservices-1.getting-started-__codelineno-0-46"></a><span class="w">    </span>├──<span class="w"> </span>procedures/
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#microservices-1.getting-started-__codelineno-0-47"></a><span class="w">    </span>├──<span class="w"> </span>views/
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#microservices-1.getting-started-__codelineno-0-48"></a><span class="w">    </span>├──<span class="w"> </span>functions/
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#microservices-1.getting-started-__codelineno-0-49"></a><span class="w">    </span><span class="p">|</span>──<span class="w"> </span>Dockerfile
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#microservices-1.getting-started-__codelineno-0-50"></a><span class="w">    </span>└──<span class="w"> </span>triggers/
</span></code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you noticed, each project has its own <code>Dockerfile</code>, indicating that all these applications will be containerized and ready for deployment to a Kubernetes cluster.</p>
</div>
<p>The following diagram shows the conceptual view of the microservices environment</p>
<p><img alt="image.jpg" src="../microservices/images/image-32.jpg" width="400" /></p>
<p>For example:</p>
<p><img alt="image.jpg" src="../microservices/images/image-33.jpg" width="400" /></p>
<h2 id="microservices-1.getting-started-task-2-identify-the-list-of-git-repositories-needed">Task-2: Identify the List of Git Repositories Needed</h2>
<p>Once you have determined the list of domains or microservices required for your project, it's time to analyze how they will be organized within the source control system, such as Git repositories. One important consideration is determining the number of Git repositories you need.</p>
<p>There are multiple ways to organize source code and pipelines in Azure DevOps Git, and the approach you choose depends on how you want to manage your source code and pipelines for your microservices architecture while ensuring ease of maintenance in the future.</p>
<p>In my preference, I recommend creating a separate Git repository for each domain or microservice. Within each domain, you may have multiple microservices, MicroFrontends, and databases.</p>
<p>For example, let's visualize how the Git structure may look:</p>
<ul>
<li>Organization1 (Name of your organization)<ul>
<li>Project1 (Name of the project)<ul>
<li>Repo-1 (for Domain1)<ul>
<li>APIs - Create one or more APIs with separate folders</li>
<li>Websites - Create one or more websites with separate folders</li>
<li>Databases - Create one or more databases with separate folders</li>
</ul>
</li>
<li>Repo-2 (for Domain2)<ul>
<li>APIs - Create one or more APIs with separate folders</li>
<li>Websites - Create one or more websites with separate folders</li>
<li>Databases - Create one or more databases with separate folders</li>
</ul>
</li>
<li>Repo-3 (for Domain3)<ul>
<li>APIs - Create one or more APIs with separate folders</li>
<li>Websites - Create one or more websites with separate folders</li>
<li>Databases - Create one or more databases with separate folders</li>
</ul>
</li>
</ul>
</li>
<li>Project2 (Project2)<ul>
<li>Repo-1 (Name of the repository under Project2)<ul>
<li>APIs - Create one or more APIs with separate folders</li>
<li>Websites - Create one or more websites with separate folders</li>
<li>Databases - Create one or more databases with separate folders</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- 
<div class="language-sh highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#microservices-1.getting-started-__codelineno-1-1"></a>Organization1<span class="w"> </span><span class="o">(</span>Name<span class="w"> </span>of<span class="w"> </span>your<span class="w"> </span>organization<span class="o">)</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#microservices-1.getting-started-__codelineno-1-2"></a>│
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#microservices-1.getting-started-__codelineno-1-3"></a>├──<span class="w"> </span>Project1<span class="w"> </span><span class="o">(</span>Name<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>project<span class="o">)</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#microservices-1.getting-started-__codelineno-1-4"></a>│<span class="w">   </span>├──<span class="w"> </span>Repo-1<span class="w"> </span><span class="o">(</span><span class="k">for</span><span class="w"> </span>Domain1<span class="o">)</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#microservices-1.getting-started-__codelineno-1-5"></a>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>APIs<span class="w"> </span>-<span class="w"> </span>Create<span class="w"> </span>one<span class="w"> </span>or<span class="w"> </span>more<span class="w"> </span>APIs<span class="w"> </span>with<span class="w"> </span>separate<span class="w"> </span>folders
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#microservices-1.getting-started-__codelineno-1-6"></a>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>Websites<span class="w"> </span>-<span class="w"> </span>Create<span class="w"> </span>one<span class="w"> </span>or<span class="w"> </span>more<span class="w"> </span>websites<span class="w"> </span>with<span class="w"> </span>separate<span class="w"> </span>folders
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#microservices-1.getting-started-__codelineno-1-7"></a>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>Databases<span class="w"> </span>-<span class="w"> </span>Create<span class="w"> </span>one<span class="w"> </span>or<span class="w"> </span>more<span class="w"> </span>databases<span class="w"> </span>with<span class="w"> </span>separate<span class="w"> </span>folders
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#microservices-1.getting-started-__codelineno-1-8"></a>│<span class="w">   </span>│
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#microservices-1.getting-started-__codelineno-1-9"></a>│<span class="w">   </span>├──<span class="w"> </span>Repo-2<span class="w"> </span><span class="o">(</span><span class="k">for</span><span class="w"> </span>Domain2<span class="o">)</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#microservices-1.getting-started-__codelineno-1-10"></a>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>APIs<span class="w"> </span>-<span class="w"> </span>Create<span class="w"> </span>one<span class="w"> </span>or<span class="w"> </span>more<span class="w"> </span>APIs<span class="w"> </span>with<span class="w"> </span>separate<span class="w"> </span>folders
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#microservices-1.getting-started-__codelineno-1-11"></a>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>Websites<span class="w"> </span>-<span class="w"> </span>Create<span class="w"> </span>one<span class="w"> </span>or<span class="w"> </span>more<span class="w"> </span>websites<span class="w"> </span>with<span class="w"> </span>separate<span class="w"> </span>folders
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#microservices-1.getting-started-__codelineno-1-12"></a>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>Databases<span class="w"> </span>-<span class="w"> </span>Create<span class="w"> </span>one<span class="w"> </span>or<span class="w"> </span>more<span class="w"> </span>databases<span class="w"> </span>with<span class="w"> </span>separate<span class="w"> </span>folders
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#microservices-1.getting-started-__codelineno-1-13"></a>│<span class="w">   </span>│
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#microservices-1.getting-started-__codelineno-1-14"></a>│<span class="w">   </span>└──<span class="w"> </span>Repo-3<span class="w"> </span><span class="o">(</span><span class="k">for</span><span class="w"> </span>Domain3<span class="o">)</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#microservices-1.getting-started-__codelineno-1-15"></a>│<span class="w">       </span>├──<span class="w"> </span>APIs<span class="w"> </span>-<span class="w"> </span>Create<span class="w"> </span>one<span class="w"> </span>or<span class="w"> </span>more<span class="w"> </span>APIs<span class="w"> </span>with<span class="w"> </span>separate<span class="w"> </span>folders
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#microservices-1.getting-started-__codelineno-1-16"></a>│<span class="w">       </span>├──<span class="w"> </span>Websites<span class="w"> </span>-<span class="w"> </span>Create<span class="w"> </span>one<span class="w"> </span>or<span class="w"> </span>more<span class="w"> </span>websites<span class="w"> </span>with<span class="w"> </span>separate<span class="w"> </span>folders
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#microservices-1.getting-started-__codelineno-1-17"></a>│<span class="w">       </span>└──<span class="w"> </span>Databases<span class="w"> </span>-<span class="w"> </span>Create<span class="w"> </span>one<span class="w"> </span>or<span class="w"> </span>more<span class="w"> </span>databases<span class="w"> </span>with<span class="w"> </span>separate<span class="w"> </span>folders
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#microservices-1.getting-started-__codelineno-1-18"></a>│
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#microservices-1.getting-started-__codelineno-1-19"></a>└──<span class="w"> </span>Project2<span class="w"> </span><span class="o">(</span>Project2<span class="o">)</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#microservices-1.getting-started-__codelineno-1-20"></a><span class="w">    </span>└──<span class="w"> </span>Repo-1<span class="w"> </span><span class="o">(</span>Name<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>repository<span class="w"> </span>under<span class="w"> </span>Project2<span class="o">)</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#microservices-1.getting-started-__codelineno-1-21"></a><span class="w">        </span>├──<span class="w"> </span>APIs<span class="w"> </span>-<span class="w"> </span>Create<span class="w"> </span>one<span class="w"> </span>or<span class="w"> </span>more<span class="w"> </span>APIs<span class="w"> </span>with<span class="w"> </span>separate<span class="w"> </span>folders
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#microservices-1.getting-started-__codelineno-1-22"></a><span class="w">        </span>├──<span class="w"> </span>Websites<span class="w"> </span>-<span class="w"> </span>Create<span class="w"> </span>one<span class="w"> </span>or<span class="w"> </span>more<span class="w"> </span>websites<span class="w"> </span>with<span class="w"> </span>separate<span class="w"> </span>folders
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#microservices-1.getting-started-__codelineno-1-23"></a><span class="w">        </span>└──<span class="w"> </span>Databases<span class="w"> </span>-<span class="w"> </span>Create<span class="w"> </span>one<span class="w"> </span>or<span class="w"> </span>more<span class="w"> </span>databases<span class="w"> </span>with<span class="w"> </span>separate<span class="w"> </span>folders
</span></code></pre></div>
-->
<p>Repeat this structure as the organization grows and new projects or domains are introduced.</p>
<p>By following this approach, each domain or microservice will have its dedicated Git repository, providing a clear separation and organization of the source code and related artifacts. This structure facilitates easier maintenance, collaboration, and version control.</p>
<p>Remember, this is just a sample structure, and you can adapt it based on your organization's specific needs and preferences.</p>
<p>Visual representation of a sample DevOps Git structure:
<div class="language-sh highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#microservices-1.getting-started-__codelineno-2-1"></a>Organization1
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#microservices-1.getting-started-__codelineno-2-2"></a>└──<span class="w"> </span>Project1
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#microservices-1.getting-started-__codelineno-2-3"></a><span class="w">    </span>├──<span class="w"> </span>Repo-1<span class="w"> </span><span class="o">(</span>Microservice-1<span class="o">)</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#microservices-1.getting-started-__codelineno-2-4"></a><span class="w">    </span>│<span class="w">   </span>├──<span class="w"> </span>APIs
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#microservices-1.getting-started-__codelineno-2-5"></a><span class="w">    </span>│<span class="w">   </span>├──<span class="w"> </span>Websites
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#microservices-1.getting-started-__codelineno-2-6"></a><span class="w">    </span>│<span class="w">   </span>└──<span class="w"> </span>Databases
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#microservices-1.getting-started-__codelineno-2-7"></a><span class="w">    </span>├──<span class="w"> </span>Repo-2<span class="w"> </span><span class="o">(</span>Microservice-2<span class="o">)</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#microservices-1.getting-started-__codelineno-2-8"></a><span class="w">    </span>│<span class="w">   </span>├──<span class="w"> </span>APIs
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#microservices-1.getting-started-__codelineno-2-9"></a><span class="w">    </span>│<span class="w">   </span>├──<span class="w"> </span>Websites
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#microservices-1.getting-started-__codelineno-2-10"></a><span class="w">    </span>│<span class="w">   </span>└──<span class="w"> </span>Databases
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#microservices-1.getting-started-__codelineno-2-11"></a><span class="w">    </span>├──<span class="w"> </span>Repo-3<span class="w"> </span><span class="o">(</span>Microservice-3<span class="o">)</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#microservices-1.getting-started-__codelineno-2-12"></a><span class="w">    </span>│<span class="w">   </span>├──<span class="w"> </span>APIs
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#microservices-1.getting-started-__codelineno-2-13"></a><span class="w">    </span>│<span class="w">   </span>├──<span class="w"> </span>Websites
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#microservices-1.getting-started-__codelineno-2-14"></a><span class="w">    </span>│<span class="w">   </span>└──<span class="w"> </span>Databases
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#microservices-1.getting-started-__codelineno-2-15"></a><span class="w">    </span>Project2
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#microservices-1.getting-started-__codelineno-2-16"></a><span class="w">    </span>└──<span class="w"> </span>Repo-1
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#microservices-1.getting-started-__codelineno-2-17"></a><span class="w">        </span>├──<span class="w"> </span>APIs
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#microservices-1.getting-started-__codelineno-2-18"></a><span class="w">        </span>├──<span class="w"> </span>Websites
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#microservices-1.getting-started-__codelineno-2-19"></a><span class="w">        </span>└──<span class="w"> </span>Databases
</span></code></pre></div></p>
<p>By adopting this Git structure, you can effectively manage and scale your microservices projects while ensuring a clear and organized source control system.</p>
<h2 id="microservices-1.getting-started-task-3-create-new-azure-devops-organization">Task-3: Create new Azure DevOps Organization</h2>
<p>With the planning and preparation of your Microservices application complete, the next step is to create a DevOps organization where you can manage the lifecycle of your projects.</p>
<p>To create a new Azure DevOps organization, follow these steps:</p>
<ol>
<li>Sign in to Azure DevOps. - <a href="https://dev.azure.com">https://dev.azure.com</a></li>
<li>Click on <code>New organization</code> in the left nav.
<img alt="image.jpg" src="../microservices/images/image-8.jpg" width="400" /></li>
<li>Enter name of the Organization and create new organization.
<img alt="image.jpg" src="../microservices/images/image-9.jpg" width="400" /></li>
</ol>
<p>Once you have completed these steps, you will have a new Azure DevOps organization that is ready for use. You can then invite members to join your organization and start creating new projects.</p>
<h2 id="microservices-1.getting-started-task-4-create-new-azure-devops-project">Task-4: Create new Azure DevOps Project</h2>
<p>You need a new project in Azure DevOps to manage your source code and other project related activities.</p>
<p>Follow these steps to create a new project in Azure DevOps:</p>
<ol>
<li>
<p>Sign in to the Azure DevOps website <a href="https://dev.azure.com/">https://dev.azure.com/</a> with your Azure DevOps account.</p>
</li>
<li>
<p>Click on the <code>Create a project</code> button.</p>
</li>
<li>
<p>Enter a name for your project and select a process template. The process template determines the default work item types, source control repository, and other settings for your project.</p>
</li>
<li>
<p>Click the <code>Create project</code> button to create your new project.</p>
</li>
<li>
<p>Follow the screen to configure your project settings, including source control, work item types, and team members.</p>
</li>
<li>
<p>When you are finished, click the <code>Create</code> button to complete the project creation process.</p>
</li>
</ol>
<p>For example: </p>
<p>Project Name - <code>Microservices</code></p>
<p>Description - <code>Microservices project will be used to roll out sample microservices applications for demonstrating microservices architecture.</code></p>
<p><img alt="image.jpg" src="../microservices/images/image-10.jpg" width="400" /></p>
<p>We have created new organization in azure DevOps and created new project so that we can start working on containerized microservices applications in the next labs.</p>
<h2 id="microservices-1.getting-started-references">References</h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/architecture/guide/architecture-styles/microservices" target="_blank">Microsoft MSDN - Microservice architecture style</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/devops/organizations/accounts/create-organization?view=azure-devops" target="_blank">Microsoft MSDN - Create an organization</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/devops/organizations/projects/create-project?view=azure-devops&amp;tabs=browser" target="_blank">Microsoft MSDN - Create a project in Azure DevOps</a></li>
<li><a href="https://microservices.io/patterns/microservices.html" target="_blank">Microservice Architecture</a></li>
</ul></section><section class="print-page" id="microservices-2.docker-fundamentals" heading-number="3.2"><h1 id="microservices-2.docker-fundamentals-chapter-2-exploring-docker-fundamentals">Chapter-2: Exploring Docker Fundamentals</h1>
<h2 id="microservices-2.docker-fundamentals-overview">Overview</h2>
<p>In this article, we'll explore the basics of Docker, which are like building blocks for understanding how containers work. Whether you're an experienced coder or just starting out, grasping these basics is essential for easily deploying applications in containers. These core concepts will come in handy as you continue your learning journey with docker.</p>
<h2 id="microservices-2.docker-fundamentals-what-is-docker">What is Docker?</h2>
<p>Docker is a powerful platform that simplifies the process of developing, shipping, and running applications. Docker uses a technology known as containerization to encapsulate an application and its dependencies into a self-contained unit called a <code>container</code>. These containers are lightweight, portable, and consistent across different environments.</p>
<h2 id="microservices-2.docker-fundamentals-why-use-docker">Why use Docker?</h2>
<p>Docker simplifies the development, deployment, and management of applications, offering an adaptable solution for modern software development practices. Its popularity comes from from its ability to address challenges related to consistency, scalability, and efficiency in the software development lifecycle.</p>
<p>Docker has become increasingly popular in the software development and IT industry due to its numerous advantages. Here are some key benefits of using Docker:</p>
<ol>
<li>
<p><strong>Portability:</strong>
   Docker containers encapsulate applications and their dependencies, ensuring consistency across different environments. This portability eliminates the common problem of "it works on my machine" and facilitates seamless deployment across various systems.</p>
</li>
<li>
<p><strong>Isolation:</strong>
   Containers provide a lightweight and isolated environment for applications. Each container runs independently, preventing conflicts between dependencies and ensuring that changes made in one container do not affect others.</p>
</li>
<li>
<p><strong>Efficiency:</strong>
   Docker's containerization technology enables efficient resource utilization. Containers share the host OS kernel, making them lightweight compared to traditional virtual machines. This results in faster startup times and improved performance.</p>
</li>
<li>
<p><strong>Scalability:</strong>
   Docker makes it easy to scale applications horizontally by running multiple instances of containers. This scalability allows developers to change the workloads and ensures optimal resource utilization.</p>
</li>
<li>
<p><strong>Microservices architecture:</strong>
   Docker is integral to the microservices architecture, where applications are composed of small, independently deployable services. Containers facilitate the development, deployment, and scaling of microservices, enabling agility and ease of management.</p>
</li>
<li>
<p><strong>DevOps integration:</strong>
   Docker aligns well with DevOps practices by promoting collaboration between development and operations teams. Containers can be easily integrated into continuous integration and continuous deployment (CI/CD) pipelines, streamlining the software delivery process.</p>
</li>
<li>
<p><strong>Community support:</strong>
   Docker's community offers lot of pre-made tools and solutions, helping developers work faster and learn from others.</p>
</li>
<li>
<p><strong>Security:</strong>
    Docker provides built-in security features, such as isolation and resource constraints, to enhance application security. </p>
</li>
<li>
<p><strong>Cross-platform compatibility:</strong>
    Docker containers can run on various operating systems, including Linux, Windows, and macOS. This cross-platform compatibility is beneficial for teams working in heterogeneous environments.</p>
</li>
</ol>
<h2 id="microservices-2.docker-fundamentals-docker-concepts">Docker concepts</h2>
<p>Understanding these basic concepts is essential for effectively working with Docker and leveraging its advantages in terms of portability, scalability, and consistency across different environments.  Here are basic concepts of Docker:</p>
<ul>
<li>
<p><strong>Containerization</strong> Containerization is a technology that allows you to package an application and its dependencies, including libraries and configuration files, into a single container image.</p>
</li>
<li>
<p><strong>Images</strong> An image is a lightweight, standalone, and executable package that includes everything needed to run a piece of software, including the code, runtime, libraries, and system tools. Docker images are used to create containers. They are built from a set of instructions called a Dockerfile.</p>
</li>
<li>
<p><strong>Dockerfile</strong> A Dockerfile is a text file that contains a set of instructions for building a Docker image. It specifies the base image, adds dependencies, copies files, and defines other settings necessary for the application to run.</p>
</li>
<li>
<p><strong>Containers</strong> Containers are instances of Docker images. They run in isolated environments, ensuring that the application behaves consistently across different environments. Containers share the host OS kernel but have their own file system, process space, and network interfaces.</p>
</li>
<li>
<p><strong>Registries</strong> Docker images can be stored and shared through registries. The default registry is Docker Hub, but private registries can also be used. Registries allow versioning, distribution, and collaboration on Docker images.</p>
</li>
<li>
<p><strong>Docker compose</strong> Docker Compose is a tool for defining and running multi-container Docker applications. It allows you to define a multi-container application in a single file, specifying services, networks, and volumes.</p>
</li>
<li>
<p><strong>Docker engine</strong> Docker Engine is the core component that manages Docker containers. It includes a server, REST API, and a command-line interface (CLI). The Docker daemon runs on the host machine, and the Docker CLI communicates with it to build, run, and manage containers.</p>
</li>
<li>
<p><strong>Volumes</strong> Volumes provide a way for containers to persist data outside their lifecycle. They can be used to share data between containers or to persist data even if a container is stopped or removed.</p>
</li>
<li>
<p><strong>Networking</strong> Docker provides networking capabilities that allow containers to communicate with each other or with the external world. Containers can be connected to different networks, and ports can be mapped between the host and the containers.</p>
</li>
</ul>
<h2 id="microservices-2.docker-fundamentals-container-orchestration">Container orchestration</h2>
<p>Whether managing a small cluster or a large-scale production environment, adopting container orchestration is crucial for containerized applications. Here are some container orchestrations:</p>
<ul>
<li>
<p><strong>Kubernetes:</strong> Kubernetes is the most widely adopted container orchestration platform. It automates the deployment, scaling, and management of containerized applications, providing a robust and extensible framework.</p>
</li>
<li>
<p><strong>Docker Swarm:</strong> Docker Swarm is a native clustering and orchestration solution provided by Docker. While it may not be as feature-rich as Kubernetes, it offers simplicity and seamless integration with Docker.</p>
</li>
<li>
<p><strong>Amazon ECS:</strong> Amazon Elastic Container Service (ECS) is a fully managed container orchestration service provided by AWS. It integrates with other AWS services and is suitable for users already utilizing the AWS ecosystem.</p>
</li>
<li>
<p><strong>Azure Kubernetes Service (AKS):</strong> AKS is a managed Kubernetes service offered by Microsoft Azure. It simplifies the deployment and management of Kubernetes clusters in the Azure cloud.</p>
</li>
</ul>
<h2 id="microservices-2.docker-fundamentals-docker-desktop">Docker Desktop</h2>
<p>Docker Desktop is a powerful tool that provides a user-friendly interface and environment for developing, building, and testing applications using Docker containers on local machine. </p>
<p>Docker Desktop provides a convenient environment for developers to work with containers on their personal machines.</p>
<h2 id="microservices-2.docker-fundamentals-install-docker">Install Docker</h2>
<p>Here are the steps to install Docker on a different operating systems:</p>
<p><strong>Windows:</strong></p>
<p>Download Docker Desktop:</p>
<ul>
<li>Visit the <a href="https://www.docker.com/products/docker-desktop" target="_blank">Docker Desktop for Windows</a> page.</li>
<li>Click on the "Download for Windows" button.</li>
<li>Follow the on-screen instructions to download the installer.</li>
</ul>
<p>Install Docker Desktop:</p>
<ul>
<li>Run the installer that you downloaded.</li>
<li>Follow the installation wizard, accepting the default options.</li>
<li>The installer may require you to restart your computer.</li>
</ul>
<p>Enable Hyper-V (Windows 10 Pro/Enterprise):</p>
<ul>
<li>If you're running Windows 10 Pro or Enterprise, Docker Desktop will use Hyper-V for virtualization. Ensure that Hyper-V is enabled in the Windows Features.</li>
</ul>
<p>Start Docker Desktop:</p>
<ul>
<li>Once installed, start Docker Desktop from the Start Menu.</li>
<li>The Docker icon will appear in the system tray when Docker Desktop is running.</li>
</ul>
<p><strong>macOS:</strong></p>
<p>Download Docker Desktop:</p>
<ul>
<li>Visit the <a href="https://www.docker.com/products/docker-desktop" target="_blank">Docker Desktop for Mac</a> page.</li>
<li>Click on the "Download for Mac" button.</li>
<li>Follow the on-screen instructions to download the installer.</li>
</ul>
<p>Install Docker Desktop:</p>
<ul>
<li>Run the installer that you downloaded.</li>
<li>Drag the Docker icon to the Applications folder.</li>
<li>Launch Docker from Applications.</li>
</ul>
<p>Start Docker Desktop:</p>
<ul>
<li>Once installed, Docker Desktop should start automatically.</li>
<li>The Docker icon will appear in the menu bar when Docker Desktop is running.</li>
</ul>
<p><strong>Verify Docker install:</strong></p>
<p>To verify that Docker is installed correctly, open a terminal and run the following command:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#microservices-2.docker-fundamentals-__codelineno-0-1"></a>docker<span class="w"> </span>--version
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#microservices-2.docker-fundamentals-__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#microservices-2.docker-fundamentals-__codelineno-0-3"></a><span class="c1"># or</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#microservices-2.docker-fundamentals-__codelineno-0-4"></a>docker<span class="w"> </span>version
</span></code></pre></div>
<p>If you notice this, it indicates that your Docker is not in a running status.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#microservices-2.docker-fundamentals-__codelineno-1-1"></a>error<span class="w"> </span>during<span class="w"> </span>connect:<span class="w"> </span>this<span class="w"> </span>error<span class="w"> </span>may<span class="w"> </span>indicate<span class="w"> </span>that<span class="w"> </span>the<span class="w"> </span>docker<span class="w"> </span>daemon<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>running:<span class="w"> </span>Get<span class="w"> </span><span class="s2">&quot;http://%2F%2F.%2Fpipe%2Fdocker_engine/v1.24/version&quot;</span>:<span class="w"> </span>open<span class="w"> </span>//./pipe/docker_engine:<span class="w"> </span>The<span class="w"> </span>system<span class="w"> </span>cannot<span class="w"> </span>find<span class="w"> </span>the<span class="w"> </span>file<span class="w"> </span>specified.
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#microservices-2.docker-fundamentals-__codelineno-1-2"></a>Client:
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#microservices-2.docker-fundamentals-__codelineno-1-3"></a><span class="w"> </span>Cloud<span class="w"> </span>integration:<span class="w"> </span>v1.0.35
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#microservices-2.docker-fundamentals-__codelineno-1-4"></a><span class="w"> </span>Version:<span class="w">           </span><span class="m">24</span>.0.2
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#microservices-2.docker-fundamentals-__codelineno-1-5"></a><span class="w"> </span>API<span class="w"> </span>version:<span class="w">       </span><span class="m">1</span>.43
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#microservices-2.docker-fundamentals-__codelineno-1-6"></a><span class="w"> </span>Go<span class="w"> </span>version:<span class="w">        </span>go1.20.4
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#microservices-2.docker-fundamentals-__codelineno-1-7"></a><span class="w"> </span>Git<span class="w"> </span>commit:<span class="w">        </span>cb74dfc
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#microservices-2.docker-fundamentals-__codelineno-1-8"></a><span class="w"> </span>Built:<span class="w">             </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">21</span>:53:15<span class="w"> </span><span class="m">2023</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#microservices-2.docker-fundamentals-__codelineno-1-9"></a><span class="w"> </span>OS/Arch:<span class="w">           </span>windows/amd64
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#microservices-2.docker-fundamentals-__codelineno-1-10"></a><span class="w"> </span>Context:<span class="w">           </span>default
</span></code></pre></div>
<p>After Docker desktop is started and if everything is set up correctly, you should see following message indicating that your Docker installation is working.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#microservices-2.docker-fundamentals-__codelineno-2-1"></a>Client:
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#microservices-2.docker-fundamentals-__codelineno-2-2"></a><span class="w"> </span>Cloud<span class="w"> </span>integration:<span class="w"> </span>v1.0.35<span class="w"> </span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#microservices-2.docker-fundamentals-__codelineno-2-3"></a><span class="w"> </span>Version:<span class="w">           </span><span class="m">24</span>.0.2<span class="w">  </span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#microservices-2.docker-fundamentals-__codelineno-2-4"></a><span class="w"> </span>API<span class="w"> </span>version:<span class="w">       </span><span class="m">1</span>.43<span class="w">    </span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#microservices-2.docker-fundamentals-__codelineno-2-5"></a><span class="w"> </span>Go<span class="w"> </span>version:<span class="w">        </span>go1.20.4
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#microservices-2.docker-fundamentals-__codelineno-2-6"></a><span class="w"> </span>Git<span class="w"> </span>commit:<span class="w">        </span>cb74dfc
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#microservices-2.docker-fundamentals-__codelineno-2-7"></a><span class="w"> </span>Built:<span class="w">             </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">21</span>:53:15<span class="w"> </span><span class="m">2023</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#microservices-2.docker-fundamentals-__codelineno-2-8"></a><span class="w"> </span>OS/Arch:<span class="w">           </span>windows/amd64
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#microservices-2.docker-fundamentals-__codelineno-2-9"></a><span class="w"> </span>Context:<span class="w">           </span>default
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#microservices-2.docker-fundamentals-__codelineno-2-10"></a>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#microservices-2.docker-fundamentals-__codelineno-2-11"></a>Server:<span class="w"> </span>Docker<span class="w"> </span>Desktop<span class="w"> </span><span class="m">4</span>.21.1<span class="w"> </span><span class="o">(</span><span class="m">114176</span><span class="o">)</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#microservices-2.docker-fundamentals-__codelineno-2-12"></a><span class="w"> </span>Engine:
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#microservices-2.docker-fundamentals-__codelineno-2-13"></a><span class="w">  </span>Version:<span class="w">          </span><span class="m">24</span>.0.2
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#microservices-2.docker-fundamentals-__codelineno-2-14"></a><span class="w">  </span>API<span class="w"> </span>version:<span class="w">      </span><span class="m">1</span>.43<span class="w"> </span><span class="o">(</span>minimum<span class="w"> </span>version<span class="w"> </span><span class="m">1</span>.12<span class="o">)</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#microservices-2.docker-fundamentals-__codelineno-2-15"></a><span class="w">  </span>Go<span class="w"> </span>version:<span class="w">       </span>go1.20.4
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#microservices-2.docker-fundamentals-__codelineno-2-16"></a><span class="w">  </span>Git<span class="w"> </span>commit:<span class="w">       </span>659604f
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#microservices-2.docker-fundamentals-__codelineno-2-17"></a><span class="w">  </span>Built:<span class="w">            </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">25</span><span class="w"> </span><span class="m">21</span>:52:17<span class="w"> </span><span class="m">2023</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#microservices-2.docker-fundamentals-__codelineno-2-18"></a><span class="w">  </span>OS/Arch:<span class="w">          </span>linux/amd64
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#microservices-2.docker-fundamentals-__codelineno-2-19"></a><span class="w">  </span>Experimental:<span class="w">     </span><span class="nb">false</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#microservices-2.docker-fundamentals-__codelineno-2-20"></a><span class="w"> </span>containerd:
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#microservices-2.docker-fundamentals-__codelineno-2-21"></a><span class="w">  </span>Version:<span class="w">          </span><span class="m">1</span>.6.21
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#microservices-2.docker-fundamentals-__codelineno-2-22"></a><span class="w">  </span>GitCommit:<span class="w">        </span>3dce8eb055cbb6872793272b4f20ed16117344f8
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#microservices-2.docker-fundamentals-__codelineno-2-23"></a><span class="w"> </span>runc:
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#microservices-2.docker-fundamentals-__codelineno-2-24"></a><span class="w">  </span>Version:<span class="w">          </span><span class="m">1</span>.1.7
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#microservices-2.docker-fundamentals-__codelineno-2-25"></a><span class="w">  </span>GitCommit:<span class="w">        </span>v1.1.7-0-g860f061
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#microservices-2.docker-fundamentals-__codelineno-2-26"></a><span class="w"> </span>docker-init:
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#microservices-2.docker-fundamentals-__codelineno-2-27"></a><span class="w">  </span>Version:<span class="w">          </span><span class="m">0</span>.19.0
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#microservices-2.docker-fundamentals-__codelineno-2-28"></a><span class="w">  </span>GitCommit:<span class="w">        </span>de40ad0
</span></code></pre></div>
<p>Docker is now installed on your machine, and you can start using it to containerize your applications.</p>
<h2 id="microservices-2.docker-fundamentals-docker-commands">Docker Commands</h2>
<p>For more comprehensive details on Docker commands, please refer to the <a href="https://anjikeesari.com/developertools/cheatsheets/docker-cheat-sheet/" target="_blank">Docker Commands Cheat Sheet</a> on our website.</p>
<h2 id="microservices-2.docker-fundamentals-conclusion">Conclusion</h2>
<p>Docker and containerization have changed the way we build and use application development. Now that you understand the basics of Docker, you're ready to dive deeper. Docker is straightforward and flexible, making it a great tool for developers. It ensures that your application works the same way in different situations, keeps things separate, and easily grows with your needs. So, go ahead and start your journey with containers.</p>
<h2 id="microservices-2.docker-fundamentals-references">References</h2>
<ul>
<li><a href="https://docs.docker.com/get-started/" target="_blank">Getting started guide</a></li>
<li><a href="https://hub.docker.com/search?q=" target="_blank">Docker images</a></li>
<li><a href="https://docs.docker.com/" target="_blank">Docker Documentation</a></li>
<li><a href="https://hub.docker.com/" target="_blank">Docker Hub</a></li>
</ul></section><section class="print-page" id="microservices-3-docker-getting-started" heading-number="3.3"><h1 id="microservices-3-docker-getting-started-chapter-3-getting-started-with-docker">Chapter-3: Getting Started with Docker</h1>
<p>Docker is a platform for developing, shipping, and running applications in containers. Containers allow you to package an application and its dependencies into a single unit, making it easy to deploy consistently across different environments.  </p>
<p>In this lab, I will guide you through the process of creating Docker images, containers, and finally accessing the sample application in the web browser.</p>
<p>If you are new to Docker and want to learn its fundamental concepts, please visit our website. - <a href="https://anjikeesari.com/articles/docker-fundamentals/" target="_blank">Exploring Docker Fundamentals</a> </p>
<h2 id="microservices-3-docker-getting-started-objective">Objective</h2>
<p>In this exercise, our objective is to accomplish and learn the following tasks:</p>
<ol>
<li><a href="#microservices-3-docker-getting-started-step-1-get-the-sample-application">Step 1: Get the Sample Application</a></li>
<li><a href="#microservices-3-docker-getting-started-step-2-create-docker-image">Step 2: Create Docker Image</a></li>
<li><a href="#microservices-3-docker-getting-started-step-3-create-docker-container">Step 3: Create Docker Container</a></li>
<li><a href="#microservices-3-docker-getting-started-step-4-port-binding">Step 4: Port Binding</a></li>
<li><a href="#microservices-3-docker-getting-started-step-5-browse-the-frontend-application">Step 5: Browse the Frontend Application</a></li>
<li><a href="#microservices-3-docker-getting-started-step-6-view-docker-logs">Step 6: View Docker Logs</a></li>
<li><a href="#microservices-3-docker-getting-started-step-7-docker-commands">Step 7: Docker Commands</a></li>
</ol>
<h2 id="microservices-3-docker-getting-started-prerequisites">Prerequisites</h2>
<p>Before starting this lab, ensure you have the following prerequisites in place:</p>
<ul>
<li>Visual Studio Code :  - <a href="https://code.visualstudio.com/download" target="_blank">Visual Studio Code Downloads</a>.</li>
<li>Docker desktop :  - <a href="https://docs.docker.com/get-docker/" target="_blank">Docker Downloads</a>.</li>
<li>Git Client tool:  - <a href="https://git-scm.com/downloads" target="_blank">Git Downloads</a>.</li>
</ul>
<p>Verify the docker installation by running following commands:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#microservices-3-docker-getting-started-__codelineno-0-1"></a>docker<span class="w"> </span>version
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#microservices-3-docker-getting-started-__codelineno-0-2"></a><span class="c1"># or</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#microservices-3-docker-getting-started-__codelineno-0-3"></a>docker<span class="w"> </span>--version
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#microservices-3-docker-getting-started-__codelineno-0-4"></a><span class="c1"># or</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#microservices-3-docker-getting-started-__codelineno-0-5"></a>docker<span class="w"> </span>-v
</span></code></pre></div>
<h2 id="microservices-3-docker-getting-started-step-1-get-the-sample-application">Step 1: Get the Sample Application</h2>
<p>To begin, you'll need a sample application to work with. You can either use an existing application or create a simple one. </p>
<p>In this task, we'll start by searching for an image to run locally. For example, we'll use the <code>Nginx</code> image from Docker Hub using the following URL: <a href="https://hub.docker.com/search?q=">Docker Hub Search</a></p>
<h2 id="microservices-3-docker-getting-started-step-2-create-docker-image">Step 2: Create Docker Image</h2>
<p>Now that we've identified the image we want to use, let's pull it from Docker Hub into our local Docker Desktop and run it locally.</p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#microservices-3-docker-getting-started-__codelineno-1-1"></a>docker<span class="w"> </span>pull<span class="w"> </span>nginx
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#microservices-3-docker-getting-started-__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#microservices-3-docker-getting-started-__codelineno-1-3"></a><span class="c1"># output</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#microservices-3-docker-getting-started-__codelineno-1-4"></a>Using<span class="w"> </span>default<span class="w"> </span>tag:<span class="w"> </span>latest
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#microservices-3-docker-getting-started-__codelineno-1-5"></a>latest:<span class="w"> </span>Pulling<span class="w"> </span>from<span class="w"> </span>library/nginx
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#microservices-3-docker-getting-started-__codelineno-1-6"></a>a5573528b1f0:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#microservices-3-docker-getting-started-__codelineno-1-7"></a>8897d65c8417:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#microservices-3-docker-getting-started-__codelineno-1-8"></a>fbc138d1d206:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#microservices-3-docker-getting-started-__codelineno-1-9"></a>06f386eb9182:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#microservices-3-docker-getting-started-__codelineno-1-10"></a>aeb2f3db77c3:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#microservices-3-docker-getting-started-__codelineno-1-11"></a>64fb762834ec:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#microservices-3-docker-getting-started-__codelineno-1-12"></a>e5a7e61f6ff4:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#microservices-3-docker-getting-started-__codelineno-1-13"></a>Digest:<span class="w"> </span>sha256:4c0fdaa8b6341bfdeca5f18f7837462c80cff90527ee35ef185571e1c327beac
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#microservices-3-docker-getting-started-__codelineno-1-14"></a>Status:<span class="w"> </span>Downloaded<span class="w"> </span>newer<span class="w"> </span>image<span class="w"> </span><span class="k">for</span><span class="w"> </span>nginx:latest
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#microservices-3-docker-getting-started-__codelineno-1-15"></a>docker.io/library/nginx:latest
</span></code></pre></div>
<a href="../microservices/images/docker/image-0.png" target="_blank"><img alt="Alt text" src="../microservices/images/docker/image-0.png" /></a></p>
<p>List Docker images from Docker Desktop:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#microservices-3-docker-getting-started-__codelineno-2-1"></a>docker<span class="w"> </span>images
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#microservices-3-docker-getting-started-__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#microservices-3-docker-getting-started-__codelineno-2-3"></a><span class="c1"># output</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#microservices-3-docker-getting-started-__codelineno-2-4"></a>REPOSITORY<span class="w">   </span>TAG<span class="w">       </span>IMAGE<span class="w"> </span>ID<span class="w">       </span>CREATED<span class="w">        </span>SIZE
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#microservices-3-docker-getting-started-__codelineno-2-5"></a>nginx<span class="w">        </span>latest<span class="w">    </span>6c7be49d2a11<span class="w">   </span><span class="m">2</span><span class="w"> </span>months<span class="w"> </span>ago<span class="w">   </span>192MB
</span></code></pre></div>
<h2 id="microservices-3-docker-getting-started-step-3-create-docker-container">Step 3: Create Docker Container</h2>
<p>In this step, we'll create a Docker container by running the <code>docker run</code> command for the image.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#microservices-3-docker-getting-started-__codelineno-3-1"></a>docker<span class="w"> </span>run<span class="w"> </span>nginx
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#microservices-3-docker-getting-started-__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#microservices-3-docker-getting-started-__codelineno-3-3"></a><span class="c1"># output</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#microservices-3-docker-getting-started-__codelineno-3-4"></a>/docker-entrypoint.sh:<span class="w"> </span>/docker-entrypoint.d/<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>empty,<span class="w"> </span>will<span class="w"> </span>attempt<span class="w"> </span>to<span class="w"> </span>perform<span class="w"> </span>configuration
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#microservices-3-docker-getting-started-__codelineno-3-5"></a>/docker-entrypoint.sh:<span class="w"> </span>Looking<span class="w"> </span><span class="k">for</span><span class="w"> </span>shell<span class="w"> </span>scripts<span class="w"> </span><span class="k">in</span><span class="w"> </span>/docker-entrypoint.d/
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#microservices-3-docker-getting-started-__codelineno-3-6"></a>/docker-entrypoint.sh:<span class="w"> </span>Launching<span class="w"> </span>/docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#microservices-3-docker-getting-started-__codelineno-3-7"></a><span class="m">10</span>-listen-on-ipv6-by-default.sh:<span class="w"> </span>info:<span class="w"> </span>Getting<span class="w"> </span>the<span class="w"> </span>checksum<span class="w"> </span>of<span class="w"> </span>/etc/nginx/conf.d/default.conf
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#microservices-3-docker-getting-started-__codelineno-3-8"></a><span class="m">10</span>-listen-on-ipv6-by-default.sh:<span class="w"> </span>info:<span class="w"> </span>Enabled<span class="w"> </span>listen<span class="w"> </span>on<span class="w"> </span>IPv6<span class="w"> </span><span class="k">in</span><span class="w"> </span>/etc/nginx/conf.d/default.conf
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#microservices-3-docker-getting-started-__codelineno-3-9"></a>/docker-entrypoint.sh:<span class="w"> </span>Sourcing<span class="w"> </span>/docker-entrypoint.d/15-local-resolvers.envsh
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#microservices-3-docker-getting-started-__codelineno-3-10"></a>/docker-entrypoint.sh:<span class="w"> </span>Launching<span class="w"> </span>/docker-entrypoint.d/20-envsubst-on-templates.sh
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#microservices-3-docker-getting-started-__codelineno-3-11"></a>/docker-entrypoint.sh:<span class="w"> </span>Launching<span class="w"> </span>/docker-entrypoint.d/30-tune-worker-processes.sh
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#microservices-3-docker-getting-started-__codelineno-3-12"></a>/docker-entrypoint.sh:<span class="w"> </span>Configuration<span class="w"> </span>complete<span class="p">;</span><span class="w"> </span>ready<span class="w"> </span><span class="k">for</span><span class="w"> </span>start<span class="w"> </span>up
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#microservices-3-docker-getting-started-__codelineno-3-13"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:27:56<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: using the &quot;epoll&quot; event method</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#microservices-3-docker-getting-started-__codelineno-3-14"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:27:56<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: nginx/1.25.3</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#microservices-3-docker-getting-started-__codelineno-3-15"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:27:56<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: built by gcc 12.2.0 (Debian 12.2.0-14) </span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#microservices-3-docker-getting-started-__codelineno-3-16"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:27:56<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: OS: Linux 6.3.13-linuxkit</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#microservices-3-docker-getting-started-__codelineno-3-17"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:27:56<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: getrlimit(RLIMIT_NOFILE): 1048576:1048576</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#microservices-3-docker-getting-started-__codelineno-3-18"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:27:56<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: start worker processes</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#microservices-3-docker-getting-started-__codelineno-3-19"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:27:56<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: start worker process 29</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#microservices-3-docker-getting-started-__codelineno-3-20"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:27:56<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: start worker process 30</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#microservices-3-docker-getting-started-__codelineno-3-21"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:27:56<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: start worker process 31</span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#microservices-3-docker-getting-started-__codelineno-3-22"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:27:56<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: start worker process 32</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#microservices-3-docker-getting-started-__codelineno-3-23"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:27:56<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: start worker process 33</span>
</span></code></pre></div>
<p><a href="../microservices/images/docker/image-1.png" target="_blank"><img alt="Alt text" src="../microservices/images/docker/image-1.png" /></a></p>
<p>Open a new terminal and run the following command to list containers:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#microservices-3-docker-getting-started-__codelineno-4-1"></a>dockder<span class="w"> </span>ps
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#microservices-3-docker-getting-started-__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#microservices-3-docker-getting-started-__codelineno-4-3"></a><span class="c1"># output</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#microservices-3-docker-getting-started-__codelineno-4-4"></a>CONTAINER<span class="w"> </span>ID<span class="w">   </span>IMAGE<span class="w">     </span>COMMAND<span class="w">                  </span>CREATED<span class="w">         </span>STATUS<span class="w">         </span>PORTS<span class="w">     </span>NAMES
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#microservices-3-docker-getting-started-__codelineno-4-5"></a>8d23e3ceb3da<span class="w">   </span>nginx<span class="w">     </span><span class="s2">&quot;/docker-entrypoint.…&quot;</span><span class="w">   </span><span class="m">3</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">2</span><span class="w"> </span>minutes<span class="w">   </span><span class="m">80</span>/tcp<span class="w">    </span>lucid_edison
</span></code></pre></div>
<p>You can watch the <code>container logs</code> in the first terminal.</p>
<p>To exit the container, press <code>Ctrl + C</code>.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#microservices-3-docker-getting-started-__codelineno-5-1"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:28:00<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: signal 28 (SIGWINCH) received</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#microservices-3-docker-getting-started-__codelineno-5-2"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:28:00<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: signal 28 (SIGWINCH) received</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#microservices-3-docker-getting-started-__codelineno-5-3"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:30:50<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: signal 28 (SIGWINCH) received</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#microservices-3-docker-getting-started-__codelineno-5-4"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:30:50<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: signal 28 (SIGWINCH) received</span>
</span></code></pre></div>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#microservices-3-docker-getting-started-__codelineno-6-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>nginx<span class="w"> </span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#microservices-3-docker-getting-started-__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#microservices-3-docker-getting-started-__codelineno-6-3"></a><span class="c1"># output </span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#microservices-3-docker-getting-started-__codelineno-6-4"></a>6f5dbcae83bd3ac6a0ea8bdb45f753bf72a723179503d4b4ebce4ddeae2378e2
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#microservices-3-docker-getting-started-__codelineno-6-5"></a>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#microservices-3-docker-getting-started-__codelineno-6-6"></a><span class="c1"># Now, you can run the following command to see the list of running containers:</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#microservices-3-docker-getting-started-__codelineno-6-7"></a>docker<span class="w"> </span>ps
</span></code></pre></div>
<p>Alternatively, you can also run the image directly from Docker Hub. Here are the example commands:</p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#microservices-3-docker-getting-started-__codelineno-7-1"></a>docker<span class="w"> </span>run<span class="w"> </span>nginx:1.25.3-alpine
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#microservices-3-docker-getting-started-__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#microservices-3-docker-getting-started-__codelineno-7-3"></a><span class="c1"># output</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#microservices-3-docker-getting-started-__codelineno-7-4"></a>Unable<span class="w"> </span>to<span class="w"> </span>find<span class="w"> </span>image<span class="w"> </span><span class="s1">&#39;nginx:1.25.3-alpine&#39;</span><span class="w"> </span>locally
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#microservices-3-docker-getting-started-__codelineno-7-5"></a><span class="m">1</span>.25.3-alpine:<span class="w"> </span>Pulling<span class="w"> </span>from<span class="w"> </span>library/nginx
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#microservices-3-docker-getting-started-__codelineno-7-6"></a>2c03dbb20264:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#microservices-3-docker-getting-started-__codelineno-7-7"></a>0ed066aadd11:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#microservices-3-docker-getting-started-__codelineno-7-8"></a>4eeb1ddd7404:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#microservices-3-docker-getting-started-__codelineno-7-9"></a>9ba8827f116b:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#microservices-3-docker-getting-started-__codelineno-7-10"></a>2bc60ecca38f:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#microservices-3-docker-getting-started-__codelineno-7-11"></a>11d942ec6258:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#microservices-3-docker-getting-started-__codelineno-7-12"></a>fed1b403bb45:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#microservices-3-docker-getting-started-__codelineno-7-13"></a>392e92e0a8e8:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#microservices-3-docker-getting-started-__codelineno-7-14"></a>Digest:<span class="w"> </span>sha256:a59278fd22a9d411121e190b8cec8aa57b306aa3332459197777583beb728f59
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#microservices-3-docker-getting-started-__codelineno-7-15"></a>Status:<span class="w"> </span>Downloaded<span class="w"> </span>newer<span class="w"> </span>image<span class="w"> </span><span class="k">for</span><span class="w"> </span>nginx:1.25.3-alpine
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#microservices-3-docker-getting-started-__codelineno-7-16"></a>/docker-entrypoint.sh:<span class="w"> </span>/docker-entrypoint.d/<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>empty,<span class="w"> </span>will<span class="w"> </span>attempt<span class="w"> </span>to<span class="w"> </span>perform<span class="w"> </span>configuration
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#microservices-3-docker-getting-started-__codelineno-7-17"></a>/docker-entrypoint.sh:<span class="w"> </span>Looking<span class="w"> </span><span class="k">for</span><span class="w"> </span>shell<span class="w"> </span>scripts<span class="w"> </span><span class="k">in</span><span class="w"> </span>/docker-entrypoint.d/
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#microservices-3-docker-getting-started-__codelineno-7-18"></a>/docker-entrypoint.sh:<span class="w"> </span>Launching<span class="w"> </span>/docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#microservices-3-docker-getting-started-__codelineno-7-19"></a><span class="m">10</span>-listen-on-ipv6-by-default.sh:<span class="w"> </span>info:<span class="w"> </span>Getting<span class="w"> </span>the<span class="w"> </span>checksum<span class="w"> </span>of<span class="w"> </span>/etc/nginx/conf.d/default.conf
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#microservices-3-docker-getting-started-__codelineno-7-20"></a><span class="m">10</span>-listen-on-ipv6-by-default.sh:<span class="w"> </span>info:<span class="w"> </span>Enabled<span class="w"> </span>listen<span class="w"> </span>on<span class="w"> </span>IPv6<span class="w"> </span><span class="k">in</span><span class="w"> </span>/etc/nginx/conf.d/default.conf
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#microservices-3-docker-getting-started-__codelineno-7-21"></a>/docker-entrypoint.sh:<span class="w"> </span>Sourcing<span class="w"> </span>/docker-entrypoint.d/15-local-resolvers.envsh
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#microservices-3-docker-getting-started-__codelineno-7-22"></a>/docker-entrypoint.sh:<span class="w"> </span>Launching<span class="w"> </span>/docker-entrypoint.d/20-envsubst-on-templates.sh
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#microservices-3-docker-getting-started-__codelineno-7-23"></a>/docker-entrypoint.sh:<span class="w"> </span>Launching<span class="w"> </span>/docker-entrypoint.d/30-tune-worker-processes.sh
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#microservices-3-docker-getting-started-__codelineno-7-24"></a>/docker-entrypoint.sh:<span class="w"> </span>Configuration<span class="w"> </span>complete<span class="p">;</span><span class="w"> </span>ready<span class="w"> </span><span class="k">for</span><span class="w"> </span>start<span class="w"> </span>up
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#microservices-3-docker-getting-started-__codelineno-7-25"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:39:23<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: using the &quot;epoll&quot; event method</span>
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#microservices-3-docker-getting-started-__codelineno-7-26"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:39:23<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: nginx/1.25.3</span>
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#microservices-3-docker-getting-started-__codelineno-7-27"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:39:23<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: built by gcc 12.2.1 20220924 (Alpine 12.2.1_git20220924-r10) </span>
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#microservices-3-docker-getting-started-__codelineno-7-28"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:39:23<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: OS: Linux 6.3.13-linuxkit</span>
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29" href="#microservices-3-docker-getting-started-__codelineno-7-29"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:39:23<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: getrlimit(RLIMIT_NOFILE): 1048576:1048576</span>
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30" href="#microservices-3-docker-getting-started-__codelineno-7-30"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:39:23<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: start worker processes</span>
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31" href="#microservices-3-docker-getting-started-__codelineno-7-31"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:39:23<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: start worker process 29</span>
</span><span id="__span-7-32"><a id="__codelineno-7-32" name="__codelineno-7-32" href="#microservices-3-docker-getting-started-__codelineno-7-32"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:39:23<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: start worker process 30</span>
</span><span id="__span-7-33"><a id="__codelineno-7-33" name="__codelineno-7-33" href="#microservices-3-docker-getting-started-__codelineno-7-33"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:39:23<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: start worker process 31</span>
</span><span id="__span-7-34"><a id="__codelineno-7-34" name="__codelineno-7-34" href="#microservices-3-docker-getting-started-__codelineno-7-34"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:39:23<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: start worker process 32</span>
</span><span id="__span-7-35"><a id="__codelineno-7-35" name="__codelineno-7-35" href="#microservices-3-docker-getting-started-__codelineno-7-35"></a><span class="m">2024</span>/01/15<span class="w"> </span><span class="m">04</span>:39:23<span class="w"> </span><span class="o">[</span>notice<span class="o">]</span><span class="w"> </span><span class="m">1</span><span class="c1">#1: start worker process 33</span>
</span></code></pre></div>
Now, you'll see two containers running, one from local Docker Desktop and the second one from the remote Docker Hub registry.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#microservices-3-docker-getting-started-__codelineno-8-1"></a>docker<span class="w"> </span>ps
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#microservices-3-docker-getting-started-__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#microservices-3-docker-getting-started-__codelineno-8-3"></a><span class="c1"># output</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#microservices-3-docker-getting-started-__codelineno-8-4"></a>CONTAINER<span class="w"> </span>ID<span class="w">   </span>IMAGE<span class="w">                 </span>COMMAND<span class="w">                  </span>CREATED<span class="w">              </span>STATUS<span class="w">              </span>PORTS<span class="w">     </span>NAMES
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#microservices-3-docker-getting-started-__codelineno-8-5"></a>4df5f0ae77d9<span class="w">   </span>nginx:1.25.3-alpine<span class="w">   </span><span class="s2">&quot;/docker-entrypoint.…&quot;</span><span class="w">   </span>About<span class="w"> </span>a<span class="w"> </span>minute<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span>About<span class="w"> </span>a<span class="w"> </span>minute<span class="w">   </span><span class="m">80</span>/tcp<span class="w">    </span>nostalgic_lamarr
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#microservices-3-docker-getting-started-__codelineno-8-6"></a>6f5dbcae83bd<span class="w">   </span>nginx<span class="w">                 </span><span class="s2">&quot;/docker-entrypoint.…&quot;</span><span class="w">   </span><span class="m">6</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">        </span>Up<span class="w"> </span><span class="m">6</span><span class="w"> </span>minutes<span class="w">        </span><span class="m">80</span>/tcp<span class="w">    </span>modest_hermann
</span></code></pre></div>
<p>docker images from docker desktop</p>
<p><a href="../microservices/images/docker/image-2.png" target="_blank"><img alt="Alt text" src="../microservices/images/docker/image-2.png" /></a></p>
<p>docker containers from docker desktop</p>
<p><a href="../microservices/images/docker/image-3.png" target="_blank"><img alt="Alt text" src="../microservices/images/docker/image-3.png" /></a></p>
<p>you can also run following commnds to see images and containers running locally.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#microservices-3-docker-getting-started-__codelineno-9-1"></a>docker<span class="w"> </span>image<span class="w"> </span>ls
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#microservices-3-docker-getting-started-__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#microservices-3-docker-getting-started-__codelineno-9-3"></a><span class="c1"># output</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#microservices-3-docker-getting-started-__codelineno-9-4"></a>REPOSITORY<span class="w">   </span>TAG<span class="w">             </span>IMAGE<span class="w"> </span>ID<span class="w">       </span>CREATED<span class="w">        </span>SIZE
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#microservices-3-docker-getting-started-__codelineno-9-5"></a>nginx<span class="w">        </span>latest<span class="w">          </span>6c7be49d2a11<span class="w">   </span><span class="m">2</span><span class="w"> </span>months<span class="w"> </span>ago<span class="w">   </span>192MB
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#microservices-3-docker-getting-started-__codelineno-9-6"></a>nginx<span class="w">        </span><span class="m">1</span>.25.3-alpine<span class="w">   </span>74077e780ec7<span class="w">   </span><span class="m">2</span><span class="w"> </span>months<span class="w"> </span>ago<span class="w">   </span><span class="m">43</span>.5MB
</span></code></pre></div>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#microservices-3-docker-getting-started-__codelineno-10-1"></a>docker<span class="w"> </span>container<span class="w"> </span>ls
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#microservices-3-docker-getting-started-__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#microservices-3-docker-getting-started-__codelineno-10-3"></a><span class="c1"># output</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#microservices-3-docker-getting-started-__codelineno-10-4"></a>CONTAINER<span class="w"> </span>ID<span class="w">   </span>IMAGE<span class="w">                 </span>COMMAND<span class="w">                  </span>CREATED<span class="w">          </span>STATUS<span class="w">          </span>PORTS<span class="w">     </span>NAMES
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#microservices-3-docker-getting-started-__codelineno-10-5"></a>4df5f0ae77d9<span class="w">   </span>nginx:1.25.3-alpine<span class="w">   </span><span class="s2">&quot;/docker-entrypoint.…&quot;</span><span class="w">   </span><span class="m">5</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">    </span>Up<span class="w"> </span><span class="m">5</span><span class="w"> </span>minutes<span class="w">    </span><span class="m">80</span>/tcp<span class="w">    </span>nostalgic_lamarr
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#microservices-3-docker-getting-started-__codelineno-10-6"></a>6f5dbcae83bd<span class="w">   </span>nginx<span class="w">                 </span><span class="s2">&quot;/docker-entrypoint.…&quot;</span><span class="w">   </span><span class="m">10</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">10</span><span class="w"> </span>minutes<span class="w">   </span><span class="m">80</span>/tcp<span class="w">    </span>modest_hermann
</span></code></pre></div>
<h2 id="microservices-3-docker-getting-started-step-4-port-binding">Step 4: Port Binding</h2>
<p>Your application is now running inside the Docker container, and you've mapped port 8080 from the container to your host. This means you can access your application using <code>http://localhost:8080</code> in your web browser.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#microservices-3-docker-getting-started-__codelineno-11-1"></a><span class="c1"># list the containers</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#microservices-3-docker-getting-started-__codelineno-11-2"></a>docker<span class="w"> </span>ps
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#microservices-3-docker-getting-started-__codelineno-11-3"></a>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#microservices-3-docker-getting-started-__codelineno-11-4"></a><span class="c1"># then stop the container </span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#microservices-3-docker-getting-started-__codelineno-11-5"></a>docker<span class="w"> </span>stop<span class="w"> </span>6f5dbcae83bd
</span></code></pre></div>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#microservices-3-docker-getting-started-__codelineno-12-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>-p<span class="w"> </span><span class="m">8080</span>:80<span class="w"> </span>nginx:1.25.3-alpine
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#microservices-3-docker-getting-started-__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#microservices-3-docker-getting-started-__codelineno-12-3"></a><span class="c1"># output</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#microservices-3-docker-getting-started-__codelineno-12-4"></a>f21ada11af57b799c9b834d0a6c8e6e1628c6289d64cf65fdc0968cbe94500fd
</span></code></pre></div>
<h2 id="microservices-3-docker-getting-started-step-5-browse-the-frontend-application">Step 5: Browse the Frontend Application</h2>
<p>Open your web browser and navigate to <code>http://localhost:8080</code> to access your Node.js application running in the Docker container.</p>
<p><a href="../microservices/images/docker/image-4.png" target="_blank"><img alt="Alt text" src="../microservices/images/docker/image-4.png" /></a></p>
<h2 id="microservices-3-docker-getting-started-step-6-view-docker-logs">Step 6: View Docker Logs</h2>
<p>To view the logs of your running container, use the following command:</p>
<p>This will display the logs generated by your application.</p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#microservices-3-docker-getting-started-__codelineno-13-1"></a>docker<span class="w"> </span>logs<span class="w"> </span>f21ada11af57
</span></code></pre></div>
<a href="../microservices/images/docker/image-5.png" target="_blank"><img alt="Alt text" src="../microservices/images/docker/image-5.png" /></a></p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#microservices-3-docker-getting-started-__codelineno-14-1"></a>docker<span class="w"> </span>ps<span class="w"> </span>-a<span class="w"> </span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#microservices-3-docker-getting-started-__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#microservices-3-docker-getting-started-__codelineno-14-3"></a><span class="c1"># output</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#microservices-3-docker-getting-started-__codelineno-14-4"></a>CONTAINER<span class="w"> </span>ID<span class="w">   </span>IMAGE<span class="w">                 </span>COMMAND<span class="w">                  </span>CREATED<span class="w">          </span>STATUS<span class="w">                      </span>PORTS<span class="w">                  </span>NAMES
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#microservices-3-docker-getting-started-__codelineno-14-5"></a>f21ada11af57<span class="w">   </span>nginx:1.25.3-alpine<span class="w">   </span><span class="s2">&quot;/docker-entrypoint.…&quot;</span><span class="w">   </span><span class="m">7</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">    </span>Up<span class="w"> </span><span class="m">7</span><span class="w"> </span>minutes<span class="w">                </span><span class="m">0</span>.0.0.0:8080-&gt;80/tcp<span class="w">   </span>nifty_goldberg
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#microservices-3-docker-getting-started-__codelineno-14-6"></a>4df5f0ae77d9<span class="w">   </span>nginx:1.25.3-alpine<span class="w">   </span><span class="s2">&quot;/docker-entrypoint.…&quot;</span><span class="w">   </span><span class="m">19</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">19</span><span class="w"> </span>minutes<span class="w">               </span><span class="m">80</span>/tcp<span class="w">                 </span>nostalgic_lamarr
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#microservices-3-docker-getting-started-__codelineno-14-7"></a>6f5dbcae83bd<span class="w">   </span>nginx<span class="w">                 </span><span class="s2">&quot;/docker-entrypoint.…&quot;</span><span class="w">   </span><span class="m">25</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">   </span>Exited<span class="w"> </span><span class="o">(</span><span class="m">0</span><span class="o">)</span><span class="w"> </span><span class="m">10</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">                          </span>modest_hermann
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#microservices-3-docker-getting-started-__codelineno-14-8"></a>8d23e3ceb3da<span class="w">   </span>nginx<span class="w">                 </span><span class="s2">&quot;/docker-entrypoint.…&quot;</span><span class="w">   </span><span class="m">31</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">   </span>Exited<span class="w"> </span><span class="o">(</span><span class="m">0</span><span class="o">)</span><span class="w"> </span><span class="m">25</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">                          </span>lucid_edison
</span></code></pre></div>
<p>Naming the Container:</p>
<p>You can also name the container using the <code>--name</code> flag:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#microservices-3-docker-getting-started-__codelineno-15-1"></a>docker<span class="w"> </span>run<span class="w"> </span>--name<span class="w"> </span>nginx-app<span class="w"> </span>-d<span class="w"> </span>-p<span class="w"> </span><span class="m">8080</span>:80<span class="w"> </span>nginx:1.25.3-alpine
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#microservices-3-docker-getting-started-__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#microservices-3-docker-getting-started-__codelineno-15-3"></a><span class="c1"># output</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#microservices-3-docker-getting-started-__codelineno-15-4"></a>58e464680a8da16b717171732fb1b67b678b1c8efb115f9adad8d3257c6cc875
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#microservices-3-docker-getting-started-__codelineno-15-5"></a>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#microservices-3-docker-getting-started-__codelineno-15-6"></a><span class="c1"># run following command to see the name</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#microservices-3-docker-getting-started-__codelineno-15-7"></a>docker<span class="w"> </span>ps
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#microservices-3-docker-getting-started-__codelineno-15-8"></a>docker<span class="w"> </span>logs<span class="w"> </span>nginx-app
</span></code></pre></div>
<h2 id="microservices-3-docker-getting-started-step-7-docker-commands">Step 7: Docker Commands</h2>
<p>For more comprehensive details on Docker commands, please refer to the <a href="https://anjikeesari.com/developertools/cheatsheets/docker-cheat-sheet/" target="_blank">Docker Commands Cheat Sheet</a> on our website.</p>
<h2 id="microservices-3-docker-getting-started-conclusion">Conclusion</h2>
<p>In summary, this guide introduced you to Docker, a tool that simplifies how we build, package, and run applications. We've covered essential steps, like getting an example application (nginx), creating Docker images and running containers. We've also learned how to manage ports, access apps in web browsers, and check what's happening behind the scenes with Docker logs. Plus, we touched on some common Docker commands.</p>
<p>Docker is a powerful tool for containerization, enabling you to package and deploy applications with ease. By following these steps, you've created your first Docker application. </p>
<h2 id="microservices-3-docker-getting-started-references">References</h2>
<ul>
<li><a href="https://docs.docker.com/get-started/" target="_blank">Getting started guide</a></li>
<li><a href="https://hub.docker.com/search?q=" target="_blank">Docker images</a></li>
<li><a href="https://docs.docker.com/" target="_blank">Docker Documentation</a></li>
<li><a href="https://hub.docker.com/" target="_blank">Docker Hub</a></li>
<li><a href="https://hub.docker.com/_/nginx" target="_blank">Nginx Docker Official Images</a></li>
</ul></section><section class="print-page" id="microservices-4.aspnet-api" heading-number="3.4"><h1 id="microservices-4.aspnet-api-chapter-4-create-your-first-microservice-with-net-core-web-api">Chapter-4: Create Your First Microservice with .NET Core Web API</h1>
<h2 id="microservices-4.aspnet-api-introduction">Introduction</h2>
<p>Welcome to the first lab in our Microservices chapter. In this lab, we will look into creating a simple RESTful service using the ASP.NET Core Web API project template.</p>
<p>This lab will demonstrate the process of building a RESTful service and generating a docker container using Dockerfile. By following this example, you will learn the fundamentals of creating RESTful APIs using the ASP.NET Core.</p>
<h2 id="microservices-4.aspnet-api-technical-scenario">Technical Scenario</h2>
<p>As a <code>Backend (BE)</code> developer, you have been tasked with creating a RESTful service using .NET Core Web API, which is one of the services on our microservices list. This lab will serve as your introduction to the Microservices Architecture, starting with the basics of setting up a repository, creating a small project, and ultimately containerizing the microservice you build. The containerized microservice will then be pushed to the Azure Container Registry (ACR).</p>
<p>The primary objective of this lab is to prepare an application for deployment on Kubernetes. The microservices you create in this lab will be utilized in subsequent labs, such as the creation of DevOps pipelines or the deployment to Azure Kubernetes Services (AKS). By completing this lab, you will gain a foundational understanding of how microservices can be developed, containerized, and integrated into a Kubernetes environment.</p>
<h2 id="microservices-4.aspnet-api-objective">Objective</h2>
<p>In this exercise, our objective is to accomplish and learn the following tasks:</p>
<ul>
<li><strong>Step-1:</strong> Create a new repo in azure DevOps</li>
<li><strong>Step-2:</strong> Clone the repository</li>
<li><strong>Step-3:</strong> Create a new Web API project</li>
<li><strong>Step-4:</strong> Test Web API project</li>
<li><strong>Step-5:</strong> Add Dockerfiles to the project</li>
<li><strong>Step-6:</strong> Build &amp; Test docker container locally</li>
<li><strong>Step-7:</strong> Publish docker container to ACR</li>
</ul>
<h2 id="microservices-4.aspnet-api-prerequisites">Prerequisites</h2>
<p>Before starting this lab, ensure you have the following prerequisites in place:</p>
<ul>
<li>An Organization in Azure DevOps</li>
<li>A Project in Azure DevOps</li>
<li>Create Repository permission</li>
<li>Git client tool</li>
<li>Download and install software for .NET development </li>
<li>Docker and the VS Code Docker extension</li>
<li>Azure Container Registry (ACR)</li>
</ul>
<h2 id="microservices-4.aspnet-api-architecture-diagram">Architecture Diagram</h2>
<p>The following diagram shows the high level steps to create the Restful service using .NET Core.</p>
<p><a href="../microservices/images/image-8.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-8.png" /></a></p>
<!-- 
Reference architecture diagram from MSDN - [ASP.NET Core Web API](https://learn.microsoft.com/en-us/aspnet/core/tutorials/first-web-api?view=aspnetcore-7.0&tabs=visual-studio){:target="_blank"} -->

<h2 id="microservices-4.aspnet-api-step-1-create-a-new-repo-in-azure-devops">Step-1: Create a new repo in azure DevOps</h2>
<p>We will create a new repository in Azure DevOps to store our project code and related files.</p>
<p>To create a new repository in Azure DevOps, follow these steps:</p>
<ol>
<li>Login into azure DevOps -  <a href="https://dev.azure.com" target="_blank">Azure DevOps</a></li>
<li>Select the project where we want to create the repo</li>
<li>Click on <code>Repos</code> left nav link</li>
<li>From the repo drop-down, select <code>New repository</code></li>
<li>In the <code>Create a new repository</code> dialog, verify that Git is the repository type and enter a name for the new repository. </li>
<li>You can also add a README and create a <code>.gitignore</code> for the type of code you plan to manage in the repo.</li>
<li>I'd prefer to use lower case for all repos (one of the best practice)<ul>
<li>Repo name - <code>aspnetapi</code> </li>
</ul>
</li>
</ol>
<div class="admonition best-practice">
<p class="admonition-title">Best-practice</p>
<p>When creating repositories in Azure DevOps, it is recommended to use lower case for all repository names. Using lower case consistently throughout your repositories helps maintain consistency, readability, and ease of navigation within your projects.</p>
<p>By adhering to this best practice, you ensure that your repository names are uniform and standardized, regardless of the specific domain or microservice they represent. This practice promotes clarity and reduces the chances of confusion or inconsistencies when working with multiple repositories within your organization.</p>
</div>
<p>For example: </p>
<p><a href="../microservices/images/image-11.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-11.jpg" /></a></p>
<h2 id="microservices-4.aspnet-api-step-2-clone-the-repo-from-azure-devops">Step-2: Clone the repo from azure DevOps</h2>
<p>After creating the repository, we will clone it locally to establish a local working copy of the project.</p>
<p>To clone a repository from Azure DevOps, you will need to have the Git client installed on your local machine. follow these steps to clone the source code locally:</p>
<ol>
<li>
<p>Sign in to the Azure DevOps website <a href="https://dev.azure.com/" target="_blank">Azure DevOps Login</a> with your Azure DevOps account.</p>
</li>
<li>
<p>Navigate to the project that contains the repository you want to clone.</p>
</li>
<li>
<p>Click on the <code>Repos</code> tab in the navigation menu.</p>
</li>
<li>
<p>Find the repository you want to clone and click on the <code>Clone</code> button.</p>
</li>
<li>
<p>Copy the URL of the repository.</p>
</li>
<li>
<p>Open a terminal window or command prompt on your local machine, and navigate to the directory where you want to clone the repository.</p>
</li>
<li>
<p>Run the following command to clone the repository:</p>
</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#microservices-4.aspnet-api-__codelineno-0-1"></a>git<span class="w"> </span>clone<span class="w"> </span>&lt;repository<span class="w"> </span>URL&gt;
</span></code></pre></div>
<p>When prompted, enter your Azure DevOps credentials.</p>
<p>The repository will be cloned to your local machine, and you can start working with the code.</p>
<p>Examples:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#microservices-4.aspnet-api-__codelineno-1-1"></a>C:<span class="se">\U</span>sers<span class="se">\a</span>nji.keesari&gt;cd<span class="w"> </span>C:<span class="se">\S</span>ource<span class="se">\R</span>epos
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#microservices-4.aspnet-api-__codelineno-1-2"></a>C:<span class="se">\S</span>ource<span class="se">\R</span>epos&gt;git<span class="w"> </span>clone<span class="w"> </span>https://keesari.visualstudio.com/Microservices/_git/aspnetapi
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#microservices-4.aspnet-api-__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#microservices-4.aspnet-api-__codelineno-1-4"></a>or
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#microservices-4.aspnet-api-__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#microservices-4.aspnet-api-__codelineno-1-6"></a><span class="c1"># cloning from main branch for the first time</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#microservices-4.aspnet-api-__codelineno-1-7"></a>git<span class="w"> </span>clone<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://keesari.visualstudio.com/Microservices/_git/aspnetapi<span class="w">  </span>-b<span class="w"> </span>main<span class="w"> </span>C:<span class="se">\S</span>ource<span class="se">\R</span>epos<span class="se">\M</span>icroservices<span class="se">\a</span>spnetapi
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#microservices-4.aspnet-api-__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#microservices-4.aspnet-api-__codelineno-1-9"></a><span class="c1"># cloning from feature branches</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#microservices-4.aspnet-api-__codelineno-1-10"></a>git<span class="w"> </span>clone<span class="w"> </span>https://keesari.visualstudio.com/Microservices/_git/aspnetapi<span class="w">  </span>-b<span class="w"> </span>develop<span class="w"> </span>C:<span class="se">\S</span>ource<span class="se">\R</span>epos<span class="se">\M</span>icroservices<span class="se">\a</span>spnetapi
</span></code></pre></div>
<p>Please refer to our <a href="https://anjikeesari.com/developertools/cheatsheets/git-cheat-sheet/" target="_blank">Git Cheat-Sheet</a>, which provides a comprehensive list of Git commands and their usage. </p>
<p><a href="https://anjikeesari.com/developertools/cheatsheets/git-cheat-sheet" target="_blank">Anji Keesari - Git Commands</a></p>
<h2 id="microservices-4.aspnet-api-step-3-create-a-new-net-core-web-api-project">Step-3: Create a new .NET Core Web API project</h2>
<p>Using the .NET Core Web API template, we will create a new project that serves as the foundation for our RESTful service.</p>
<p>We will be using Visual Studio Code instead of Visual Studio to make things faster and easy and save time and money.</p>
<div class="admonition best-practice">
<p class="admonition-title">Best-practice</p>
<p>I recommend using Visual Studio Code (VS Code) as your preferred development environment instead of Visual Studio.</p>
<p>Visual Studio Code is a lightweight, cross-platform code editor that offers powerful features and extensions tailored for modern development workflows. It provides a streamlined and customizable interface, allowing you to focus on coding without unnecessary overhead.</p>
</div>
<p>To create a new .NET Core Web API project, you will need to have the .NET Core SDK installed on your machine. You can download the .NET Core SDK from the .NET website <a href="https://dotnet.microsoft.com/download" target="_blank">Download .NET</a>.</p>
<p>Once you have the .NET Core SDK installed, follow these steps to create a new .NET Core Web API project:</p>
<ol>
<li>Open a terminal window and navigate to the directory where you want to create your project.</li>
<li>Run the <code>dotnet new</code> command to create a new .NET Core Web API project:
Let's take a look some useful <code>dotnet</code> command before creating the project.
Use this command to get the <code>dotnet</code> commands help so that your get idea on how use these commands better. 
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#microservices-4.aspnet-api-__codelineno-2-1"></a>dotnet<span class="w"> </span>--help
</span></code></pre></div>
Use this command to get list of available <code>dotnet</code> project templates
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#microservices-4.aspnet-api-__codelineno-3-1"></a>dotnet<span class="w"> </span>new<span class="w"> </span>--list
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#microservices-4.aspnet-api-__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#microservices-4.aspnet-api-__codelineno-3-3"></a><span class="c1"># output</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#microservices-4.aspnet-api-__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#microservices-4.aspnet-api-__codelineno-3-5"></a>These<span class="w"> </span>templates<span class="w"> </span>matched<span class="w"> </span>your<span class="w"> </span>input:<span class="w"> </span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#microservices-4.aspnet-api-__codelineno-3-6"></a>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#microservices-4.aspnet-api-__codelineno-3-7"></a>Template<span class="w"> </span>Name<span class="w">                                 </span>Short<span class="w"> </span>Name<span class="w">           </span>Language<span class="w">    </span>Tags
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#microservices-4.aspnet-api-__codelineno-3-8"></a>--------------------------------------------<span class="w">  </span>-------------------<span class="w">  </span>----------<span class="w">  </span>-------------------------------------
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#microservices-4.aspnet-api-__codelineno-3-9"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>Empty<span class="w">                            </span>web<span class="w">                  </span><span class="o">[</span>C#<span class="o">]</span>,F#<span class="w">     </span>Web/Empty
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#microservices-4.aspnet-api-__codelineno-3-10"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>gRPC<span class="w"> </span>Service<span class="w">                     </span>grpc<span class="w">                 </span><span class="o">[</span>C#<span class="o">]</span><span class="w">        </span>Web/gRPC
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#microservices-4.aspnet-api-__codelineno-3-11"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>Web<span class="w"> </span>API<span class="w">                          </span>webapi<span class="w">               </span><span class="o">[</span>C#<span class="o">]</span>,F#<span class="w">     </span>Web/WebAPI
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#microservices-4.aspnet-api-__codelineno-3-12"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>Web<span class="w"> </span>App<span class="w">                          </span>razor,webapp<span class="w">         </span><span class="o">[</span>C#<span class="o">]</span><span class="w">        </span>Web/MVC/Razor<span class="w"> </span>Pages
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#microservices-4.aspnet-api-__codelineno-3-13"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>Web<span class="w"> </span>App<span class="w"> </span><span class="o">(</span>Model-View-Controller<span class="o">)</span><span class="w">  </span>mvc<span class="w">                  </span><span class="o">[</span>C#<span class="o">]</span>,F#<span class="w">     </span>Web/MVC
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#microservices-4.aspnet-api-__codelineno-3-14"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>with<span class="w"> </span>Angular<span class="w">                     </span>angular<span class="w">              </span><span class="o">[</span>C#<span class="o">]</span><span class="w">        </span>Web/MVC/SPA
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#microservices-4.aspnet-api-__codelineno-3-15"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>with<span class="w"> </span>React.js<span class="w">                    </span>react<span class="w">                </span><span class="o">[</span>C#<span class="o">]</span><span class="w">        </span>Web/MVC/SPA
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#microservices-4.aspnet-api-__codelineno-3-16"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>with<span class="w"> </span>React.js<span class="w"> </span>and<span class="w"> </span>Redux<span class="w">          </span>reactredux<span class="w">           </span><span class="o">[</span>C#<span class="o">]</span><span class="w">        </span>Web/MVC/SPA
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#microservices-4.aspnet-api-__codelineno-3-17"></a>Blazor<span class="w"> </span>Server<span class="w"> </span>App<span class="w">                             </span>blazorserver<span class="w">         </span><span class="o">[</span>C#<span class="o">]</span><span class="w">        </span>Web/Blazor
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#microservices-4.aspnet-api-__codelineno-3-18"></a>Blazor<span class="w"> </span>WebAssembly<span class="w"> </span>App<span class="w">                        </span>blazorwasm<span class="w">           </span><span class="o">[</span>C#<span class="o">]</span><span class="w">        </span>Web/Blazor/WebAssembly/PWA
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#microservices-4.aspnet-api-__codelineno-3-19"></a>Class<span class="w"> </span>Library<span class="w">                                 </span>classlib<span class="w">             </span><span class="o">[</span>C#<span class="o">]</span>,F#,VB<span class="w">  </span>Common/Library
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#microservices-4.aspnet-api-__codelineno-3-20"></a>Console<span class="w"> </span>App<span class="w">                                   </span>console<span class="w">              </span><span class="o">[</span>C#<span class="o">]</span>,F#,VB<span class="w">  </span>Common/Console
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#microservices-4.aspnet-api-__codelineno-3-21"></a>.
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#microservices-4.aspnet-api-__codelineno-3-22"></a>.
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#microservices-4.aspnet-api-__codelineno-3-23"></a>and<span class="w"> </span>more....
</span></code></pre></div>
Use this command to actually create new project
<div class="language-sh highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#microservices-4.aspnet-api-__codelineno-4-1"></a>dotnet<span class="w"> </span>new<span class="w"> </span>webapi<span class="w"> </span>-o<span class="w"> </span>aspnetapi
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#microservices-4.aspnet-api-__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#microservices-4.aspnet-api-__codelineno-4-3"></a>or<span class="w"> </span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#microservices-4.aspnet-api-__codelineno-4-4"></a>dotnet<span class="w"> </span>new<span class="w"> </span>webapi<span class="w"> </span>-o<span class="w"> </span>aspnetapi<span class="w"> </span>--no-https<span class="w"> </span>-f<span class="w"> </span>net7.0
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#microservices-4.aspnet-api-__codelineno-4-5"></a>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#microservices-4.aspnet-api-__codelineno-4-6"></a><span class="nb">cd</span><span class="w"> </span>aspnetapi
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#microservices-4.aspnet-api-__codelineno-4-7"></a>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#microservices-4.aspnet-api-__codelineno-4-8"></a>code<span class="w"> </span>.<span class="w"> </span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#microservices-4.aspnet-api-__codelineno-4-9"></a>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#microservices-4.aspnet-api-__codelineno-4-10"></a>or<span class="w"> </span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#microservices-4.aspnet-api-__codelineno-4-11"></a>code<span class="w"> </span>-r<span class="w"> </span>../aspnetapi
</span></code></pre></div>
Additional Notes:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#microservices-4.aspnet-api-__codelineno-5-1"></a><span class="w">  </span><span class="sb">`</span>-o<span class="sb">`</span><span class="w"> </span>parameter<span class="w"> </span>creates<span class="w"> </span>a<span class="w"> </span>directory
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#microservices-4.aspnet-api-__codelineno-5-2"></a><span class="w">  </span><span class="sb">`</span>--no-https<span class="sb">`</span><span class="w"> </span>flag<span class="w"> </span>creates<span class="w"> </span>an<span class="w"> </span>app<span class="w"> </span>that<span class="w"> </span>will<span class="w"> </span>run<span class="w"> </span>without<span class="w"> </span>an<span class="w"> </span>HTTPS<span class="w"> </span>certificate
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#microservices-4.aspnet-api-__codelineno-5-3"></a><span class="w">  </span><span class="sb">`</span>-f<span class="sb">`</span><span class="w"> </span>parameter<span class="w"> </span>indicates<span class="w"> </span>creation
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#microservices-4.aspnet-api-__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#microservices-4.aspnet-api-__codelineno-5-5"></a><span class="c1"># Output</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#microservices-4.aspnet-api-__codelineno-5-6"></a>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#microservices-4.aspnet-api-__codelineno-5-7"></a>C:<span class="se">\W</span>INDOWS<span class="se">\s</span>ystem32&gt;cd<span class="w"> </span>C:<span class="se">\S</span>ource<span class="se">\R</span>epos
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#microservices-4.aspnet-api-__codelineno-5-8"></a>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#microservices-4.aspnet-api-__codelineno-5-9"></a>C:<span class="se">\S</span>ource<span class="se">\R</span>epos&gt;dotnet<span class="w"> </span>new<span class="w"> </span>webapi<span class="w"> </span>-o<span class="w"> </span>aspnetapi
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#microservices-4.aspnet-api-__codelineno-5-10"></a>The<span class="w"> </span>template<span class="w"> </span><span class="s2">&quot;ASP.NET Core Web API&quot;</span><span class="w"> </span>was<span class="w"> </span>created<span class="w"> </span>successfully.
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#microservices-4.aspnet-api-__codelineno-5-11"></a>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#microservices-4.aspnet-api-__codelineno-5-12"></a>Processing<span class="w"> </span>post-creation<span class="w"> </span>actions...
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#microservices-4.aspnet-api-__codelineno-5-13"></a>Running<span class="w"> </span><span class="s1">&#39;dotnet restore&#39;</span><span class="w"> </span>on<span class="w"> </span>C:<span class="se">\S</span>ource<span class="se">\R</span>epos<span class="se">\a</span>spnetapi<span class="se">\a</span>spnetapi.csproj...
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#microservices-4.aspnet-api-__codelineno-5-14"></a><span class="w">  </span>Determining<span class="w"> </span>projects<span class="w"> </span>to<span class="w"> </span>restore...
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#microservices-4.aspnet-api-__codelineno-5-15"></a><span class="w">  </span>Restored<span class="w"> </span>C:<span class="se">\S</span>ource<span class="se">\R</span>epos<span class="se">\a</span>spnetapi<span class="se">\a</span>spnetapi.csproj<span class="w"> </span><span class="o">(</span><span class="k">in</span><span class="w"> </span><span class="m">247</span><span class="w"> </span>ms<span class="o">)</span>.
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#microservices-4.aspnet-api-__codelineno-5-16"></a>Restore<span class="w"> </span>succeeded.
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#microservices-4.aspnet-api-__codelineno-5-17"></a>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#microservices-4.aspnet-api-__codelineno-5-18"></a>C:<span class="se">\S</span>ource<span class="se">\R</span>epos&gt;cd<span class="w"> </span>aspnetapi
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#microservices-4.aspnet-api-__codelineno-5-19"></a>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#microservices-4.aspnet-api-__codelineno-5-20"></a>C:<span class="se">\S</span>ource<span class="se">\R</span>epos<span class="se">\a</span>spnetapi&gt;code<span class="w"> </span>.
</span></code></pre></div></li>
<li>Here is the example of adding packages to .net projects.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#microservices-4.aspnet-api-__codelineno-6-1"></a>dotnet<span class="w"> </span>add<span class="w"> </span>package<span class="w"> </span>Microsoft.EntityFrameworkCore.InMemory
</span></code></pre></div></li>
<li>Run the following command to restore the project's dependencies:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#microservices-4.aspnet-api-__codelineno-7-1"></a>dotnet<span class="w"> </span>restore
</span></code></pre></div></li>
</ol>
<div class="admonition mac user">
<p class="admonition-title">Mac</p>
<p>If you're on a Mac with an Apple M1 chip, you need to install the Arm64 version of the SDK before following above commands.</p>
</div>
<p><a href="https://dotnet.microsoft.com/en-us/download/dotnet/7.0" target="_blank">Download .NET 7.0</a>.</p>
<p>Check the install typing by running following in terminal</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#microservices-4.aspnet-api-__codelineno-8-1"></a>dotnet
</span></code></pre></div>
<p>You should see an output similar to the following if the installation is successful</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#microservices-4.aspnet-api-__codelineno-9-1"></a>anjikeesari@Anjis-MacBook-Pro-2<span class="w"> </span>MyMicroservice<span class="w"> </span>%<span class="w"> </span>dotnet
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#microservices-4.aspnet-api-__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#microservices-4.aspnet-api-__codelineno-9-3"></a>Usage:<span class="w"> </span>dotnet<span class="w"> </span><span class="o">[</span>options<span class="o">]</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#microservices-4.aspnet-api-__codelineno-9-4"></a>Usage:<span class="w"> </span>dotnet<span class="w"> </span><span class="o">[</span>path-to-application<span class="o">]</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#microservices-4.aspnet-api-__codelineno-9-5"></a>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#microservices-4.aspnet-api-__codelineno-9-6"></a>Options:
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#microservices-4.aspnet-api-__codelineno-9-7"></a><span class="w">  </span>-h<span class="p">|</span>--help<span class="w">         </span>Display<span class="w"> </span>help.
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#microservices-4.aspnet-api-__codelineno-9-8"></a><span class="w">  </span>--info<span class="w">            </span>Display<span class="w"> </span>.NET<span class="w"> </span>information.
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#microservices-4.aspnet-api-__codelineno-9-9"></a><span class="w">  </span>--list-sdks<span class="w">       </span>Display<span class="w"> </span>the<span class="w"> </span>installed<span class="w"> </span>SDKs.
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#microservices-4.aspnet-api-__codelineno-9-10"></a><span class="w">  </span>--list-runtimes<span class="w">   </span>Display<span class="w"> </span>the<span class="w"> </span>installed<span class="w"> </span>runtimes.
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#microservices-4.aspnet-api-__codelineno-9-11"></a>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#microservices-4.aspnet-api-__codelineno-9-12"></a>path-to-application:
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#microservices-4.aspnet-api-__codelineno-9-13"></a><span class="w">  </span>The<span class="w"> </span>path<span class="w"> </span>to<span class="w"> </span>an<span class="w"> </span>application<span class="w"> </span>.dll<span class="w"> </span>file<span class="w"> </span>to<span class="w"> </span>execute.
</span></code></pre></div>
<h2 id="microservices-4.aspnet-api-step-4-test-the-new-net-core-web-api-project">Step-4: Test the new .NET core Web API project</h2>
<p><em>dotnet build</em></p>
<p>Run the following command to build the project:</p>
<p><code>dotnet build</code> command will look for the project or solution file in the current directory and compile the code in it. It will also restore any dependencies required by the project and create the output files in the bin directory.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#microservices-4.aspnet-api-__codelineno-10-1"></a>dotnet<span class="w"> </span>build
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#microservices-4.aspnet-api-__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#microservices-4.aspnet-api-__codelineno-10-3"></a><span class="c1"># output</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#microservices-4.aspnet-api-__codelineno-10-4"></a>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#microservices-4.aspnet-api-__codelineno-10-5"></a>Microsoft<span class="w"> </span><span class="o">(</span>R<span class="o">)</span><span class="w"> </span>Build<span class="w"> </span>Engine<span class="w"> </span>version<span class="w"> </span><span class="m">17</span>.0.1+b177f8fa7<span class="w"> </span><span class="k">for</span><span class="w"> </span>.NET
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#microservices-4.aspnet-api-__codelineno-10-6"></a>Copyright<span class="w"> </span><span class="o">(</span>C<span class="o">)</span><span class="w"> </span>Microsoft<span class="w"> </span>Corporation.<span class="w"> </span>All<span class="w"> </span>rights<span class="w"> </span>reserved.
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#microservices-4.aspnet-api-__codelineno-10-7"></a>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#microservices-4.aspnet-api-__codelineno-10-8"></a><span class="w">  </span>Determining<span class="w"> </span>projects<span class="w"> </span>to<span class="w"> </span>restore...
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#microservices-4.aspnet-api-__codelineno-10-9"></a><span class="w">  </span>All<span class="w"> </span>projects<span class="w"> </span>are<span class="w"> </span>up-to-date<span class="w"> </span><span class="k">for</span><span class="w"> </span>restore.
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#microservices-4.aspnet-api-__codelineno-10-10"></a><span class="w">  </span>AspNetApi<span class="w"> </span>-&gt;<span class="w"> </span>C:<span class="se">\S</span>ource<span class="se">\R</span>epos<span class="se">\A</span>spNetApi<span class="se">\a</span>spnet-api<span class="se">\b</span>in<span class="se">\D</span>ebug<span class="se">\n</span>et6.0<span class="se">\A</span>spNetApi.dll
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#microservices-4.aspnet-api-__codelineno-10-11"></a>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#microservices-4.aspnet-api-__codelineno-10-12"></a>Build<span class="w"> </span>succeeded.
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#microservices-4.aspnet-api-__codelineno-10-13"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>Warning<span class="o">(</span>s<span class="o">)</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#microservices-4.aspnet-api-__codelineno-10-14"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>Error<span class="o">(</span>s<span class="o">)</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#microservices-4.aspnet-api-__codelineno-10-15"></a>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#microservices-4.aspnet-api-__codelineno-10-16"></a>Time<span class="w"> </span>Elapsed<span class="w"> </span><span class="m">00</span>:00:01.51
</span></code></pre></div>
<p><em>dotnet run</em></p>
<p>Run the following command to start the development server:</p>
<p><code>dotnet run</code> command will look for the project or solution file in the current directory and compile the code in it. After compiling, it will run the application and any output will be displayed in the console.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#microservices-4.aspnet-api-__codelineno-11-1"></a>dotnet<span class="w"> </span>run
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#microservices-4.aspnet-api-__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#microservices-4.aspnet-api-__codelineno-11-3"></a><span class="c1"># output</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#microservices-4.aspnet-api-__codelineno-11-4"></a>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#microservices-4.aspnet-api-__codelineno-11-5"></a>Building...
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#microservices-4.aspnet-api-__codelineno-11-6"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">14</span><span class="o">]</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#microservices-4.aspnet-api-__codelineno-11-7"></a><span class="w">      </span>Now<span class="w"> </span>listening<span class="w"> </span>on:<span class="w"> </span>https://localhost:7136
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#microservices-4.aspnet-api-__codelineno-11-8"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">14</span><span class="o">]</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#microservices-4.aspnet-api-__codelineno-11-9"></a><span class="w">      </span>Now<span class="w"> </span>listening<span class="w"> </span>on:<span class="w"> </span>http://localhost:5136
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#microservices-4.aspnet-api-__codelineno-11-10"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">0</span><span class="o">]</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#microservices-4.aspnet-api-__codelineno-11-11"></a><span class="w">      </span>Application<span class="w"> </span>started.<span class="w"> </span>Press<span class="w"> </span>Ctrl+C<span class="w"> </span>to<span class="w"> </span>shut<span class="w"> </span>down.
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#microservices-4.aspnet-api-__codelineno-11-12"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">0</span><span class="o">]</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#microservices-4.aspnet-api-__codelineno-11-13"></a><span class="w">      </span>Hosting<span class="w"> </span>environment:<span class="w"> </span>Development
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#microservices-4.aspnet-api-__codelineno-11-14"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">0</span><span class="o">]</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#microservices-4.aspnet-api-__codelineno-11-15"></a><span class="w">      </span>Content<span class="w"> </span>root<span class="w"> </span>path:<span class="w"> </span>C:<span class="se">\S</span>ource<span class="se">\R</span>epos<span class="se">\A</span>spNetApi<span class="se">\a</span>spnet-api<span class="se">\</span>
</span></code></pre></div></p>
<p>You will notice the URL in the output, copy the URL and paste it in your favorite browser. you will get a <code>404 error.</code> don’t worry. Just type swagger at the end of the URL and press enter and you will get the following webpage.</p>
<p><a href="../microservices/images/image-1.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-1.jpg" /></a></p>
<ul>
<li>
<p><a href="https://localhost:7136">https://localhost:7136</a></p>
</li>
<li>
<p><a href="https://localhost:7136/swagger/index.html">https://localhost:7136/swagger/index.html</a> - Swagger URL</p>
</li>
<li>
<p><a href="https://localhost:7136/api/aspnetapi/v1/weatherforecast">https://localhost:7136/api/aspnetapi/v1/weatherforecast</a> - API endpoint URL</p>
</li>
</ul>
<p>If you are able to see this swagger URL in your browser then everything is created and setup as expected.</p>
<p><a href="../microservices/images/image-2.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-2.jpg" /></a></p>
<p>Use the following command to stop the application in VS Code</p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#microservices-4.aspnet-api-__codelineno-12-1"></a>ctrl<span class="w"> </span>+<span class="w"> </span>c
</span></code></pre></div>
It is time to push your basic project template source into Azure DevOps Git repo.</p>
<div class="admonition best-practice">
<p class="admonition-title">Best-practice</p>
<p>To maintain good version control and ensure a reliable development process, it is strongly recommended to commit and push source code changes to your Git repository before proceeding to the next step.</p>
</div>
<p>Use these git commands to push the source code.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#microservices-4.aspnet-api-__codelineno-13-1"></a>git<span class="w"> </span>add<span class="w"> </span>.
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#microservices-4.aspnet-api-__codelineno-13-2"></a>git<span class="w"> </span>commit<span class="w"> </span>-am<span class="w"> </span><span class="s2">&quot;My fist commit - Create Web API project&quot;</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#microservices-4.aspnet-api-__codelineno-13-3"></a>git<span class="w"> </span>push
</span></code></pre></div>
<h2 id="microservices-4.aspnet-api-step-5-add-dockerfiles-to-the-api-project">Step-5: Add Dockerfiles to the API project</h2>
<p>Dockerfiles will be added to the project, which provide instructions for building a container image of our Web API application.</p>
<p>There are multiple way to create <code>Dockerfile</code> depending on your code editor. 
Here are the step-by-step instructions for creating a <code>Dockerfile</code> in a .NET Core Web API project:</p>
<ol>
<li>First, open your .NET Core Web API project in Visual Studio code or your favorite code editor.</li>
<li>Next, create a new file in the root directory of your project and name it Dockerfile (with no file extension).</li>
<li>
<p>Open the Dockerfile and add the following code to the file:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#microservices-4.aspnet-api-__codelineno-14-1"></a><span class="c">#See https://aka.ms/containerfastmode to understand how Visual Studio uses this Dockerfile to build your images for faster debugging.</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#microservices-4.aspnet-api-__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#microservices-4.aspnet-api-__codelineno-14-3"></a><span class="k">FROM</span><span class="w"> </span><span class="s">mcr.microsoft.com/dotnet/aspnet:6.0</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">base</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#microservices-4.aspnet-api-__codelineno-14-4"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#microservices-4.aspnet-api-__codelineno-14-5"></a><span class="k">EXPOSE</span><span class="w"> </span><span class="s">80</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#microservices-4.aspnet-api-__codelineno-14-6"></a><span class="k">EXPOSE</span><span class="w"> </span><span class="s">443</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#microservices-4.aspnet-api-__codelineno-14-7"></a>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#microservices-4.aspnet-api-__codelineno-14-8"></a><span class="k">FROM</span><span class="w"> </span><span class="s">mcr.microsoft.com/dotnet/sdk:6.0</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">build</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#microservices-4.aspnet-api-__codelineno-14-9"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/src</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#microservices-4.aspnet-api-__codelineno-14-10"></a><span class="k">COPY</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;AspNetApi.csproj&quot;</span>,<span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="o">]</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#microservices-4.aspnet-api-__codelineno-14-11"></a><span class="k">RUN</span><span class="w"> </span>dotnet<span class="w"> </span>restore<span class="w"> </span><span class="s2">&quot;./AspNetApi.csproj&quot;</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#microservices-4.aspnet-api-__codelineno-14-12"></a><span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>.
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#microservices-4.aspnet-api-__codelineno-14-13"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">&quot;/src/.&quot;</span>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#microservices-4.aspnet-api-__codelineno-14-14"></a><span class="k">RUN</span><span class="w"> </span>dotnet<span class="w"> </span>build<span class="w"> </span><span class="s2">&quot;AspNetApi.csproj&quot;</span><span class="w"> </span>-c<span class="w"> </span>Release<span class="w"> </span>-o<span class="w"> </span>/app/build
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#microservices-4.aspnet-api-__codelineno-14-15"></a>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#microservices-4.aspnet-api-__codelineno-14-16"></a><span class="k">FROM</span><span class="w"> </span><span class="s">build</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">publish</span>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#microservices-4.aspnet-api-__codelineno-14-17"></a><span class="k">RUN</span><span class="w"> </span>dotnet<span class="w"> </span>publish<span class="w"> </span><span class="s2">&quot;AspNetApi.csproj&quot;</span><span class="w"> </span>-c<span class="w"> </span>Release<span class="w"> </span>-o<span class="w"> </span>/app/publish
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#microservices-4.aspnet-api-__codelineno-14-18"></a>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#microservices-4.aspnet-api-__codelineno-14-19"></a><span class="k">FROM</span><span class="w"> </span><span class="s">base</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">final</span>
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20" href="#microservices-4.aspnet-api-__codelineno-14-20"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21" href="#microservices-4.aspnet-api-__codelineno-14-21"></a><span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>publish<span class="w"> </span>/app/publish<span class="w"> </span>.
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22" href="#microservices-4.aspnet-api-__codelineno-14-22"></a><span class="k">ENTRYPOINT</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;dotnet&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;AspNetApi.dll&quot;</span><span class="p">]</span>
</span></code></pre></div>
This code defines a Docker image that is based on the aspnet:6.0 image from Microsoft's container registry. The image is divided into four stages:</p>
</li>
<li>
<p><code>base:</code> sets up the working directory and exposes port 80.</p>
</li>
<li><code>build:</code> restores the project dependencies, builds the project in Release mode, and copies the build output to the /app/build directory.</li>
<li><code>publish:</code> publishes the project in Release mode and copies the published output to the /app/publish directory.</li>
<li><code>final:</code> sets the working directory to <code>/app</code> and copies the published output from the <code>publish</code> stage to the current directory. It also specifies the entry point for the container, which is the <code>dotnet</code> command with the name of your project's DLL file.</li>
</ol>
<h2 id="microservices-4.aspnet-api-step-6-docker-build-run">Step-6: Docker Build &amp; Run</h2>
<p>We will build the Docker container locally using the Dockerfiles and ensure that the containerized application functions as expected.</p>
<p><code>docker build</code> is a command that allows you to build a Docker image from a Dockerfile. The Dockerfile is a text file that contains instructions for Docker to build the image, including the base image to use, the files to include, the commands to run, and the ports to expose.</p>
<p>To build and publish a container image for a .NET Core Web API project, you will need to have Docker installed on your machine. You can download Docker from the Docker website <a href="https://www.docker.com/get-started" target="_blank">Get Started with Docker</a></p>
<p>Once you have Docker installed, follow these steps to build and publish a container for your .NET Core Web API project:</p>
<ol>
<li>Open a terminal window and navigate to the root of the project.</li>
<li>Run the <code>docker build</code> command to build the Docker image:
<div class="language-sh highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#microservices-4.aspnet-api-__codelineno-15-1"></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>sample/aspnet-api:20230226.1<span class="w"> </span>.
</span></code></pre></div>
output
<div class="language-sh highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#microservices-4.aspnet-api-__codelineno-16-1"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Building<span class="w"> </span><span class="m">9</span>.5s<span class="w"> </span><span class="o">(</span><span class="m">19</span>/19<span class="o">)</span><span class="w"> </span><span class="nv">FINISHED</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#microservices-4.aspnet-api-__codelineno-16-2"></a><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">[</span>internal<span class="o">]</span><span class="w"> </span>load<span class="w"> </span>build<span class="w"> </span>definition<span class="w"> </span>from<span class="w"> </span>Dockerfile<span class="w">                                                                                                          </span><span class="m">0</span>.0s<span class="w"> </span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#microservices-4.aspnet-api-__codelineno-16-3"></a><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>transferring<span class="w"> </span>dockerfile:<span class="w"> </span>878B<span class="w">                                                                                                                          </span><span class="m">0</span>.0s<span class="w"> </span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#microservices-4.aspnet-api-__codelineno-16-4"></a><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">[</span>internal<span class="o">]</span><span class="w"> </span>load<span class="w"> </span>.dockerignore<span class="w">                                                                                                                             </span><span class="m">0</span>.0s<span class="w"> </span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#microservices-4.aspnet-api-__codelineno-16-5"></a><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>transferring<span class="w"> </span>context:<span class="w"> </span>374B<span class="w">  </span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#microservices-4.aspnet-api-__codelineno-16-6"></a>..<span class="w">            </span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#microservices-4.aspnet-api-__codelineno-16-7"></a>..
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#microservices-4.aspnet-api-__codelineno-16-8"></a>..
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#microservices-4.aspnet-api-__codelineno-16-9"></a>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#microservices-4.aspnet-api-__codelineno-16-10"></a><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>naming<span class="w"> </span>to<span class="w"> </span>docker.io/sample/aspnet-api:20230226.1<span class="w">                                                                                                             </span>
</span></code></pre></div>
<strong>Verify the new image</strong></li>
</ol>
<p>if you open the docker desktop you should be able to see the newly created image there.
<a href="../microservices/images/image-3.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-3.jpg" /></a>
3. Run the <code>docker run</code> command to start a container based on the image:
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#microservices-4.aspnet-api-__codelineno-17-1"></a>docker run --rm -p 8080:80 sample/aspnet-api:20230226.1
</span></code></pre></div>
output
<div class="language-sh highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#microservices-4.aspnet-api-__codelineno-18-1"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">14</span><span class="o">]</span><span class="w">  </span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#microservices-4.aspnet-api-__codelineno-18-2"></a><span class="w">      </span>Now<span class="w"> </span>listening<span class="w"> </span>on:<span class="w"> </span>http://<span class="o">[</span>::<span class="o">]</span>:80
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#microservices-4.aspnet-api-__codelineno-18-3"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">0</span><span class="o">]</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#microservices-4.aspnet-api-__codelineno-18-4"></a><span class="w">      </span>Application<span class="w"> </span>started.<span class="w"> </span>Press<span class="w"> </span>Ctrl+C<span class="w"> </span>to<span class="w"> </span>shut<span class="w"> </span>down.
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#microservices-4.aspnet-api-__codelineno-18-5"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">0</span><span class="o">]</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#microservices-4.aspnet-api-__codelineno-18-6"></a><span class="w">      </span>Hosting<span class="w"> </span>environment:<span class="w"> </span>Production
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#microservices-4.aspnet-api-__codelineno-18-7"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">0</span><span class="o">]</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#microservices-4.aspnet-api-__codelineno-18-8"></a><span class="w">      </span>Content<span class="w"> </span>root<span class="w"> </span>path:<span class="w"> </span>/app/
</span></code></pre></div>
Wait for the container to start. You should see output in the terminal indicating that the container is listening on port 80.
Open the docker desktop to see the newly created container in the docker desktop app
<a href="../microservices/images/image-4.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-4.jpg" /></a></p>
<p>Open a web browser and navigate to <a href="http://localhost:8080/api/values">http://localhost:8080/api/values</a> (or whatever URL corresponds to your Web API endpoint) to confirm that the Web API is running inside the Docker container.</p>
<p>use these links for testing when you run docker command from vs code</p>
<ul>
<li><a href="http://localhost:8080/swagger/index.html">http://localhost:8080/swagger/index.html</a></li>
<li><a href="http://localhost:8080/api/aspnetapi/v1/heartbeat/ping">http://localhost:8080/api/aspnetapi/v1/heartbeat/ping</a></li>
<li><a href="http://localhost:8080/api/aspnetapi/v1/weatherforecast">http://localhost:8080/api/aspnetapi/v1/weatherforecast</a></li>
</ul>
<p><a href="../microservices/images/image-5.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-5.jpg" /></a></p>
<div class="admonition best-practice">
<p class="admonition-title">Best-practice</p>
<p>When working with Docker containers, it is recommended to follow a consistent naming convention to ensure clarity and organization. The following pattern is suggested for naming Docker containers:</p>
</div>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#microservices-4.aspnet-api-__codelineno-19-1"></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>projectname/domainname/appname:yyyymmdd.sequence<span class="w"> </span>.
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#microservices-4.aspnet-api-__codelineno-19-2"></a>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#microservices-4.aspnet-api-__codelineno-19-3"></a>example:
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#microservices-4.aspnet-api-__codelineno-19-4"></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>project1/sample/aspnet-api:20230226<span class="w"> </span>.
</span></code></pre></div>
<p>You've successfully created a Dockerfile and built a Docker image for your .NET Core Web API project. You can now distribute the Docker image to other machines or deploy it to a cloud service like Azure or AWS.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you need to clean up containers and images locally in Docker Desktop, you can use the following commands:</p>
</div>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#microservices-4.aspnet-api-__codelineno-20-1"></a><span class="c1"># To delete all containers including its volumes use,</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#microservices-4.aspnet-api-__codelineno-20-2"></a><span class="c1">#     docker rm -vf $(docker ps -aq)</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#microservices-4.aspnet-api-__codelineno-20-3"></a>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#microservices-4.aspnet-api-__codelineno-20-4"></a><span class="c1"># To delete all the images,</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#microservices-4.aspnet-api-__codelineno-20-5"></a><span class="c1">#     docker rmi -f $(docker images -aq)</span>
</span></code></pre></div>
<!-- 
TroubleShooting 

Check the following setting

![image.png](/.attachments/image-3021b7f4-8df3-4149-a49b-a00b2e73aec7.png)

Update port number

![image.png](/.attachments/image-801c4b54-4050-402e-b546-6fa987dce9b5.png)
 -->

<h2 id="microservices-4.aspnet-api-step-7-push-docker-container-to-acr">Step-7: Push docker container to ACR</h2>
<p>Finally, we will publish the built Docker container to the Azure Container Registry (ACR), making it accessible for deployment and distribution.</p>
<p>Now we've Docker Containers ready for push to Container Registry so that we can use them in future labs.</p>
<p>To publish a Docker container image to Azure Container Registry (ACR), you will need to have the following:</p>
<ol>
<li>Create an Azure Container Registry. If you don't have one, you can create one by following the instructions in the Azure Portal or using Azure CLI. As part of the Chapter-2 we will create this azure resource, you can come back to this steps after ACR is created.</li>
<li>Log in to your Azure Container Registry using the Docker command-line interface. You can do this by running the following command:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#microservices-4.aspnet-api-__codelineno-21-1"></a><span class="c1"># azure Login</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#microservices-4.aspnet-api-__codelineno-21-2"></a>az<span class="w"> </span>login
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#microservices-4.aspnet-api-__codelineno-21-3"></a>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#microservices-4.aspnet-api-__codelineno-21-4"></a><span class="c1"># set the azure subscription</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#microservices-4.aspnet-api-__codelineno-21-5"></a>az<span class="w"> </span>account<span class="w"> </span><span class="nb">set</span><span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;anji.keesari&quot;</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#microservices-4.aspnet-api-__codelineno-21-6"></a>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#microservices-4.aspnet-api-__codelineno-21-7"></a><span class="c1"># Log in to the container registry</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#microservices-4.aspnet-api-__codelineno-21-8"></a>az<span class="w"> </span>acr<span class="w"> </span>login<span class="w"> </span>--name<span class="w"> </span>acr1dev
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#microservices-4.aspnet-api-__codelineno-21-9"></a>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#microservices-4.aspnet-api-__codelineno-21-10"></a><span class="c1"># To get the login server address for verification</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#microservices-4.aspnet-api-__codelineno-21-11"></a>az<span class="w"> </span>acr<span class="w"> </span>list<span class="w"> </span>--resource-group<span class="w"> </span>rg-acr-dev<span class="w"> </span>--query<span class="w"> </span><span class="s2">&quot;[].{acrLoginServer:loginServer}&quot;</span><span class="w"> </span>--output<span class="w"> </span>table
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#microservices-4.aspnet-api-__codelineno-21-12"></a>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#microservices-4.aspnet-api-__codelineno-21-13"></a><span class="c1"># output should look similar to this.</span>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#microservices-4.aspnet-api-__codelineno-21-14"></a>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#microservices-4.aspnet-api-__codelineno-21-15"></a><span class="c1"># AcrLoginServer    </span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#microservices-4.aspnet-api-__codelineno-21-16"></a><span class="c1"># ------------------</span>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#microservices-4.aspnet-api-__codelineno-21-17"></a><span class="c1"># acr1dev.azurecr.io</span>
</span></code></pre></div></li>
<li><code>Tag</code> your Docker container with the full name of your Azure Container Registry, including the repository name and the version tag. You can do this by running the following command:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#microservices-4.aspnet-api-__codelineno-22-1"></a>docker<span class="w"> </span>tag<span class="w"> </span>sample/aspnet-api:20230226.1<span class="w"> </span>acr1dev.azurecr.io/sample/aspnet-api:20230226.1
</span></code></pre></div>
Use this command to see a list of your current local images
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#microservices-4.aspnet-api-__codelineno-23-1"></a>docker<span class="w"> </span>images
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#microservices-4.aspnet-api-__codelineno-23-2"></a>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#microservices-4.aspnet-api-__codelineno-23-3"></a><span class="c1"># output</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#microservices-4.aspnet-api-__codelineno-23-4"></a>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#microservices-4.aspnet-api-__codelineno-23-5"></a>REPOSITORY<span class="w">                             </span>TAG<span class="w">          </span>IMAGE<span class="w"> </span>ID<span class="w">       </span>CREATED<span class="w">         </span>SIZE
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#microservices-4.aspnet-api-__codelineno-23-6"></a>acr1dev.azurecr.io/sample/aspnet-api<span class="w">   </span><span class="m">20230226</span>.1<span class="w">   </span>1bab8ba123ca<span class="w">   </span><span class="m">2</span><span class="w"> </span>hours<span class="w"> </span>ago<span class="w">     </span>213MB
</span></code></pre></div></li>
<li>Push your Docker container to your Azure Container Registry using the Docker command-line interface. You can do this by running the following command:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#microservices-4.aspnet-api-__codelineno-24-1"></a>docker<span class="w"> </span>push<span class="w"> </span>acr1dev.azurecr.io/sample/aspnet-api:20230226.1
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#microservices-4.aspnet-api-__codelineno-24-2"></a>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#microservices-4.aspnet-api-__codelineno-24-3"></a><span class="c1"># output</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#microservices-4.aspnet-api-__codelineno-24-4"></a>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#microservices-4.aspnet-api-__codelineno-24-5"></a>The<span class="w"> </span>push<span class="w"> </span>refers<span class="w"> </span>to<span class="w"> </span>repository<span class="w"> </span><span class="o">[</span>acr1dev.azurecr.io/sample/aspnet-api<span class="o">]</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#microservices-4.aspnet-api-__codelineno-24-6"></a>a592c2e20b23:<span class="w"> </span>Pushed
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#microservices-4.aspnet-api-__codelineno-24-7"></a>5f70bf18a086:<span class="w"> </span>Layer<span class="w"> </span>already<span class="w"> </span>exists
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#microservices-4.aspnet-api-__codelineno-24-8"></a>d57ad0aaee3b:<span class="w"> </span>Layer<span class="w"> </span>already<span class="w"> </span>exists
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#microservices-4.aspnet-api-__codelineno-24-9"></a>aff5d88d936a:<span class="w"> </span>Layer<span class="w"> </span>already<span class="w"> </span>exists
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#microservices-4.aspnet-api-__codelineno-24-10"></a>b3b2bd456a19:<span class="w"> </span>Layer<span class="w"> </span>already<span class="w"> </span>exists
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#microservices-4.aspnet-api-__codelineno-24-11"></a>2540ef4bc011:<span class="w"> </span>Layer<span class="w"> </span>already<span class="w"> </span>exists
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#microservices-4.aspnet-api-__codelineno-24-12"></a>94100d1041b6:<span class="w"> </span>Layer<span class="w"> </span>already<span class="w"> </span>exists
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#microservices-4.aspnet-api-__codelineno-24-13"></a>bd2fe8b74db6:<span class="w"> </span>Layer<span class="w"> </span>already<span class="w"> </span>exists
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#microservices-4.aspnet-api-__codelineno-24-14"></a><span class="m">20230226</span>.1:<span class="w"> </span>digest:<span class="w"> </span>sha256:026ec79d24fca0f30bcd90c7fa17e82a2347cf7bc5ac5d762a630277086ed0d1<span class="w"> </span>size:<span class="w"> </span><span class="m">1995</span>
</span></code></pre></div></li>
<li>Wait for the push to complete. Depending on the size of your Docker container and the speed of your internet connection, this may take a few minutes.</li>
<li>Verify the newly pushed image to ACR.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#microservices-4.aspnet-api-__codelineno-25-1"></a><span class="c1"># List images in registry</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#microservices-4.aspnet-api-__codelineno-25-2"></a>az<span class="w"> </span>acr<span class="w"> </span>repository<span class="w"> </span>list<span class="w"> </span>--name<span class="w"> </span>acr1dev<span class="w"> </span>--output<span class="w"> </span>table
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#microservices-4.aspnet-api-__codelineno-25-3"></a>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#microservices-4.aspnet-api-__codelineno-25-4"></a><span class="c1"># output</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#microservices-4.aspnet-api-__codelineno-25-5"></a>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#microservices-4.aspnet-api-__codelineno-25-6"></a>Result
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#microservices-4.aspnet-api-__codelineno-25-7"></a>-------------------------------
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#microservices-4.aspnet-api-__codelineno-25-8"></a>mcr.microsoft.com/dotnet/aspnet
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#microservices-4.aspnet-api-__codelineno-25-9"></a>mcr.microsoft.com/dotnet/sdk
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#microservices-4.aspnet-api-__codelineno-25-10"></a>sample/aspnet-api
</span></code></pre></div></li>
<li>Show the new tags of a image in the acr
<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#microservices-4.aspnet-api-__codelineno-26-1"></a>az<span class="w"> </span>acr<span class="w"> </span>repository<span class="w"> </span>show-tags<span class="w"> </span>--name<span class="w"> </span>acr1dev<span class="w"> </span>--repository<span class="w"> </span>sample/aspnet-api<span class="w"> </span>--output<span class="w"> </span>table
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#microservices-4.aspnet-api-__codelineno-26-2"></a>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#microservices-4.aspnet-api-__codelineno-26-3"></a><span class="c1"># output</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#microservices-4.aspnet-api-__codelineno-26-4"></a>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#microservices-4.aspnet-api-__codelineno-26-5"></a>Result
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#microservices-4.aspnet-api-__codelineno-26-6"></a>----------
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#microservices-4.aspnet-api-__codelineno-26-7"></a><span class="m">20230220</span>.1
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#microservices-4.aspnet-api-__codelineno-26-8"></a><span class="m">20230226</span>.1
</span></code></pre></div></li>
</ol>
<p>You've successfully pushed your Docker container to Azure Container Registry. You can now use the Azure Portal or Azure CLI to manage your container and deploy them to Azure services like Azure Kubernetes Service (AKS).</p>
<h2 id="microservices-4.aspnet-api-step-8-pull-docker-container-from-acr">Step-8: Pull docker container from ACR</h2>
<p>Pull docker container from ACR is something may be helpful during container troubleshooting.</p>
<p>To pull a Docker container from Azure Container Registry (ACR), you need to perform the following steps:</p>
<ol>
<li>Log in to your Azure Container Registry using the Docker command-line interface. You can do this by running the following command:
<div class="language-sh highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#microservices-4.aspnet-api-__codelineno-27-1"></a><span class="c1"># Log in to the container registry</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#microservices-4.aspnet-api-__codelineno-27-2"></a>az<span class="w"> </span>acr<span class="w"> </span>login<span class="w"> </span>--name<span class="w"> </span>acr1dev
</span></code></pre></div></li>
<li>Pull your Docker container from your Azure Container Registry using the Docker command-line interface. You can do this by running the following command:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#microservices-4.aspnet-api-__codelineno-28-1"></a>docker<span class="w"> </span>pull<span class="w"> </span>acr1dev.azurecr.io/sample/aspnet-api:20230226.1
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#microservices-4.aspnet-api-__codelineno-28-2"></a>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#microservices-4.aspnet-api-__codelineno-28-3"></a><span class="c1"># output</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#microservices-4.aspnet-api-__codelineno-28-4"></a>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#microservices-4.aspnet-api-__codelineno-28-5"></a><span class="m">20230226</span>.1:<span class="w"> </span>Pulling<span class="w"> </span>from<span class="w"> </span>sample/aspnet-api
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#microservices-4.aspnet-api-__codelineno-28-6"></a>01b5b2efb836:<span class="w"> </span>Already<span class="w"> </span>exists
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#microservices-4.aspnet-api-__codelineno-28-7"></a>c4c81489d24d:<span class="w"> </span>Already<span class="w"> </span>exists
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#microservices-4.aspnet-api-__codelineno-28-8"></a>95b82a084bc9:<span class="w"> </span>Already<span class="w"> </span>exists
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#microservices-4.aspnet-api-__codelineno-28-9"></a>bb369c4b0f26:<span class="w"> </span>Already<span class="w"> </span>exists<span class="w"> </span>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#microservices-4.aspnet-api-__codelineno-28-10"></a>c888ac593815:<span class="w"> </span>Already<span class="w"> </span>exists
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#microservices-4.aspnet-api-__codelineno-28-11"></a>14ce87409b2e:<span class="w"> </span>Already<span class="w"> </span>exists
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#microservices-4.aspnet-api-__codelineno-28-12"></a>4f4fb700ef54:<span class="w"> </span>Already<span class="w"> </span>exists
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#microservices-4.aspnet-api-__codelineno-28-13"></a>d15d1be868b7:<span class="w"> </span>Already<span class="w"> </span>exists
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14" href="#microservices-4.aspnet-api-__codelineno-28-14"></a>Digest:<span class="w"> </span>sha256:026ec79d24fca0f30bcd90c7fa17e82a2347cf7bc5ac5d762a630277086ed0d1
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15" href="#microservices-4.aspnet-api-__codelineno-28-15"></a>Status:<span class="w"> </span>Downloaded<span class="w"> </span>newer<span class="w"> </span>image<span class="w"> </span><span class="k">for</span><span class="w"> </span>acr1dev.azurecr.io/sample/aspnet-api:20230226.1
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16" href="#microservices-4.aspnet-api-__codelineno-28-16"></a>acr1dev.azurecr.io/sample/aspnet-api:20230226.1
</span></code></pre></div></li>
<li>Wait for the pull to complete. Depending on the size of your Docker container and the speed of your internet connection, this may take a few minutes.
<a href="../microservices/images/image-6.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-6.jpg" /></a></li>
<li>Verify the recently pulled container from ACR to make sure it running as expected
<div class="language-bash highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#microservices-4.aspnet-api-__codelineno-29-1"></a>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-p<span class="w"> </span><span class="m">8080</span>:80<span class="w"> </span>acr1dev.azurecr.io/sample/aspnet-api:20230226.1
</span></code></pre></div>
Test the container running following URL</li>
</ol>
<p><a href="../microservices/images/image-7.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-7.jpg" /></a></p>
<p><a href="http://localhost:8080/swagger/index.html">http://localhost:8080/swagger/index.html</a></p>
<p>You've successfully pulled your Docker container from Azure Container Registry. You can now use the Docker command-line interface to manage your container and run them locally or deploy them to other environments.</p>
<h2 id="microservices-4.aspnet-api-reference">Reference</h2>
<ul>
<li><a href="https://learn.microsoft.com/en-us/aspnet/core/tutorials/first-web-api?view=aspnetcore-7.0&amp;tabs=visual-studio-code" target="_blank">Microsoft MSDN - Tutorial: Create a web API with ASP.NET Core</a></li>
<li><a href="https://learn.microsoft.com/en-us/training/modules/microservices-aspnet-core/?WT.mc_id=dotnet-35129-website" target="_blank">Microsoft MSDN - Create and deploy a cloud-native ASP.NET Core microservice</a></li>
<li><a href="https://dotnet.microsoft.com/en-us/learn/aspnet/microservice-tutorial/intro" target="_blank">Microsoft MSDN - .NET Tutorial - Your First Microservice</a></li>
<li><a href="https://code.visualstudio.com/docs/containers/quickstart-aspnet-core" target="_blank">Visual Studio Core - ASP.NET Core in a container</a></li>
<li><a href="https://code.visualstudio.com/docs/containers/overview" target="_blank">Visual Studio Core - Docker in Visual Studio Code</a></li>
<li><a href="https://code.visualstudio.com/docs/containers/quickstart-node" target="_blank">Visual Studio Core - Node.js in a container</a></li>
<li><a href="https://github.com/dotnet/dotnet-docker/blob/main/samples/aspnetapp/README.md" target="_blank">github - ASP.NET Core Docker Sample</a></li>
<li><a href="https://docs.docker.com/language/dotnet/containerize/" target="_blank">Containerize a .NET application</a></li>
</ul></section><section class="print-page" id="microservices-5.node-api" heading-number="3.5"><h1 id="microservices-5.node-api-chapter-5-create-your-second-microservice-with-nodejs">Chapter-5: Create Your Second Microservice with Node.js</h1>
<h2 id="microservices-5.node-api-introduction">Introduction</h2>
<p>Welcome to the second lab in our Microservices chapter. In this session, I will guide you through the creation of a simple RESTful service using the Node.js <code>npx express-generator</code> project template.</p>
<p>This lab aims to illustrate the process of building a RESTful service and generating a Docker container using a Dockerfile. By following this example, you will gain a solid understanding of the fundamentals involved in creating RESTful APIs with Node.js.</p>
<h2 id="microservices-5.node-api-technical-scenario">Technical Scenario</h2>
<p>As a <code>Backend (BE)</code> developer, you have been tasked with creating a RESTful service using Node JS, which is one of the services on our microservices list. This lab will serve as your introduction to the Microservices Architecture, starting with the basics of setting up a repository, creating a small API project, and ultimately containerizing the microservice you build. The containerized microservice will then be pushed to the Azure Container Registry (ACR).</p>
<p>The primary objective of this lab is to prepare an application for deployment on Kubernetes. The microservices you create in this lab will be utilized in subsequent labs, such as the creation of DevOps pipelines or the deployment to Azure Kubernetes Services (AKS). By completing this lab, you will gain a foundational understanding of how microservices can be developed, containerized, and integrated into a Kubernetes environment.</p>
<h2 id="microservices-5.node-api-objective">Objective</h2>
<p>In this exercise, our objective is to accomplish and learn the following tasks:</p>
<ul>
<li><strong>Step-1:</strong> Setup repository in Azure DevOps.</li>
<li><strong>Step-2:</strong> Create a new Node.js API project.</li>
<li><strong>Step-3:</strong> Test Node.js API project.</li>
<li><strong>Step-4:</strong> Add Dockerfiles to the project.</li>
<li><strong>Step-5:</strong> Docker build locally.</li>
<li><strong>Step-6:</strong> Docker run locally.</li>
<li><strong>Step-7:</strong> Publish the Docker container to ACR.</li>
</ul>
<h2 id="microservices-5.node-api-prerequisites">Prerequisites</h2>
<p>Before starting this lab, ensure you have the following prerequisites in place:</p>
<ul>
<li>Node.js and npm:  - <a href="https://nodejs.org/en/download/" target="_blank">Node.js Downloads</a>.</li>
<li>Docker and the VS Code Docker extension :  - <a href="https://docs.docker.com/get-docker/" target="_blank">Docker Downloads</a>.</li>
<li>Git Client tool:  - <a href="https://git-scm.com/downloads" target="_blank">Git Downloads</a>.</li>
<li>A project in Azure DevOps and Git Repository: Initialize a Git repository for your Node.js application.</li>
<li>Azure Container Registry (ACR)</li>
</ul>
<h2 id="microservices-5.node-api-architecture-diagram">Architecture Diagram</h2>
<p>The following diagram shows the high level steps to create the Rest API using Node JS.</p>
<p><a href="../microservices/images/image-10.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-10.png" /></a></p>
<h2 id="microservices-5.node-api-step-1-setup-repository-in-azure-devops">Step-1: Setup repository in Azure DevOps.</h2>
<p>For this project, you can either leverage an existing Git repository created in our first chapter or initiate a new one.</p>
<p>To clone an existing repository, execute the following command:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#microservices-5.node-api-__codelineno-0-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://keesari.visualstudio.com/Microservices/_git/microservices
</span></code></pre></div>
<h2 id="microservices-5.node-api-step-2-create-a-new-node-js-api-project">Step-2: Create a new <code>Node JS</code> API project</h2>
<p>In this step, we will set up a new Node.js API project using a basic Express application as our example. To expedite the process, we'll utilize Express's scaffolding tool to generate the necessary directory structure and essential files.</p>
<p>Open your terminal and execute the following commands:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#microservices-5.node-api-__codelineno-1-1"></a>$<span class="w"> </span>npx<span class="w"> </span>express-generator<span class="w"> </span>--no-view<span class="w"> </span>src
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#microservices-5.node-api-__codelineno-1-2"></a>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>src
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#microservices-5.node-api-__codelineno-1-3"></a>$<span class="w"> </span>npm<span class="w"> </span>install
</span></code></pre></div>
<p>npx express-generator:</p>
<p>The npx express-generator command initializes the project, creating a structure that includes directories like 'bin' and 'routes'.</p>
<p><a href="../microservices/images/image-3.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-3.png" /></a></p>
<p>npm install:</p>
<p>Ensure you run npm install to set up and configure all required Node.js modules.</p>
<p>This step ensures that your project is equipped with the necessary dependencies, allowing seamless integration with Docker and efficient containerization of your Node.js application.</p>
<p><a href="../microservices/images/image-4.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-4.png" /></a></p>
<p>folder structure</p>
<p>you've established the foundation for your Node.js API project, complete with a standardized directory structure and essential files.</p>
<p><a href="../microservices/images/image-5.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-5.png" /></a></p>
<p>This should have created a number of files in your directory, including bin and routes directories. Make sure to run npm install so that npm can get all of your Node.js modules set up and ready to use.</p>
<h2 id="microservices-5.node-api-step-3-test-the-node-js-api-project">Step-3: Test the Node JS API project</h2>
<p>Now, let's verify that our Node.js API project is functioning correctly. We'll initiate the application for the first time, utilizing the default routes defined in <code>app.js</code>.</p>
<p>Ensure you are in the project directory, and in your terminal, execute the following command to start the application:
<div class="language-sh highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#microservices-5.node-api-__codelineno-2-1"></a>npm<span class="w"> </span>start
</span></code></pre></div></p>
<p>This command launches the Node.js application, making it accessible locally.</p>
<p>Open your web browser and navigate to <a href="http://localhost:3000" target="_blank">http://localhost:3000</a></p>
<p><a href="../microservices/images/image-2.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-2.png" /></a></p>
<p>You confirm that your Node.js API project is up and running on your local environment. This preliminary test ensures the initial functionality of your application before proceeding with additional configurations or containerization.</p>
<h2 id="microservices-5.node-api-step-4-add-dockerfiles-to-the-mvc-project">Step-4: Add Dockerfiles to the MVC project</h2>
<p>To seamlessly containerize our Node.js API project, let's create a Dockerfile in the root directory of your project and incorporate the following code. The Dockerfile provides instructions for building a container image of our Node.js API.</p>
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#microservices-5.node-api-__codelineno-3-1"></a><span class="c"># Use the official Node.js image from Docker Hub with a specific version</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#microservices-5.node-api-__codelineno-3-2"></a><span class="k">FROM</span><span class="w"> </span><span class="s">node:18.16.0-alpine3.17</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#microservices-5.node-api-__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#microservices-5.node-api-__codelineno-3-4"></a><span class="c"># Create a directory for the application in the container</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#microservices-5.node-api-__codelineno-3-5"></a><span class="k">RUN</span><span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/opt/app
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#microservices-5.node-api-__codelineno-3-6"></a>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#microservices-5.node-api-__codelineno-3-7"></a><span class="c"># Set the working directory inside the container to /opt/app</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#microservices-5.node-api-__codelineno-3-8"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/opt/app</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#microservices-5.node-api-__codelineno-3-9"></a>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#microservices-5.node-api-__codelineno-3-10"></a><span class="c"># Copy package.json and package-lock.json to the container&#39;s working directory</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#microservices-5.node-api-__codelineno-3-11"></a><span class="k">COPY</span><span class="w"> </span>src/package.json<span class="w"> </span>src/package-lock.json<span class="w"> </span>.
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#microservices-5.node-api-__codelineno-3-12"></a>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#microservices-5.node-api-__codelineno-3-13"></a><span class="c"># Install Node.js dependencies based on the package.json and package-lock.json</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#microservices-5.node-api-__codelineno-3-14"></a><span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>install
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#microservices-5.node-api-__codelineno-3-15"></a>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#microservices-5.node-api-__codelineno-3-16"></a><span class="c"># Copy the entire contents of the &#39;src&#39; directory to the container&#39;s working directory</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#microservices-5.node-api-__codelineno-3-17"></a><span class="k">COPY</span><span class="w"> </span>src/<span class="w"> </span>.
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#microservices-5.node-api-__codelineno-3-18"></a>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#microservices-5.node-api-__codelineno-3-19"></a><span class="c"># Expose port 3000 to allow external access to the application</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#microservices-5.node-api-__codelineno-3-20"></a><span class="k">EXPOSE</span><span class="w"> </span><span class="s">3000</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#microservices-5.node-api-__codelineno-3-21"></a>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#microservices-5.node-api-__codelineno-3-22"></a><span class="c"># Specify the command to run when the container starts (start the application)</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#microservices-5.node-api-__codelineno-3-23"></a><span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;npm&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;start&quot;</span><span class="p">]</span>
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Read inline comments of the Dockerfile for understanding the Dockerfile instructions</p>
</div>
<p><a href="../microservices/images/image-6.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-6.png" /></a></p>
<h2 id="microservices-5.node-api-step-5-docker-build-locally">Step-5: Docker build locally</h2>
<p>We will build the Docker container locally using the Dockerfiles and ensure that the containerized application functions as expected.</p>
<p>The <code>docker build</code> command is used to build Docker images from a Dockerfile.  </p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#microservices-5.node-api-__codelineno-4-1"></a>docker build -t sample/node-api:20240101.1 .
</span></code></pre></div>
<p>output</p>
<p><a href="../microservices/images/image-7.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-7.png" /></a></p>
<p>When you run the <code>docker build</code> command, Docker looks for a Dockerfile in the specified directory (PATH) and reads the instructions in the file to build a new image. </p>
<p>The Dockerfile contains a series of instructions that define how to build the image, such as copying files, running commands, and setting environment variables. </p>
<h2 id="microservices-5.node-api-step-6-docker-run-locally">Step-6: Docker run locally</h2>
<p>Run the Docker container locally to verify that the application functions correctly within a containerized environment. This step ensures that the containerized application operates as expected on your local machine.</p>
<p>Run the <code>docker run</code> command to start a container based on the image:</p>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#microservices-5.node-api-__codelineno-5-1"></a>docker run --rm -p 3000:3000 sample/node-api:20240101.1 .
</span></code></pre></div>
output</p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#microservices-5.node-api-__codelineno-6-1"></a>Compiled<span class="w"> </span>successfully!
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#microservices-5.node-api-__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#microservices-5.node-api-__codelineno-6-3"></a>You<span class="w"> </span>can<span class="w"> </span>now<span class="w"> </span>view<span class="w"> </span>node-api<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>browser.
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#microservices-5.node-api-__codelineno-6-4"></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#microservices-5.node-api-__codelineno-6-5"></a><span class="w">  </span>Local:<span class="w">            </span>http://localhost:3000
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#microservices-5.node-api-__codelineno-6-6"></a><span class="w">  </span>On<span class="w"> </span>Your<span class="w"> </span>Network:<span class="w">  </span>http://172.17.0.2:3000
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#microservices-5.node-api-__codelineno-6-7"></a>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#microservices-5.node-api-__codelineno-6-8"></a>Note<span class="w"> </span>that<span class="w"> </span>the<span class="w"> </span>development<span class="w"> </span>build<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>optimized.
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#microservices-5.node-api-__codelineno-6-9"></a>To<span class="w"> </span>create<span class="w"> </span>a<span class="w"> </span>production<span class="w"> </span>build,<span class="w"> </span>use<span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>build.
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#microservices-5.node-api-__codelineno-6-10"></a>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#microservices-5.node-api-__codelineno-6-11"></a>webpack<span class="w"> </span>compiled<span class="w"> </span>successfully
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#microservices-5.node-api-__codelineno-6-12"></a>Compiling...
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#microservices-5.node-api-__codelineno-6-13"></a>Compiled<span class="w"> </span>successfully!
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#microservices-5.node-api-__codelineno-6-14"></a>webpack<span class="w"> </span>compiled<span class="w"> </span>successfully
</span></code></pre></div>
if you open the docker desktop you will notice the new image &amp; container started running.</p>
<p><strong>Image</strong></p>
<p><img alt="image.jpg" src="../microservices/images/image-22.jpg" /></p>
<p><strong>Container</strong></p>
<p><img alt="image.jpg" src="../microservices/images/image-23.jpg" /></p>
<p>This will start the Node.js application in the Docker container and map the container's port 3000 to your local machine's port 3000. </p>
<p>Your Node.js application is now running inside a Docker container.</p>
<p>Open your favorite browser and enter the following URL to see the running application in port 3000</p>
<p><a href="http://localhost:3000/">http://localhost:3000/</a></p>
<p><a href="../microservices/images/image-2.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-2.png" /></a></p>
<p>You now have a basic Node.js application up and running. From here, you can continue building out your application by adding more and more code as per your requirements.</p>
<h2 id="microservices-5.node-api-step-7-push-docker-container-to-acr">Step-7: Push docker container to ACR</h2>
<p>Now that we have Docker containers ready locally, it's time to push them to the Container Registry for future deployment on Azure Kubernetes Services (AKS). This step is crucial for preparing the container for deployment in a cloud environment.</p>
<p>To publish a Docker container to Azure Container Registry (ACR), you will need to have the following:</p>
<p>Create an Azure Container Registry. If you don't have one, you can create one by following the instructions in the Azure Portal or using Azure CLI.</p>
<p>Log in to your Azure Container Registry using the Docker command-line interface. You can do this by running the following command:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#microservices-5.node-api-__codelineno-7-1"></a><span class="c1"># azure Login</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#microservices-5.node-api-__codelineno-7-2"></a>az<span class="w"> </span>login
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#microservices-5.node-api-__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#microservices-5.node-api-__codelineno-7-4"></a><span class="c1"># set the azure subscription</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#microservices-5.node-api-__codelineno-7-5"></a>az<span class="w"> </span>account<span class="w"> </span><span class="nb">set</span><span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;anji.keesari&quot;</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#microservices-5.node-api-__codelineno-7-6"></a>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#microservices-5.node-api-__codelineno-7-7"></a><span class="c1"># Log in to the container registry</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#microservices-5.node-api-__codelineno-7-8"></a>az<span class="w"> </span>acr<span class="w"> </span>login<span class="w"> </span>--name<span class="w"> </span>acr1dev
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#microservices-5.node-api-__codelineno-7-9"></a><span class="c1"># Login Succeeded</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#microservices-5.node-api-__codelineno-7-10"></a><span class="c1"># To get the login server address for verification</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#microservices-5.node-api-__codelineno-7-11"></a>az<span class="w"> </span>acr<span class="w"> </span>list<span class="w"> </span>--resource-group<span class="w"> </span>rg-acr-dev<span class="w"> </span>--query<span class="w"> </span><span class="s2">&quot;[].{acrLoginServer:loginServer}&quot;</span><span class="w"> </span>--output<span class="w"> </span>table
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#microservices-5.node-api-__codelineno-7-12"></a>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#microservices-5.node-api-__codelineno-7-13"></a><span class="c1"># output should look similar to this.</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#microservices-5.node-api-__codelineno-7-14"></a>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#microservices-5.node-api-__codelineno-7-15"></a><span class="c1"># AcrLoginServer    </span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#microservices-5.node-api-__codelineno-7-16"></a><span class="c1"># ------------------</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#microservices-5.node-api-__codelineno-7-17"></a><span class="c1"># acr1dev.azurecr.io</span>
</span></code></pre></div>
<p>list all the Docker images that are available on the local system</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#microservices-5.node-api-__codelineno-8-1"></a>docker<span class="w"> </span>images
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#microservices-5.node-api-__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#microservices-5.node-api-__codelineno-8-3"></a><span class="c1"># output</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#microservices-5.node-api-__codelineno-8-4"></a>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#microservices-5.node-api-__codelineno-8-5"></a>REPOSITORY<span class="w">                                                </span>TAG<span class="w">                                                                          </span>IMAGE<span class="w"> </span>ID<span class="w">       </span>CREATED<span class="w">         </span>SIZE
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#microservices-5.node-api-__codelineno-8-6"></a>sample/aspnet-app<span class="w">                                         </span><span class="m">20230312</span>.1<span class="w">                                                                   </span>587f347206bc<span class="w">   </span><span class="m">8</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">   </span>216MB
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#microservices-5.node-api-__codelineno-8-7"></a>.
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#microservices-5.node-api-__codelineno-8-8"></a>.
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#microservices-5.node-api-__codelineno-8-9"></a>.
</span></code></pre></div>
<p><code>Tag</code> your Docker container image with the full name of your Azure Container Registry, including the repository name and the version tag. You can do this by running the following command:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#microservices-5.node-api-__codelineno-9-1"></a>docker<span class="w"> </span>tag<span class="w"> </span>sample/node-api:20240101.1<span class="w"> </span>acr1dev.azurecr.io/sample/node-api:20240101.1
</span></code></pre></div>
<p>Push your Docker container image to your Azure Container Registry using the Docker command-line interface. You can do this by running the following command:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#microservices-5.node-api-__codelineno-10-1"></a>docker<span class="w"> </span>push<span class="w"> </span>acr1dev.azurecr.io/sample/node-api:20240101.1
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#microservices-5.node-api-__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#microservices-5.node-api-__codelineno-10-3"></a><span class="c1"># Output</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#microservices-5.node-api-__codelineno-10-4"></a>The<span class="w"> </span>push<span class="w"> </span>refers<span class="w"> </span>to<span class="w"> </span>repository<span class="w"> </span><span class="o">[</span>acr1dev.azurecr.io/sample/node-api<span class="o">]</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#microservices-5.node-api-__codelineno-10-5"></a>649a035a1734:<span class="w"> </span>Pushed
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#microservices-5.node-api-__codelineno-10-6"></a>4061bd2dd536:<span class="w"> </span>Pushed
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#microservices-5.node-api-__codelineno-10-7"></a>c0257b3030b0:<span class="w"> </span>Pushed
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#microservices-5.node-api-__codelineno-10-8"></a>912a3b0fc587:<span class="w"> </span>Pushed
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#microservices-5.node-api-__codelineno-10-9"></a>a36186d93e25:<span class="w"> </span>Pushed
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#microservices-5.node-api-__codelineno-10-10"></a>a3d997b065bc:<span class="w"> </span>Pushed
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#microservices-5.node-api-__codelineno-10-11"></a>65d358b7de11:<span class="w"> </span>Pushed
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#microservices-5.node-api-__codelineno-10-12"></a>f97384e8ccbc:<span class="w"> </span>Pushed
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#microservices-5.node-api-__codelineno-10-13"></a>d56e5e720148:<span class="w"> </span>Pushed
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#microservices-5.node-api-__codelineno-10-14"></a>beee9f30bc1f:<span class="w"> </span>Pushed
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#microservices-5.node-api-__codelineno-10-15"></a><span class="m">20240101</span>.1:<span class="w"> </span>digest:<span class="w"> </span>sha256:73f0669d18c6cae79beb81edc8c523191710f9ec4781d590884b46326f9ad6f9<span class="w"> </span>size:<span class="w"> </span><span class="m">2419</span>
</span></code></pre></div>
<p>Wait for the push to complete. Depending on the size of your Docker container image and the speed of your internet connection, this may take a few minutes.</p>
<p>Verify the newly pushed image to ACR.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#microservices-5.node-api-__codelineno-11-1"></a>az<span class="w"> </span>acr<span class="w"> </span>repository<span class="w"> </span>list<span class="w"> </span>--name<span class="w"> </span>acr1dev<span class="w"> </span>--output<span class="w"> </span>table
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#microservices-5.node-api-__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#microservices-5.node-api-__codelineno-11-3"></a><span class="c1"># Output</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#microservices-5.node-api-__codelineno-11-4"></a>Result
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#microservices-5.node-api-__codelineno-11-5"></a>-------------------------------
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#microservices-5.node-api-__codelineno-11-6"></a>mcr.microsoft.com/dotnet/aspnet
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#microservices-5.node-api-__codelineno-11-7"></a>mcr.microsoft.com/dotnet/sdk
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#microservices-5.node-api-__codelineno-11-8"></a>sample/aspnet-api
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#microservices-5.node-api-__codelineno-11-9"></a>sample/aspnet-app
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#microservices-5.node-api-__codelineno-11-10"></a>sample/node-api
</span></code></pre></div>
<p>Show the new tags of a image in the acr</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#microservices-5.node-api-__codelineno-12-1"></a>az<span class="w"> </span>acr<span class="w"> </span>repository<span class="w"> </span>show-tags<span class="w"> </span>--name<span class="w"> </span>acr1dev<span class="w"> </span>--repository<span class="w"> </span>sample/node-api<span class="w"> </span>--output<span class="w"> </span>table
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#microservices-5.node-api-__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#microservices-5.node-api-__codelineno-12-3"></a><span class="c1"># output</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#microservices-5.node-api-__codelineno-12-4"></a>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#microservices-5.node-api-__codelineno-12-5"></a>Result
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#microservices-5.node-api-__codelineno-12-6"></a>----------
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#microservices-5.node-api-__codelineno-12-7"></a><span class="m">20240101</span>.1
</span></code></pre></div>
<p>You've successfully pushed your Docker container image to Azure Container Registry. You can now use the Azure Portal or Azure CLI to manage your container images and deploy them to Azure services like Azure Kubernetes Service (AKS).</p>
<h2 id="microservices-5.node-api-conclusion">Conclusion</h2>
<p>So, we've covered Docker and learned how to run a basic Node.js application inside a container. Now, you should feel confident and ready to create your own Dockerfile, tapping into the cool features that Docker brings to your development experience.</p>
<h2 id="microservices-5.node-api-reference">Reference</h2>
<ul>
<li><a href="https://docs.docker.com/language/nodejs/containerize/" target="_blank">Containerize a Node.js application</a></li>
<li><a href="https://semaphoreci.com/community/tutorials/dockerizing-a-node-js-web-application#h-next-steps" target="_blank">Dockerizing a Node.js Web Application</a></li>
</ul></section><section class="print-page" id="microservices-6.aspnet-app" heading-number="3.6"><h1 id="microservices-6.aspnet-app-chapter-6-create-your-first-website-using-net-core-mvc-application">Chapter-6: Create Your First Website using .NET Core MVC Application</h1>
<h2 id="microservices-6.aspnet-app-introduction">Introduction</h2>
<p>In our previous labs, we have explored the creation of Microservices to demonstrate the Microservices architecture pattern. In this lab and the next, we will shift our focus to the MicroFrontend architecture pattern by creating a couple of MicroFrontend UI applications.</p>
<h2 id="microservices-6.aspnet-app-technical-scenario">Technical Scenario</h2>
<p>As a <strong>Frontend (FE)</strong> developer, your task is to develop a website or UI application using ASP.NET Core MVC technology. This application represents one of the small Website (UI) components in our MicroFrontend applications list.</p>
<p>This lab will guide you through the process of building an ASP.NET Core MVC application. We will begin by creating a new Git repository or utilizing an existing one. Next, we will generate an MVC project template and proceed to containerize the UI application. Finally, we will push the containerized UI application to the Azure Container Registry (ACR) in preparation for deployment to Azure Kubernetes Services (AKS).</p>
<p>The objective is to prepare a UI application for deployment on Kubernetes. The UI applications developed in this lab will be utilized in subsequent labs, such as the creation of DevOps pipelines or the deployment to Azure Kubernetes Services.</p>
<h2 id="microservices-6.aspnet-app-objective">Objective</h2>
<p>In this exercise, our objective is to accomplish and learn the following tasks:</p>
<ul>
<li><strong>Step-1:</strong> Create a new ASP.NET Core Web App (MVC project)</li>
<li><strong>Step-2:</strong> Test ASP.NET MVC project</li>
<li><strong>Step-3:</strong> Update home page contents [optional]</li>
<li><strong>Step-4:</strong> Add Dockerfiles to MVC project</li>
<li><strong>Step-5:</strong> Docker Build locally</li>
<li><strong>Step-6:</strong> Docker Run locally</li>
<li><strong>Step-7:</strong> Publish docker container to ACR</li>
</ul>
<h2 id="microservices-6.aspnet-app-prerequisites">Prerequisites</h2>
<p>Before starting this lab, make sure you have the following prerequisites in place:</p>
<ul>
<li>Clone existing Microservices repo</li>
<li>Download and install software for .NET development </li>
<li>Docker desktop</li>
<li>VS Code Docker extension</li>
<li>Azure Container Registry (ACR)</li>
</ul>
<h2 id="microservices-6.aspnet-app-architecture-diagram">Architecture Diagram</h2>
<p>The following diagram shows the high level steps to create the website using ASP.NET Core MVC.</p>
<p><a href="../microservices/images/image-9.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-9.png" /></a></p>
<h2 id="microservices-6.aspnet-app-step-1-create-a-new-aspnet-core-web-app-mvc-project">Step-1: Create a new ASP.NET Core Web App (MVC project)</h2>
<p>Create a new ASP.NET Core Web App using the MVC project template. This will serve as the foundation for our UI application.</p>
<p>To create new ASP.NET Core Web App (Model-View-Controller) project you can use either Visual Studio Code or Visual Studio 2022 (latest version).</p>
<p><strong>Using Visual Studio Code</strong></p>
<p>Assuming you already have the .NET Core SDK installed in your system, follow these steps to create a new .NET Core MVC project:</p>
<p>Open Visual Studio Code and open the terminal and use following command to see list of templates.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#microservices-6.aspnet-app-__codelineno-0-1"></a>dotnet<span class="w"> </span>new<span class="w"> </span>--list
</span></code></pre></div>
<p><strong>output</strong></p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#microservices-6.aspnet-app-__codelineno-1-1"></a>These<span class="w"> </span>templates<span class="w"> </span>matched<span class="w"> </span>your<span class="w"> </span>input:<span class="w"> </span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#microservices-6.aspnet-app-__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#microservices-6.aspnet-app-__codelineno-1-3"></a>Template<span class="w"> </span>Name<span class="w">                                 </span>Short<span class="w"> </span>Name<span class="w">           </span>Language<span class="w">    </span>Tags
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#microservices-6.aspnet-app-__codelineno-1-4"></a>--------------------------------------------<span class="w">  </span>-------------------<span class="w">  </span>----------<span class="w">  </span>-------------------------------------
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#microservices-6.aspnet-app-__codelineno-1-5"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>Empty<span class="w">                            </span>web<span class="w">                  </span><span class="o">[</span>C#<span class="o">]</span>,F#<span class="w">     </span>Web/Empty
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#microservices-6.aspnet-app-__codelineno-1-6"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>gRPC<span class="w"> </span>Service<span class="w">                     </span>grpc<span class="w">                 </span><span class="o">[</span>C#<span class="o">]</span><span class="w">        </span>Web/gRPC
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#microservices-6.aspnet-app-__codelineno-1-7"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>Web<span class="w"> </span>API<span class="w">                          </span>webapi<span class="w">               </span><span class="o">[</span>C#<span class="o">]</span>,F#<span class="w">     </span>Web/WebAPI
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#microservices-6.aspnet-app-__codelineno-1-8"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>Web<span class="w"> </span>App<span class="w">                          </span>razor,webapp<span class="w">         </span><span class="o">[</span>C#<span class="o">]</span><span class="w">        </span>Web/MVC/Razor<span class="w"> </span>Pages
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#microservices-6.aspnet-app-__codelineno-1-9"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>Web<span class="w"> </span>App<span class="w"> </span><span class="o">(</span>Model-View-Controller<span class="o">)</span><span class="w">  </span>mvc<span class="w">                  </span><span class="o">[</span>C#<span class="o">]</span>,F#<span class="w">     </span>Web/MVC
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#microservices-6.aspnet-app-__codelineno-1-10"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>with<span class="w"> </span>Angular<span class="w">                     </span>angular<span class="w">              </span><span class="o">[</span>C#<span class="o">]</span><span class="w">        </span>Web/MVC/SPA
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#microservices-6.aspnet-app-__codelineno-1-11"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>with<span class="w"> </span>React.js<span class="w">                    </span>react<span class="w">                </span><span class="o">[</span>C#<span class="o">]</span><span class="w">        </span>Web/MVC/SPA
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#microservices-6.aspnet-app-__codelineno-1-12"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>with<span class="w"> </span>React.js<span class="w"> </span>and<span class="w"> </span>Redux<span class="w">          </span>reactredux<span class="w">           </span><span class="o">[</span>C#<span class="o">]</span><span class="w">        </span>Web/MVC/SPA
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#microservices-6.aspnet-app-__codelineno-1-13"></a>Blazor<span class="w"> </span>Server<span class="w"> </span>App<span class="w">                             </span>blazorserver<span class="w">         </span><span class="o">[</span>C#<span class="o">]</span><span class="w">        </span>Web/Blazor
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#microservices-6.aspnet-app-__codelineno-1-14"></a>Blazor<span class="w"> </span>WebAssembly<span class="w"> </span>App<span class="w">                        </span>blazorwasm<span class="w">           </span><span class="o">[</span>C#<span class="o">]</span><span class="w">        </span>Web/Blazor/WebAssembly/PWA
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#microservices-6.aspnet-app-__codelineno-1-15"></a>Class<span class="w"> </span>Library<span class="w">                                 </span>classlib<span class="w">             </span><span class="o">[</span>C#<span class="o">]</span>,F#,VB<span class="w">  </span>Common/Library
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#microservices-6.aspnet-app-__codelineno-1-16"></a>Console<span class="w"> </span>App<span class="w">                                   </span>console<span class="w">              </span><span class="o">[</span>C#<span class="o">]</span>,F#,VB<span class="w">  </span>Common/Console
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#microservices-6.aspnet-app-__codelineno-1-17"></a>.
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#microservices-6.aspnet-app-__codelineno-1-18"></a>.
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#microservices-6.aspnet-app-__codelineno-1-19"></a>and<span class="w"> </span>more....
</span></code></pre></div>
<p>Pick the following template for our MVC project from the list.</p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#microservices-6.aspnet-app-__codelineno-2-1"></a>ASP.NET<span class="w"> </span>Core<span class="w"> </span>Web<span class="w"> </span>App<span class="w"> </span><span class="o">(</span>Model-View-Controller<span class="o">)</span><span class="w">  </span>mvc<span class="w">                  </span><span class="o">[</span>C#<span class="o">]</span>,F#<span class="w">     </span>Web/MVC
</span></code></pre></div>
Use <code>dotnet new</code> command to create new MVC project</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#microservices-6.aspnet-app-__codelineno-3-1"></a>dotnet<span class="w"> </span>new<span class="w"> </span>mvc<span class="w"> </span>-o<span class="w"> </span>aspnet-app
</span></code></pre></div>
<p><strong>output</strong></p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#microservices-6.aspnet-app-__codelineno-4-1"></a>The<span class="w"> </span>template<span class="w"> </span><span class="s2">&quot;ASP.NET Core Web App (Model-View-Controller)&quot;</span><span class="w"> </span>was<span class="w"> </span>created<span class="w"> </span>successfully.
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#microservices-6.aspnet-app-__codelineno-4-2"></a>This<span class="w"> </span>template<span class="w"> </span>contains<span class="w"> </span>technologies<span class="w"> </span>from<span class="w"> </span>parties<span class="w"> </span>other<span class="w"> </span>than<span class="w"> </span>Microsoft,<span class="w"> </span>see<span class="w"> </span>https://aka.ms/aspnetcore/6.0-third-party-notices<span class="w"> </span><span class="k">for</span><span class="w"> </span>details.
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#microservices-6.aspnet-app-__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#microservices-6.aspnet-app-__codelineno-4-4"></a>Processing<span class="w"> </span>post-creation<span class="w"> </span>actions...
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#microservices-6.aspnet-app-__codelineno-4-5"></a>Running<span class="w"> </span><span class="s1">&#39;dotnet restore&#39;</span><span class="w"> </span>on<span class="w"> </span>C:<span class="se">\S</span>ource<span class="se">\R</span>epos<span class="se">\m</span>icroservices<span class="se">\a</span>spnet-app<span class="se">\a</span>spnet-app.csproj...
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#microservices-6.aspnet-app-__codelineno-4-6"></a><span class="w">  </span>Determining<span class="w"> </span>projects<span class="w"> </span>to<span class="w"> </span>restore...
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#microservices-6.aspnet-app-__codelineno-4-7"></a><span class="w">  </span>Restored<span class="w"> </span>C:<span class="se">\S</span>ource<span class="se">\R</span>epos<span class="se">\m</span>icroservices<span class="se">\a</span>spnet-app<span class="se">\a</span>spnet-app.csproj<span class="w"> </span><span class="o">(</span><span class="k">in</span><span class="w"> </span><span class="m">95</span><span class="w"> </span>ms<span class="o">)</span>.
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#microservices-6.aspnet-app-__codelineno-4-8"></a>Restore<span class="w"> </span>succeeded.
</span></code></pre></div>
<p><strong>Using Visual Studio 2022</strong></p>
<p>In case if you want to use Visual Studio only then, here are the steps to create a new ASP.NET Core Web App using the Model-View-Controller (MVC) architectural pattern:</p>
<ul>
<li>Open Visual Studio and select "Create a new project".</li>
<li>In the "Create a new project" window, select "ASP.NET Core Web Application" and click "Next".</li>
<li>Choose a name and location for your project and click "Create".</li>
<li>In the "Create a new ASP.NET Core Web Application" window, select "Web Application (Model-View-Controller)" and click "Create".</li>
</ul>
<p>Visual Studio will create a new project for you with the necessary files and folders to get started.</p>
<p>Once the MVC project is created successfully you will see the project folder structure like below:</p>
<p><a href="../microservices/images/image-13.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-13.jpg" /></a></p>
<p>cd to the new folder here <code>aspnet-app</code></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#microservices-6.aspnet-app-__codelineno-5-1"></a><span class="nb">cd</span><span class="w"> </span>.<span class="se">\a</span>spnet-app<span class="se">\</span>
</span></code></pre></div>
<h2 id="microservices-6.aspnet-app-step-2-test-the-new-aspnet-core-web-app-project">Step-2: Test the new ASP.NET core Web App project</h2>
<p>Perform testing of the ASP.NET MVC project to ensure its functionality and identify any issues or bugs that may need to be addressed.</p>
<p>Run the following command to build the project:</p>
<p><code>dotnet build</code> command will look for the project or solution file in the current directory and compile the code in it. It will also restore any dependencies required by the project and create the output files in the bin directory. </p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#microservices-6.aspnet-app-__codelineno-6-1"></a>dotnet<span class="w"> </span>build
</span></code></pre></div>
<p><strong>output</strong></p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#microservices-6.aspnet-app-__codelineno-7-1"></a>Microsoft<span class="w"> </span><span class="o">(</span>R<span class="o">)</span><span class="w"> </span>Build<span class="w"> </span>Engine<span class="w"> </span>version<span class="w"> </span><span class="m">17</span>.0.1+b177f8fa7<span class="w"> </span><span class="k">for</span><span class="w"> </span>.NET
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#microservices-6.aspnet-app-__codelineno-7-2"></a>Copyright<span class="w"> </span><span class="o">(</span>C<span class="o">)</span><span class="w"> </span>Microsoft<span class="w"> </span>Corporation.<span class="w"> </span>All<span class="w"> </span>rights<span class="w"> </span>reserved.
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#microservices-6.aspnet-app-__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#microservices-6.aspnet-app-__codelineno-7-4"></a><span class="w">  </span>Determining<span class="w"> </span>projects<span class="w"> </span>to<span class="w"> </span>restore...
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#microservices-6.aspnet-app-__codelineno-7-5"></a><span class="w">  </span>All<span class="w"> </span>projects<span class="w"> </span>are<span class="w"> </span>up-to-date<span class="w"> </span><span class="k">for</span><span class="w"> </span>restore.
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#microservices-6.aspnet-app-__codelineno-7-6"></a><span class="w">  </span>aspnet-app<span class="w"> </span>-&gt;<span class="w"> </span>C:<span class="se">\S</span>ource<span class="se">\R</span>epos<span class="se">\m</span>icroservices<span class="se">\a</span>spnet-app<span class="se">\b</span>in<span class="se">\D</span>ebug<span class="se">\n</span>et6.0<span class="se">\a</span>spnet-app.dll
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#microservices-6.aspnet-app-__codelineno-7-7"></a>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#microservices-6.aspnet-app-__codelineno-7-8"></a>Build<span class="w"> </span>succeeded.
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#microservices-6.aspnet-app-__codelineno-7-9"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>Warning<span class="o">(</span>s<span class="o">)</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#microservices-6.aspnet-app-__codelineno-7-10"></a><span class="w">    </span><span class="m">0</span><span class="w"> </span>Error<span class="o">(</span>s<span class="o">)</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#microservices-6.aspnet-app-__codelineno-7-11"></a>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#microservices-6.aspnet-app-__codelineno-7-12"></a>Time<span class="w"> </span>Elapsed<span class="w"> </span><span class="m">00</span>:00:05.07
</span></code></pre></div>
Run the following command to start the development server:</p>
<p><code>dotnet run</code> command will look for the project or solution file in the current directory and compile the code in it. After compiling, it will run the application and any output will be displayed in the console.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#microservices-6.aspnet-app-__codelineno-8-1"></a>dotnet<span class="w"> </span>run
</span></code></pre></div>
<p><strong>output</strong></p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#microservices-6.aspnet-app-__codelineno-9-1"></a>Building...
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#microservices-6.aspnet-app-__codelineno-9-2"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">14</span><span class="o">]</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#microservices-6.aspnet-app-__codelineno-9-3"></a><span class="w">      </span>Now<span class="w"> </span>listening<span class="w"> </span>on:<span class="w"> </span>https://localhost:7289
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#microservices-6.aspnet-app-__codelineno-9-4"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">14</span><span class="o">]</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#microservices-6.aspnet-app-__codelineno-9-5"></a><span class="w">      </span>Now<span class="w"> </span>listening<span class="w"> </span>on:<span class="w"> </span>http://localhost:5023
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#microservices-6.aspnet-app-__codelineno-9-6"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">0</span><span class="o">]</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#microservices-6.aspnet-app-__codelineno-9-7"></a><span class="w">      </span>Application<span class="w"> </span>started.<span class="w"> </span>Press<span class="w"> </span>Ctrl+C<span class="w"> </span>to<span class="w"> </span>shut<span class="w"> </span>down.
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#microservices-6.aspnet-app-__codelineno-9-8"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">0</span><span class="o">]</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#microservices-6.aspnet-app-__codelineno-9-9"></a><span class="w">      </span>Hosting<span class="w"> </span>environment:<span class="w"> </span>Development
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#microservices-6.aspnet-app-__codelineno-9-10"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">0</span><span class="o">]</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#microservices-6.aspnet-app-__codelineno-9-11"></a><span class="w">      </span>Content<span class="w"> </span>root<span class="w"> </span>path:<span class="w"> </span>C:<span class="se">\S</span>ource<span class="se">\R</span>epos<span class="se">\m</span>icroservices<span class="se">\a</span>spnet-app<span class="se">\</span>
</span></code></pre></div>
<p>You will notice the URL in the output, copy the URL and paste it in your favorite browser.
<a href="https://localhost:7289/">https://localhost:7289/</a></p>
<p><a href="../microservices/images/image-14.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-14.jpg" /></a></p>
<p>For the first time if you are able to see this page in your browser that means ASP.NET MVC project is created as expected.</p>
<p>Use these git commands to push the source code to remote git.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#microservices-6.aspnet-app-__codelineno-10-1"></a>git<span class="w"> </span>add<span class="w"> </span>.
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#microservices-6.aspnet-app-__codelineno-10-2"></a>git<span class="w"> </span>commit<span class="w"> </span>-a<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;My fist mvc app commit.&quot;</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#microservices-6.aspnet-app-__codelineno-10-3"></a>git<span class="w"> </span>push<span class="w"> </span>--set-upstream<span class="w"> </span>origin<span class="w"> </span>main
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#microservices-6.aspnet-app-__codelineno-10-4"></a>git<span class="w"> </span>status
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the simplicity I am creating all the applications in the same repo called <code>microservices</code> but in reality you may need to follow your organization standards for creating git repos</p>
</div>
<p>New folder structure will look like below in the microservices git repo. you will notice the new <code>aspnet-app</code> folder with MVC project source code. </p>
<p><a href="../microservices/images/image-15.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-15.jpg" /></a></p>
<h2 id="microservices-6.aspnet-app-step-3-update-home-page-contentsoptional">Step-3: Update home page contents[Optional]</h2>
<p>Let's update our landing page to show .NET version, Operating System, processor, CPU core etc.. this information will provide us some technical details of the application when we deploy it in our AKS in the upcoming labs.  </p>
<p>We are going to update the <code>Index.html</code> file with following code.</p>
<p><div class="language-c# highlight"><span class="filename">Index.html</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#microservices-6.aspnet-app-__codelineno-11-1"></a><span class="n">@page</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#microservices-6.aspnet-app-__codelineno-11-2"></a><span class="n">@using</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#microservices-6.aspnet-app-__codelineno-11-3"></a><span class="n">@using</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="n">IO</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#microservices-6.aspnet-app-__codelineno-11-4"></a><span class="n">@using</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="n">Diagnostics</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#microservices-6.aspnet-app-__codelineno-11-5"></a><span class="err">@</span><span class="p">{</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#microservices-6.aspnet-app-__codelineno-11-6"></a><span class="w">    </span><span class="c1">//ViewData[&quot;Title&quot;] = &quot;Home page&quot;;</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#microservices-6.aspnet-app-__codelineno-11-7"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">hostName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">Dns</span><span class="p">.</span><span class="n">GetHostName</span><span class="p">();</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#microservices-6.aspnet-app-__codelineno-11-8"></a><span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">ipList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">Dns</span><span class="p">.</span><span class="n">GetHostAddressesAsync</span><span class="p">(</span><span class="n">hostName</span><span class="p">);</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#microservices-6.aspnet-app-__codelineno-11-9"></a>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#microservices-6.aspnet-app-__codelineno-11-10"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">Mebi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">;</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#microservices-6.aspnet-app-__codelineno-11-11"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">Gibi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Mebi</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">;</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#microservices-6.aspnet-app-__codelineno-11-12"></a><span class="w">    </span><span class="n">GCMemoryInfo</span><span class="w"> </span><span class="n">gcInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GC</span><span class="p">.</span><span class="n">GetGCMemoryInfo</span><span class="p">();</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#microservices-6.aspnet-app-__codelineno-11-13"></a><span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">totalAvailableMemory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetInBestUnit</span><span class="p">(</span><span class="n">gcInfo</span><span class="p">.</span><span class="n">TotalAvailableMemoryBytes</span><span class="p">);</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#microservices-6.aspnet-app-__codelineno-11-14"></a>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#microservices-6.aspnet-app-__codelineno-11-15"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">cgroup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RuntimeInformation</span><span class="p">.</span><span class="n">OSDescription</span><span class="p">.</span><span class="n">StartsWith</span><span class="p">(</span><span class="s">&quot;Linux&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">Directory</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span><span class="s">&quot;/sys/fs/cgroup/memory&quot;</span><span class="p">);</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#microservices-6.aspnet-app-__codelineno-11-16"></a><span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">memoryUsage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#microservices-6.aspnet-app-__codelineno-11-17"></a><span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="n">memoryLimit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#microservices-6.aspnet-app-__codelineno-11-18"></a>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#microservices-6.aspnet-app-__codelineno-11-19"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cgroup</span><span class="p">)</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#microservices-6.aspnet-app-__codelineno-11-20"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#microservices-6.aspnet-app-__codelineno-11-21"></a><span class="w">        </span><span class="kt">string</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">File</span><span class="p">.</span><span class="n">ReadAllLines</span><span class="p">(</span><span class="s">&quot;/sys/fs/cgroup/memory/memory.usage_in_bytes&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#microservices-6.aspnet-app-__codelineno-11-22"></a><span class="w">        </span><span class="kt">string</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">File</span><span class="p">.</span><span class="n">ReadAllLines</span><span class="p">(</span><span class="s">&quot;/sys/fs/cgroup/memory/memory.limit_in_bytes&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#microservices-6.aspnet-app-__codelineno-11-23"></a><span class="w">        </span><span class="n">memoryUsage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetInBestUnit</span><span class="p">(</span><span class="kt">long</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">usage</span><span class="p">));</span>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24" href="#microservices-6.aspnet-app-__codelineno-11-24"></a><span class="w">        </span><span class="n">memoryLimit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetInBestUnit</span><span class="p">(</span><span class="kt">long</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">limit</span><span class="p">));</span>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25" href="#microservices-6.aspnet-app-__codelineno-11-25"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26" href="#microservices-6.aspnet-app-__codelineno-11-26"></a><span class="p">}</span>
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27" href="#microservices-6.aspnet-app-__codelineno-11-27"></a><span class="o">&lt;</span><span class="n">div</span><span class="w"> </span><span class="n">align</span><span class="o">=</span><span class="s">&quot;center&quot;</span><span class="o">&gt;</span>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28" href="#microservices-6.aspnet-app-__codelineno-11-28"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">table</span><span class="w"> </span><span class="n">class</span><span class="o">=</span><span class="s">&quot;table table-striped table-hover&quot;</span><span class="o">&gt;</span>
</span><span id="__span-11-29"><a id="__codelineno-11-29" name="__codelineno-11-29" href="#microservices-6.aspnet-app-__codelineno-11-29"></a><span class="w">        </span><span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-30"><a id="__codelineno-11-30" name="__codelineno-11-30" href="#microservices-6.aspnet-app-__codelineno-11-30"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="p">.</span><span class="n">NET</span><span class="w"> </span><span class="n">version</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-31"><a id="__codelineno-11-31" name="__codelineno-11-31" href="#microservices-6.aspnet-app-__codelineno-11-31"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">@RuntimeInformation</span><span class="p">.</span><span class="n">FrameworkDescription</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-32"><a id="__codelineno-11-32" name="__codelineno-11-32" href="#microservices-6.aspnet-app-__codelineno-11-32"></a><span class="w">        </span><span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-33"><a id="__codelineno-11-33" name="__codelineno-11-33" href="#microservices-6.aspnet-app-__codelineno-11-33"></a><span class="w">        </span><span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-34"><a id="__codelineno-11-34" name="__codelineno-11-34" href="#microservices-6.aspnet-app-__codelineno-11-34"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">Operating</span><span class="w"> </span><span class="n">system</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-35"><a id="__codelineno-11-35" name="__codelineno-11-35" href="#microservices-6.aspnet-app-__codelineno-11-35"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">@RuntimeInformation</span><span class="p">.</span><span class="n">OSDescription</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-36"><a id="__codelineno-11-36" name="__codelineno-11-36" href="#microservices-6.aspnet-app-__codelineno-11-36"></a><span class="w">        </span><span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-37"><a id="__codelineno-11-37" name="__codelineno-11-37" href="#microservices-6.aspnet-app-__codelineno-11-37"></a><span class="w">        </span><span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-38"><a id="__codelineno-11-38" name="__codelineno-11-38" href="#microservices-6.aspnet-app-__codelineno-11-38"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">Processor</span><span class="w"> </span><span class="n">architecture</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-39"><a id="__codelineno-11-39" name="__codelineno-11-39" href="#microservices-6.aspnet-app-__codelineno-11-39"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">@RuntimeInformation</span><span class="p">.</span><span class="n">OSArchitecture</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-40"><a id="__codelineno-11-40" name="__codelineno-11-40" href="#microservices-6.aspnet-app-__codelineno-11-40"></a><span class="w">        </span><span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-41"><a id="__codelineno-11-41" name="__codelineno-11-41" href="#microservices-6.aspnet-app-__codelineno-11-41"></a><span class="w">        </span><span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-42"><a id="__codelineno-11-42" name="__codelineno-11-42" href="#microservices-6.aspnet-app-__codelineno-11-42"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">CPU</span><span class="w"> </span><span class="n">cores</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-43"><a id="__codelineno-11-43" name="__codelineno-11-43" href="#microservices-6.aspnet-app-__codelineno-11-43"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">@Environment</span><span class="p">.</span><span class="n">ProcessorCount</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-44"><a id="__codelineno-11-44" name="__codelineno-11-44" href="#microservices-6.aspnet-app-__codelineno-11-44"></a><span class="w">        </span><span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-45"><a id="__codelineno-11-45" name="__codelineno-11-45" href="#microservices-6.aspnet-app-__codelineno-11-45"></a><span class="w">        </span><span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-46"><a id="__codelineno-11-46" name="__codelineno-11-46" href="#microservices-6.aspnet-app-__codelineno-11-46"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">Containerized</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-47"><a id="__codelineno-11-47" name="__codelineno-11-47" href="#microservices-6.aspnet-app-__codelineno-11-47"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="err">@</span><span class="p">(</span><span class="n">Environment</span><span class="p">.</span><span class="n">GetEnvironmentVariable</span><span class="p">(</span><span class="s">&quot;DOTNET_RUNNING_IN_CONTAINER&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;false&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s">&quot;true&quot;</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-48"><a id="__codelineno-11-48" name="__codelineno-11-48" href="#microservices-6.aspnet-app-__codelineno-11-48"></a><span class="w">        </span><span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-49"><a id="__codelineno-11-49" name="__codelineno-11-49" href="#microservices-6.aspnet-app-__codelineno-11-49"></a><span class="w">        </span><span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-50"><a id="__codelineno-11-50" name="__codelineno-11-50" href="#microservices-6.aspnet-app-__codelineno-11-50"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">Memory</span><span class="p">,</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">GC</span><span class="w"> </span><span class="n">memory</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-51"><a id="__codelineno-11-51" name="__codelineno-11-51" href="#microservices-6.aspnet-app-__codelineno-11-51"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">@totalAvailableMemory</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-52"><a id="__codelineno-11-52" name="__codelineno-11-52" href="#microservices-6.aspnet-app-__codelineno-11-52"></a><span class="w">        </span><span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-53"><a id="__codelineno-11-53" name="__codelineno-11-53" href="#microservices-6.aspnet-app-__codelineno-11-53"></a><span class="w">        </span><span class="n">@if</span><span class="w"> </span><span class="p">(</span><span class="n">cgroup</span><span class="p">)</span>
</span><span id="__span-11-54"><a id="__codelineno-11-54" name="__codelineno-11-54" href="#microservices-6.aspnet-app-__codelineno-11-54"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-11-55"><a id="__codelineno-11-55" name="__codelineno-11-55" href="#microservices-6.aspnet-app-__codelineno-11-55"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-56"><a id="__codelineno-11-56" name="__codelineno-11-56" href="#microservices-6.aspnet-app-__codelineno-11-56"></a><span class="w">                </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">cgroup</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">usage</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-57"><a id="__codelineno-11-57" name="__codelineno-11-57" href="#microservices-6.aspnet-app-__codelineno-11-57"></a><span class="w">                </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">@memoryUsage</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-58"><a id="__codelineno-11-58" name="__codelineno-11-58" href="#microservices-6.aspnet-app-__codelineno-11-58"></a><span class="w">            </span><span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-59"><a id="__codelineno-11-59" name="__codelineno-11-59" href="#microservices-6.aspnet-app-__codelineno-11-59"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-60"><a id="__codelineno-11-60" name="__codelineno-11-60" href="#microservices-6.aspnet-app-__codelineno-11-60"></a><span class="w">                </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">cgroup</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">limit</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-61"><a id="__codelineno-11-61" name="__codelineno-11-61" href="#microservices-6.aspnet-app-__codelineno-11-61"></a><span class="w">                </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">@memoryLimit</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-62"><a id="__codelineno-11-62" name="__codelineno-11-62" href="#microservices-6.aspnet-app-__codelineno-11-62"></a><span class="w">            </span><span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-63"><a id="__codelineno-11-63" name="__codelineno-11-63" href="#microservices-6.aspnet-app-__codelineno-11-63"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-11-64"><a id="__codelineno-11-64" name="__codelineno-11-64" href="#microservices-6.aspnet-app-__codelineno-11-64"></a><span class="w">        </span><span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-65"><a id="__codelineno-11-65" name="__codelineno-11-65" href="#microservices-6.aspnet-app-__codelineno-11-65"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">Host</span><span class="w"> </span><span class="n">name</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-66"><a id="__codelineno-11-66" name="__codelineno-11-66" href="#microservices-6.aspnet-app-__codelineno-11-66"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span><span class="n">@hostName</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-67"><a id="__codelineno-11-67" name="__codelineno-11-67" href="#microservices-6.aspnet-app-__codelineno-11-67"></a><span class="w">        </span><span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-68"><a id="__codelineno-11-68" name="__codelineno-11-68" href="#microservices-6.aspnet-app-__codelineno-11-68"></a><span class="w">        </span><span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-69"><a id="__codelineno-11-69" name="__codelineno-11-69" href="#microservices-6.aspnet-app-__codelineno-11-69"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">td</span><span class="w"> </span><span class="n">style</span><span class="o">=</span><span class="s">&quot;vertical-align: top&quot;</span><span class="o">&gt;</span><span class="n">Server</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="n">address</span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-70"><a id="__codelineno-11-70" name="__codelineno-11-70" href="#microservices-6.aspnet-app-__codelineno-11-70"></a><span class="w">            </span><span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-71"><a id="__codelineno-11-71" name="__codelineno-11-71" href="#microservices-6.aspnet-app-__codelineno-11-71"></a><span class="w">                </span><span class="err">@</span><span class="p">{</span>
</span><span id="__span-11-72"><a id="__codelineno-11-72" name="__codelineno-11-72" href="#microservices-6.aspnet-app-__codelineno-11-72"></a><span class="w">                    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">ipList</span><span class="p">)</span>
</span><span id="__span-11-73"><a id="__codelineno-11-73" name="__codelineno-11-73" href="#microservices-6.aspnet-app-__codelineno-11-73"></a><span class="w">                    </span><span class="p">{</span>
</span><span id="__span-11-74"><a id="__codelineno-11-74" name="__codelineno-11-74" href="#microservices-6.aspnet-app-__codelineno-11-74"></a><span class="w">                        </span><span class="n">@ip</span>
</span><span id="__span-11-75"><a id="__codelineno-11-75" name="__codelineno-11-75" href="#microservices-6.aspnet-app-__codelineno-11-75"></a><span class="w">                        </span><span class="o">&lt;</span><span class="n">br</span><span class="w"> </span><span class="o">/&gt;</span>
</span><span id="__span-11-76"><a id="__codelineno-11-76" name="__codelineno-11-76" href="#microservices-6.aspnet-app-__codelineno-11-76"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-11-77"><a id="__codelineno-11-77" name="__codelineno-11-77" href="#microservices-6.aspnet-app-__codelineno-11-77"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-11-78"><a id="__codelineno-11-78" name="__codelineno-11-78" href="#microservices-6.aspnet-app-__codelineno-11-78"></a><span class="w">            </span><span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span><span id="__span-11-79"><a id="__codelineno-11-79" name="__codelineno-11-79" href="#microservices-6.aspnet-app-__codelineno-11-79"></a><span class="w">        </span><span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</span><span id="__span-11-80"><a id="__codelineno-11-80" name="__codelineno-11-80" href="#microservices-6.aspnet-app-__codelineno-11-80"></a><span class="w">    </span><span class="o">&lt;/</span><span class="n">table</span><span class="o">&gt;</span>
</span><span id="__span-11-81"><a id="__codelineno-11-81" name="__codelineno-11-81" href="#microservices-6.aspnet-app-__codelineno-11-81"></a><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span id="__span-11-82"><a id="__codelineno-11-82" name="__codelineno-11-82" href="#microservices-6.aspnet-app-__codelineno-11-82"></a>
</span><span id="__span-11-83"><a id="__codelineno-11-83" name="__codelineno-11-83" href="#microservices-6.aspnet-app-__codelineno-11-83"></a><span class="err">@</span><span class="p">{</span>
</span><span id="__span-11-84"><a id="__codelineno-11-84" name="__codelineno-11-84" href="#microservices-6.aspnet-app-__codelineno-11-84"></a><span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="nf">GetInBestUnit</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="n">size</span><span class="p">)</span>
</span><span id="__span-11-85"><a id="__codelineno-11-85" name="__codelineno-11-85" href="#microservices-6.aspnet-app-__codelineno-11-85"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-11-86"><a id="__codelineno-11-86" name="__codelineno-11-86" href="#microservices-6.aspnet-app-__codelineno-11-86"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Mebi</span><span class="p">)</span>
</span><span id="__span-11-87"><a id="__codelineno-11-87" name="__codelineno-11-87" href="#microservices-6.aspnet-app-__codelineno-11-87"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-11-88"><a id="__codelineno-11-88" name="__codelineno-11-88" href="#microservices-6.aspnet-app-__codelineno-11-88"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">$&quot;{size} bytes&quot;</span><span class="p">;</span>
</span><span id="__span-11-89"><a id="__codelineno-11-89" name="__codelineno-11-89" href="#microservices-6.aspnet-app-__codelineno-11-89"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-11-90"><a id="__codelineno-11-90" name="__codelineno-11-90" href="#microservices-6.aspnet-app-__codelineno-11-90"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">Gibi</span><span class="p">)</span>
</span><span id="__span-11-91"><a id="__codelineno-11-91" name="__codelineno-11-91" href="#microservices-6.aspnet-app-__codelineno-11-91"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-11-92"><a id="__codelineno-11-92" name="__codelineno-11-92" href="#microservices-6.aspnet-app-__codelineno-11-92"></a><span class="w">            </span><span class="kt">decimal</span><span class="w"> </span><span class="n">mebibytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Decimal</span><span class="p">.</span><span class="n">Divide</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">Mebi</span><span class="p">);</span>
</span><span id="__span-11-93"><a id="__codelineno-11-93" name="__codelineno-11-93" href="#microservices-6.aspnet-app-__codelineno-11-93"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">$&quot;{mebibytes:F} MiB&quot;</span><span class="p">;</span>
</span><span id="__span-11-94"><a id="__codelineno-11-94" name="__codelineno-11-94" href="#microservices-6.aspnet-app-__codelineno-11-94"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-11-95"><a id="__codelineno-11-95" name="__codelineno-11-95" href="#microservices-6.aspnet-app-__codelineno-11-95"></a><span class="w">        </span><span class="k">else</span>
</span><span id="__span-11-96"><a id="__codelineno-11-96" name="__codelineno-11-96" href="#microservices-6.aspnet-app-__codelineno-11-96"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-11-97"><a id="__codelineno-11-97" name="__codelineno-11-97" href="#microservices-6.aspnet-app-__codelineno-11-97"></a><span class="w">            </span><span class="kt">decimal</span><span class="w"> </span><span class="n">gibibytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Decimal</span><span class="p">.</span><span class="n">Divide</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">Gibi</span><span class="p">);</span>
</span><span id="__span-11-98"><a id="__codelineno-11-98" name="__codelineno-11-98" href="#microservices-6.aspnet-app-__codelineno-11-98"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">$&quot;{gibibytes:F} GiB&quot;</span><span class="p">;</span>
</span><span id="__span-11-99"><a id="__codelineno-11-99" name="__codelineno-11-99" href="#microservices-6.aspnet-app-__codelineno-11-99"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-11-100"><a id="__codelineno-11-100" name="__codelineno-11-100" href="#microservices-6.aspnet-app-__codelineno-11-100"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-11-101"><a id="__codelineno-11-101" name="__codelineno-11-101" href="#microservices-6.aspnet-app-__codelineno-11-101"></a><span class="p">}</span>
</span></code></pre></div>
Here is the home page with new details:</p>
<p><a href="../microservices/images/image-16.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-16.jpg" /></a></p>
<p>Now it is time to commit our source code </p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#microservices-6.aspnet-app-__codelineno-12-1"></a>git<span class="w"> </span>add<span class="w"> </span>.
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#microservices-6.aspnet-app-__codelineno-12-2"></a>git<span class="w"> </span>commit<span class="w"> </span>-am<span class="w"> </span><span class="s2">&quot;updated landing page&quot;</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#microservices-6.aspnet-app-__codelineno-12-3"></a>git<span class="w"> </span>push<span class="w"> </span>
</span></code></pre></div>
<h2 id="microservices-6.aspnet-app-step-4-add-dockerfiles-to-the-mvc-project">Step-4: Add Dockerfiles to the MVC project</h2>
<p>This file define the necessary instructions to build Docker images for the application.</p>
<p>Create a Dockerfile in the root directory of the MVC project and copy following code.</p>
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#microservices-6.aspnet-app-__codelineno-13-1"></a><span class="c">#See https://aka.ms/containerfastmode to understand how Visual Studio uses this Dockerfile to build your images for faster debugging.</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#microservices-6.aspnet-app-__codelineno-13-2"></a><span class="c"># Use the official Microsoft ASP.NET Core runtime image as a parent image</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#microservices-6.aspnet-app-__codelineno-13-3"></a><span class="k">FROM</span><span class="w"> </span><span class="s">mcr.microsoft.com/dotnet/aspnet:6.0</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">base</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#microservices-6.aspnet-app-__codelineno-13-4"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#microservices-6.aspnet-app-__codelineno-13-5"></a><span class="k">EXPOSE</span><span class="w"> </span><span class="s">80</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#microservices-6.aspnet-app-__codelineno-13-6"></a><span class="k">EXPOSE</span><span class="w"> </span><span class="s">443</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#microservices-6.aspnet-app-__codelineno-13-7"></a>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#microservices-6.aspnet-app-__codelineno-13-8"></a><span class="c"># Copy the project files and restore dependencies</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#microservices-6.aspnet-app-__codelineno-13-9"></a><span class="k">FROM</span><span class="w"> </span><span class="s">mcr.microsoft.com/dotnet/sdk:6.0</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">build</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#microservices-6.aspnet-app-__codelineno-13-10"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/src</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#microservices-6.aspnet-app-__codelineno-13-11"></a><span class="k">COPY</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;aspnet-app.csproj&quot;</span>,<span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="o">]</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#microservices-6.aspnet-app-__codelineno-13-12"></a><span class="k">RUN</span><span class="w"> </span>dotnet<span class="w"> </span>restore<span class="w"> </span><span class="s2">&quot;./aspnet-app.csproj&quot;</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#microservices-6.aspnet-app-__codelineno-13-13"></a>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#microservices-6.aspnet-app-__codelineno-13-14"></a><span class="c"># Copy the remaining files and build the application</span>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#microservices-6.aspnet-app-__codelineno-13-15"></a><span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>.
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#microservices-6.aspnet-app-__codelineno-13-16"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">&quot;/src/.&quot;</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#microservices-6.aspnet-app-__codelineno-13-17"></a><span class="k">RUN</span><span class="w"> </span>dotnet<span class="w"> </span>build<span class="w"> </span><span class="s2">&quot;aspnet-app.csproj&quot;</span><span class="w"> </span>-c<span class="w"> </span>Release<span class="w"> </span>-o<span class="w"> </span>/app/build
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#microservices-6.aspnet-app-__codelineno-13-18"></a>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#microservices-6.aspnet-app-__codelineno-13-19"></a><span class="c"># Publish the application</span>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#microservices-6.aspnet-app-__codelineno-13-20"></a><span class="k">FROM</span><span class="w"> </span><span class="s">build</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">publish</span>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21" href="#microservices-6.aspnet-app-__codelineno-13-21"></a><span class="k">RUN</span><span class="w"> </span>dotnet<span class="w"> </span>publish<span class="w"> </span><span class="s2">&quot;aspnet-app.csproj&quot;</span><span class="w"> </span>-c<span class="w"> </span>Release<span class="w"> </span>-o<span class="w"> </span>/app/publish
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22" href="#microservices-6.aspnet-app-__codelineno-13-22"></a>
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23" href="#microservices-6.aspnet-app-__codelineno-13-23"></a><span class="c"># Final image</span>
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24" href="#microservices-6.aspnet-app-__codelineno-13-24"></a><span class="k">FROM</span><span class="w"> </span><span class="s">base</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">final</span>
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25" href="#microservices-6.aspnet-app-__codelineno-13-25"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26" href="#microservices-6.aspnet-app-__codelineno-13-26"></a><span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>publish<span class="w"> </span>/app/publish<span class="w"> </span>.
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27" href="#microservices-6.aspnet-app-__codelineno-13-27"></a><span class="c"># Start the application</span>
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28" href="#microservices-6.aspnet-app-__codelineno-13-28"></a><span class="k">ENTRYPOINT</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;dotnet&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;aspnet-app.dll&quot;</span><span class="p">]</span>
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Read inline comments of the Dockerfile for understanding the Dockerfile instructions</p>
</div>
<h2 id="microservices-6.aspnet-app-step-5-docker-build-locally">Step-5: Docker Build locally</h2>
<p>Build Docker images locally using the Dockerfiles added to the MVC project. This process will generate container images ready for deployment.</p>
<p>The <code>docker build</code> command is used to build Docker images from a Dockerfile. The Dockerfile contains a set of instructions that Docker uses to create a new image. </p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#microservices-6.aspnet-app-__codelineno-14-1"></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>sample/aspnet-app:20230312.1<span class="w"> </span>.
</span></code></pre></div>
<code>-t</code> to specify a name and optionally a tag for the image,</p>
<p>output</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#microservices-6.aspnet-app-__codelineno-15-1"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Building<span class="w"> </span><span class="m">49</span>.9s<span class="w"> </span><span class="o">(</span><span class="m">18</span>/18<span class="o">)</span><span class="w"> </span><span class="nv">FINISHED</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#microservices-6.aspnet-app-__codelineno-15-2"></a><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">[</span>internal<span class="o">]</span><span class="w"> </span>load<span class="w"> </span>build<span class="w"> </span>definition<span class="w"> </span>from<span class="w"> </span><span class="nv">Dockerfile</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#microservices-6.aspnet-app-__codelineno-15-3"></a><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>transferring<span class="w"> </span>dockerfile:<span class="w"> </span><span class="nv">696B</span><span class="w">                </span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#microservices-6.aspnet-app-__codelineno-15-4"></a><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">[</span>internal<span class="o">]</span><span class="w"> </span>load<span class="w"> </span>.dockerignore<span class="w">                   </span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#microservices-6.aspnet-app-__codelineno-15-5"></a><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>transferring<span class="w"> </span>context:<span class="w"> </span><span class="nv">2B</span><span class="w">                     </span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#microservices-6.aspnet-app-__codelineno-15-6"></a><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">[</span>internal<span class="o">]</span><span class="w"> </span>load<span class="w"> </span>metadata<span class="w"> </span><span class="k">for</span><span class="w"> </span>mcr.microsoft.com/dotnet/sdk:6.0<span class="w">        </span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#microservices-6.aspnet-app-__codelineno-15-7"></a><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">[</span>internal<span class="o">]</span><span class="w"> </span>load<span class="w"> </span>metadata<span class="w"> </span><span class="k">for</span><span class="w"> </span>mcr.microsoft.com/dotnet/aspnet:6.0<span class="w"> </span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#microservices-6.aspnet-app-__codelineno-15-8"></a><span class="w"> </span>.
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#microservices-6.aspnet-app-__codelineno-15-9"></a><span class="w"> </span>.
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#microservices-6.aspnet-app-__codelineno-15-10"></a><span class="w"> </span>.
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#microservices-6.aspnet-app-__codelineno-15-11"></a><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>exporting<span class="w"> </span>to<span class="w"> </span><span class="nv">image</span><span class="w"> </span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#microservices-6.aspnet-app-__codelineno-15-12"></a><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>exporting<span class="w"> </span><span class="nv">layers</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#microservices-6.aspnet-app-__codelineno-15-13"></a><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>writing<span class="w"> </span>image<span class="w"> </span>sha256:587f347206bcc67dafe3c0b53047862f11b6e52b1b61bce15b8432cc3a488e24
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#microservices-6.aspnet-app-__codelineno-15-14"></a><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>naming<span class="w"> </span>to<span class="w"> </span>docker.io/sample/aspnet-app:20230312.1<span class="w">  </span>
</span></code></pre></div>
<p>When you run the <code>docker build</code> command, Docker looks for a Dockerfile in the specified directory (PATH) and reads the instructions in the file to build a new image. The Dockerfile contains a series of instructions that define how to build the image, such as copying files, running commands, and setting environment variales. </p>
<p><strong>Error &amp; troubleshooting</strong></p>
<p>In case if you are getting following error while running <code>docker build</code> command, that means the docker desktop is not running locally. make sure that run the docker desktop locally to fix this issue.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#microservices-6.aspnet-app-__codelineno-16-1"></a>error<span class="w"> </span>during<span class="w"> </span>connect:<span class="w"> </span>This<span class="w"> </span>error<span class="w"> </span>may<span class="w"> </span>indicate<span class="w"> </span>that<span class="w"> </span>the<span class="w"> </span>docker<span class="w"> </span>daemon<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>running.:<span class="w"> </span>Post<span class="w"> </span><span class="s2">&quot;http://%2F%2F.%2Fpipe%2Fdocker_engine/v1.24/build?buildargs=%7B%7D&amp;cachefrom=%5B%5D&amp;cgroupparent=&amp;cpuperiod=0&amp;cpuquota=0&amp;cpusetcpus=&amp;cpusetmems=&amp;cpushares=0&amp;dockerfile=Dockerfile&amp;labels=%7B%7D&amp;memory=0&amp;memswap=0&amp;networkmode=default&amp;rm=1&amp;shmsize=0&amp;t=sample%2Faspnet-app%3A20230312.1&amp;target=&amp;ulimits=null&amp;version=1&quot;</span>:<span class="w"> </span>open<span class="w"> </span>//./pipe/docker_engine:<span class="w"> </span>The<span class="w"> </span>system<span class="w"> </span>cannot<span class="w"> </span>find<span class="w"> </span>the<span class="w"> </span>file<span class="w"> </span>specified.
</span></code></pre></div>
<h2 id="microservices-6.aspnet-app-step-6-docker-run-locally">Step-6: Docker Run locally</h2>
<p>Run the Docker container locally to verify that the application functions correctly within a containerized environment. This step ensures that the containerized application operates as expected on your local machine.</p>
<p>Run the <code>docker run</code> command to start a container based on the image:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#microservices-6.aspnet-app-__codelineno-17-1"></a>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-p<span class="w"> </span><span class="m">8080</span>:80<span class="w"> </span>sample/aspnet-app:20230312.1
</span></code></pre></div>
<p><em>output</em>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#microservices-6.aspnet-app-__codelineno-18-1"></a>warn:<span class="w"> </span>Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository<span class="o">[</span><span class="m">60</span><span class="o">]</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#microservices-6.aspnet-app-__codelineno-18-2"></a><span class="w">      </span>Storing<span class="w"> </span>keys<span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span>directory<span class="w"> </span><span class="s1">&#39;/root/.aspnet/DataProtection-Keys&#39;</span><span class="w"> </span>that<span class="w"> </span>may<span class="w"> </span>not<span class="w"> </span>be<span class="w"> </span>persisted<span class="w"> </span>outside<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>container.<span class="w"> </span>Protected<span class="w"> </span>data<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>unavailable<span class="w"> </span>when<span class="w"> </span>container<span class="w"> </span>is<span class="w"> </span>destroyed.
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#microservices-6.aspnet-app-__codelineno-18-3"></a>warn:<span class="w"> </span>Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager<span class="o">[</span><span class="m">35</span><span class="o">]</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#microservices-6.aspnet-app-__codelineno-18-4"></a><span class="w">      </span>No<span class="w"> </span>XML<span class="w"> </span>encryptor<span class="w"> </span>configured.<span class="w"> </span>Key<span class="w"> </span><span class="o">{</span>90c41ec3-18a3-434a-8d4b-1d0cc5f140af<span class="o">}</span><span class="w"> </span>may<span class="w"> </span>be<span class="w"> </span>persisted<span class="w"> </span>to<span class="w"> </span>storage<span class="w"> </span><span class="k">in</span><span class="w"> </span>unencrypted<span class="w"> </span>form.
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#microservices-6.aspnet-app-__codelineno-18-5"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">14</span><span class="o">]</span><span class="w">  </span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#microservices-6.aspnet-app-__codelineno-18-6"></a><span class="w">      </span>Now<span class="w"> </span>listening<span class="w"> </span>on:<span class="w"> </span>http://<span class="o">[</span>::<span class="o">]</span>:80
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#microservices-6.aspnet-app-__codelineno-18-7"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">0</span><span class="o">]</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#microservices-6.aspnet-app-__codelineno-18-8"></a><span class="w">      </span>Application<span class="w"> </span>started.<span class="w"> </span>Press<span class="w"> </span>Ctrl+C<span class="w"> </span>to<span class="w"> </span>shut<span class="w"> </span>down.
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#microservices-6.aspnet-app-__codelineno-18-9"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">0</span><span class="o">]</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#microservices-6.aspnet-app-__codelineno-18-10"></a><span class="w">      </span>Hosting<span class="w"> </span>environment:<span class="w"> </span>Production
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#microservices-6.aspnet-app-__codelineno-18-11"></a>info:<span class="w"> </span>Microsoft.Hosting.Lifetime<span class="o">[</span><span class="m">0</span><span class="o">]</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#microservices-6.aspnet-app-__codelineno-18-12"></a><span class="w">      </span>Content<span class="w"> </span>root<span class="w"> </span>path:<span class="w"> </span>/app/
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#microservices-6.aspnet-app-__codelineno-18-13"></a>warn:<span class="w"> </span>Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware<span class="o">[</span><span class="m">3</span><span class="o">]</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#microservices-6.aspnet-app-__codelineno-18-14"></a><span class="w">      </span>Failed<span class="w"> </span>to<span class="w"> </span>determine<span class="w"> </span>the<span class="w"> </span>https<span class="w"> </span>port<span class="w"> </span><span class="k">for</span><span class="w"> </span>redirect.
</span></code></pre></div>
if you open the docker desktop you will notice the new container started running.</p>
<p><a href="../microservices/images/image-19.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-19.jpg" /></a></p>
<p><a href="http://localhost:8080/">http://localhost:8080/</a></p>
<p><a href="../microservices/images/image-16.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-16.jpg" /></a></p>
<p>You now have a basic ASP.NET Core Web App using the MVC pattern up and running. From here, you can continue building out your application by adding more controllers, views, and models as needed.</p>
<h2 id="microservices-6.aspnet-app-step-7-push-docker-container-to-acr">Step-7: Push docker container to ACR</h2>
<p>Publish the Docker container to the Azure Container Registry (ACR) for future deployment to Azure Kubernetes Services (AKS). This step prepares the container for deployment to the cloud environment.</p>
<p>Now we've Docker Containers ready locally for push to Container Registry so that we can use them in future labs.</p>
<p>To publish a Docker container to Azure Container Registry (ACR), you will need to have the following:</p>
<p>Create an Azure Container Registry. If you don't have one, you can create one by following the instructions in the Azure Portal or using Azure CLI.</p>
<p>Log in to your Azure Container Registry using the Docker command-line interface. You can do this by running the following command:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#microservices-6.aspnet-app-__codelineno-19-1"></a><span class="c1"># azure Login</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#microservices-6.aspnet-app-__codelineno-19-2"></a>az<span class="w"> </span>login
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#microservices-6.aspnet-app-__codelineno-19-3"></a>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#microservices-6.aspnet-app-__codelineno-19-4"></a><span class="c1"># set the azure subscription</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#microservices-6.aspnet-app-__codelineno-19-5"></a>az<span class="w"> </span>account<span class="w"> </span><span class="nb">set</span><span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;anji.keesari&quot;</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#microservices-6.aspnet-app-__codelineno-19-6"></a>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#microservices-6.aspnet-app-__codelineno-19-7"></a><span class="c1"># Log in to the container registry</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#microservices-6.aspnet-app-__codelineno-19-8"></a>az<span class="w"> </span>acr<span class="w"> </span>login<span class="w"> </span>--name<span class="w"> </span>acr1dev
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#microservices-6.aspnet-app-__codelineno-19-9"></a>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#microservices-6.aspnet-app-__codelineno-19-10"></a><span class="c1"># To get the login server address for verification</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#microservices-6.aspnet-app-__codelineno-19-11"></a>az<span class="w"> </span>acr<span class="w"> </span>list<span class="w"> </span>--resource-group<span class="w"> </span>rg-acr-dev<span class="w"> </span>--query<span class="w"> </span><span class="s2">&quot;[].{acrLoginServer:loginServer}&quot;</span><span class="w"> </span>--output<span class="w"> </span>table
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#microservices-6.aspnet-app-__codelineno-19-12"></a>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#microservices-6.aspnet-app-__codelineno-19-13"></a><span class="c1"># output should look similar to this.</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#microservices-6.aspnet-app-__codelineno-19-14"></a>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#microservices-6.aspnet-app-__codelineno-19-15"></a><span class="c1"># AcrLoginServer    </span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#microservices-6.aspnet-app-__codelineno-19-16"></a><span class="c1"># ------------------</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#microservices-6.aspnet-app-__codelineno-19-17"></a><span class="c1"># acr1dev.azurecr.io</span>
</span></code></pre></div>
<p>list all the Docker images that are available on the local system</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#microservices-6.aspnet-app-__codelineno-20-1"></a>docker<span class="w"> </span>images
</span></code></pre></div>
<p><em>output</em></p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#microservices-6.aspnet-app-__codelineno-21-1"></a>REPOSITORY<span class="w">                                                </span>TAG<span class="w">                                                                          </span>IMAGE<span class="w"> </span>ID<span class="w">       </span>CREATED<span class="w">         </span>SIZE
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#microservices-6.aspnet-app-__codelineno-21-2"></a>sample/aspnet-app<span class="w">                                         </span><span class="m">20230312</span>.1<span class="w">                                                                   </span>587f347206bc<span class="w">   </span><span class="m">8</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">   </span>216MB
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#microservices-6.aspnet-app-__codelineno-21-3"></a>.
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#microservices-6.aspnet-app-__codelineno-21-4"></a>.
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#microservices-6.aspnet-app-__codelineno-21-5"></a>.
</span></code></pre></div>
<code>Tag</code> your Docker container with the full name of your Azure Container Registry, including the repository name and the version tag. You can do this by running the following command:</p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#microservices-6.aspnet-app-__codelineno-22-1"></a>docker<span class="w"> </span>tag<span class="w"> </span>sample/aspnet-app:20230312.1<span class="w"> </span>acr1dev.azurecr.io/sample/aspnet-app:20230312.1
</span></code></pre></div>
Push your Docker container to your Azure Container Registry using the Docker command-line interface. You can do this by running the following command:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#microservices-6.aspnet-app-__codelineno-23-1"></a>docker<span class="w"> </span>push<span class="w"> </span>acr1dev.azurecr.io/sample/aspnet-app:20230312.1
</span></code></pre></div>
<p><em>Output</em></p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#microservices-6.aspnet-app-__codelineno-24-1"></a>The<span class="w"> </span>push<span class="w"> </span>refers<span class="w"> </span>to<span class="w"> </span>repository<span class="w"> </span><span class="o">[</span>acr1dev.azurecr.io/sample/aspnet-app<span class="o">]</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#microservices-6.aspnet-app-__codelineno-24-2"></a>f9c45e227c3a:<span class="w"> </span>Pushed
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#microservices-6.aspnet-app-__codelineno-24-3"></a>5f70bf18a086:<span class="w"> </span>Mounted<span class="w"> </span>from<span class="w"> </span>sample/aspnet-api
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#microservices-6.aspnet-app-__codelineno-24-4"></a>478d6dc381e4:<span class="w"> </span>Pushed
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#microservices-6.aspnet-app-__codelineno-24-5"></a>355b7bb8c23e:<span class="w"> </span>Pushed
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#microservices-6.aspnet-app-__codelineno-24-6"></a>ff13768cb51e:<span class="w"> </span>Pushed
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#microservices-6.aspnet-app-__codelineno-24-7"></a>fe674e2b138c:<span class="w"> </span>Pushed
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#microservices-6.aspnet-app-__codelineno-24-8"></a>f30d150c0152:<span class="w"> </span>Pushed
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#microservices-6.aspnet-app-__codelineno-24-9"></a>4695cdfb426a:<span class="w"> </span>Pushed
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#microservices-6.aspnet-app-__codelineno-24-10"></a><span class="m">20230312</span>.1:<span class="w"> </span>digest:<span class="w"> </span>sha256:049b736aa29e9574010dfe1fc2ef5bb44ed76d54757a8f190b967fa0f854567e<span class="w"> </span>size:<span class="w"> </span><span class="m">1995</span>
</span></code></pre></div>
1. Wait for the push to complete. Depending on the size of your Docker containers and the speed of your internet connection, this may take a few minutes.
1. Verify the newly pushed image to ACR.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#microservices-6.aspnet-app-__codelineno-25-1"></a>az<span class="w"> </span>acr<span class="w"> </span>repository<span class="w"> </span>list<span class="w"> </span>--name<span class="w"> </span>acr1dev<span class="w"> </span>--output<span class="w"> </span>table
</span></code></pre></div></p>
<p><em>Output</em></p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#microservices-6.aspnet-app-__codelineno-26-1"></a>Result
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#microservices-6.aspnet-app-__codelineno-26-2"></a>-------------------------------
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#microservices-6.aspnet-app-__codelineno-26-3"></a>mcr.microsoft.com/dotnet/aspnet
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#microservices-6.aspnet-app-__codelineno-26-4"></a>mcr.microsoft.com/dotnet/sdk
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#microservices-6.aspnet-app-__codelineno-26-5"></a>sample/aspnet-api
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#microservices-6.aspnet-app-__codelineno-26-6"></a>sample/aspnet-app
</span></code></pre></div>
<p>Show the new tags of a image in the acr</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#microservices-6.aspnet-app-__codelineno-27-1"></a>az<span class="w"> </span>acr<span class="w"> </span>repository<span class="w"> </span>show-tags<span class="w"> </span>--name<span class="w"> </span>acr1dev<span class="w"> </span>--repository<span class="w"> </span>sample/aspnet-api<span class="w"> </span>--output<span class="w"> </span>table
</span></code></pre></div>
<p><em>output</em></p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#microservices-6.aspnet-app-__codelineno-28-1"></a>Result
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#microservices-6.aspnet-app-__codelineno-28-2"></a>----------
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#microservices-6.aspnet-app-__codelineno-28-3"></a><span class="m">20230312</span>.1
</span></code></pre></div>
<p>You've successfully pushed your Docker container to Azure Container Registry. You can now use the Azure Portal or Azure CLI to manage your container and deploy them to Azure services like Azure Kubernetes Service (AKS).</p></section><section class="print-page" id="microservices-7.react-app" heading-number="3.7"><h1 id="microservices-7.react-app-chapter-7-create-your-second-website-using-reactjs">Chapter-7: Create Your Second Website using React.js</h1>
<h2 id="microservices-7.react-app-introduction">Introduction</h2>
<p>In this lab, we will create our second website using React JS, which serves as another MicroFrontend application in our Microservices architecture.</p>
<p>Our goal is to prepare a React JS application for deployment on Kubernetes. The UI applications developed in this lab will be utilized in subsequent labs, including the creation of DevOps pipelines and the deployment to Azure Kubernetes Services.</p>
<p>Let's look into the lab and begin our journey by creating a React JS application as part of the Microservices Architecture!</p>
<h2 id="microservices-7.react-app-technical-scenario">Technical Scenario</h2>
<p>As a <code>Frontend (FE)</code> developer, you have been assigned the task of developing a website or UI application using React JS technology. This website will be one of the small Website (UI) components in our MicroFrontend applications list.</p>
<p>This lab aims to provide you with hands-on experience in creating a React JS application as part of the Microservices Architecture. We will begin by utilizing an existing Git repository and proceed to create a new React JS project within it. Finally, we will containerize this website and push it to the Azure Container Registry (ACR) in preparation for deployment to Azure Kubernetes Services (AKS).</p>
<h2 id="microservices-7.react-app-objective">Objective</h2>
<p>In this exercise, our objective is to accomplish and learn the following tasks:</p>
<ul>
<li><strong>Step 1:</strong> Install Node.js and NPM</li>
<li><strong>Step-2:</strong> Create new React JS application</li>
<li><strong>Step-3:</strong> Add Dockerfiles to the React JS project</li>
<li><strong>Step-4:</strong> Docker Build locally</li>
<li><strong>Step-5:</strong> Docker Run locally</li>
<li><strong>Step-6:</strong> Publish docker container to ACR</li>
</ul>
<h2 id="microservices-7.react-app-prerequisites">Prerequisites</h2>
<ul>
<li>Git Repository</li>
<li>Clone existing Microservices repo</li>
<li>Download and install software for React Development </li>
<li>Docker desktop</li>
<li>VS Code with Docker extension</li>
<li>Azure Container Registry (ACR)</li>
</ul>
<h2 id="microservices-7.react-app-architecture-diagram">Architecture Diagram</h2>
<p>The following diagram shows the high level steps to create the website using React JS.</p>
<p><a href="../microservices/images/image-11.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-11.png" /></a></p>
<h2 id="microservices-7.react-app-step-1-install-nodejs-and-npm">Step-1: Install Node.js and NPM</h2>
<p>Before you can create a React app, you'll need to install Node.js and NPM (Node Package Manager) on your system. You can download the latest version of Node.js and NPM from the official website: <a href="https://nodejs.org/en/download/">https://nodejs.org/en/download/</a></p>
<p><strong>Manual install</strong></p>
<p>Click on the Installer as per your Operating system preference to install Node.js &amp; NPM both in your system.</p>
<p><strong>install using commands</strong></p>
<ul>
<li><strong>Windows OS</strong></li>
</ul>
<p>Install Node.js &amp; NPM using Chocolatey (choco) for windows users, assuming you already installed choco in your system, run these commands as administrator from command prompt</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#microservices-7.react-app-__codelineno-0-1"></a><span class="c1"># This command will download and install the latest version of Node.js. </span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#microservices-7.react-app-__codelineno-0-2"></a>choco<span class="w"> </span>install<span class="w"> </span>nodejs
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#microservices-7.react-app-__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#microservices-7.react-app-__codelineno-0-4"></a><span class="c1"># install a specific version</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#microservices-7.react-app-__codelineno-0-5"></a>choco<span class="w"> </span>install<span class="w"> </span>nodejs<span class="w"> </span>--version<span class="o">=</span><span class="m">14</span>.17.6
</span></code></pre></div>
<ul>
<li><strong>Mac OS</strong></li>
</ul>
<p>Install Node.js &amp; NPM using Homebrew for Mac users, assuming you already installed Homebrew in your system:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#microservices-7.react-app-__codelineno-1-1"></a><span class="c1"># install latest version</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#microservices-7.react-app-__codelineno-1-2"></a>brew<span class="w"> </span>install<span class="w"> </span>node
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#microservices-7.react-app-__codelineno-1-3"></a><span class="c1"># install a specific version</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#microservices-7.react-app-__codelineno-1-4"></a>brew<span class="w"> </span>install<span class="w"> </span>node@14
</span></code></pre></div>
<p>verify that Node.js is installed correctly</p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#microservices-7.react-app-__codelineno-2-1"></a>node<span class="w"> </span>--version
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#microservices-7.react-app-__codelineno-2-2"></a>npm<span class="w"> </span>version
</span></code></pre></div>
output</p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#microservices-7.react-app-__codelineno-3-1"></a>v19.8.1
</span></code></pre></div>
verify that npm version is installed correctly</p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#microservices-7.react-app-__codelineno-4-1"></a>npm<span class="w"> </span>version
</span></code></pre></div>
output
<div class="language-sh highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#microservices-7.react-app-__codelineno-5-1"></a><span class="o">{</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#microservices-7.react-app-__codelineno-5-2"></a><span class="w">  </span>npm:<span class="w"> </span><span class="s1">&#39;9.5.1&#39;</span>,
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#microservices-7.react-app-__codelineno-5-3"></a><span class="w">  </span>node:<span class="w"> </span><span class="s1">&#39;19.8.1&#39;</span>,
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#microservices-7.react-app-__codelineno-5-4"></a><span class="w">  </span>acorn:<span class="w"> </span><span class="s1">&#39;8.8.2&#39;</span>,
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#microservices-7.react-app-__codelineno-5-5"></a><span class="w">  </span>ada:<span class="w"> </span><span class="s1">&#39;1.0.4&#39;</span>,
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#microservices-7.react-app-__codelineno-5-6"></a><span class="w">  </span>ares:<span class="w"> </span><span class="s1">&#39;1.19.0&#39;</span>,
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#microservices-7.react-app-__codelineno-5-7"></a><span class="w">  </span>brotli:<span class="w"> </span><span class="s1">&#39;1.0.9&#39;</span>,
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#microservices-7.react-app-__codelineno-5-8"></a><span class="w">  </span>cldr:<span class="w"> </span><span class="s1">&#39;42.0&#39;</span>,
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#microservices-7.react-app-__codelineno-5-9"></a><span class="w">  </span>icu:<span class="w"> </span><span class="s1">&#39;72.1&#39;</span>,
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#microservices-7.react-app-__codelineno-5-10"></a><span class="w">  </span>llhttp:<span class="w"> </span><span class="s1">&#39;8.1.0&#39;</span>,
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#microservices-7.react-app-__codelineno-5-11"></a><span class="w">  </span>modules:<span class="w"> </span><span class="s1">&#39;111&#39;</span>,
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#microservices-7.react-app-__codelineno-5-12"></a><span class="w">  </span>napi:<span class="w"> </span><span class="s1">&#39;8&#39;</span>,
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#microservices-7.react-app-__codelineno-5-13"></a><span class="w">  </span>nghttp2:<span class="w"> </span><span class="s1">&#39;1.52.0&#39;</span>,
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#microservices-7.react-app-__codelineno-5-14"></a><span class="w">  </span>nghttp3:<span class="w"> </span><span class="s1">&#39;0.7.0&#39;</span>,
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#microservices-7.react-app-__codelineno-5-15"></a><span class="w">  </span>ngtcp2:<span class="w"> </span><span class="s1">&#39;0.8.1&#39;</span>,
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#microservices-7.react-app-__codelineno-5-16"></a><span class="w">  </span>openssl:<span class="w"> </span><span class="s1">&#39;3.0.8+quic&#39;</span>,
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#microservices-7.react-app-__codelineno-5-17"></a><span class="w">  </span>simdutf:<span class="w"> </span><span class="s1">&#39;3.2.2&#39;</span>,
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#microservices-7.react-app-__codelineno-5-18"></a><span class="w">  </span>tz:<span class="w"> </span><span class="s1">&#39;2022g&#39;</span>,
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#microservices-7.react-app-__codelineno-5-19"></a><span class="w">  </span>undici:<span class="w"> </span><span class="s1">&#39;5.21.0&#39;</span>,
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#microservices-7.react-app-__codelineno-5-20"></a><span class="w">  </span>unicode:<span class="w"> </span><span class="s1">&#39;15.0&#39;</span>,
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#microservices-7.react-app-__codelineno-5-21"></a><span class="w">  </span>uv:<span class="w"> </span><span class="s1">&#39;1.44.2&#39;</span>,
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#microservices-7.react-app-__codelineno-5-22"></a><span class="w">  </span>uvwasi:<span class="w"> </span><span class="s1">&#39;0.0.16&#39;</span>,
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#microservices-7.react-app-__codelineno-5-23"></a><span class="w">  </span>v8:<span class="w"> </span><span class="s1">&#39;10.8.168.25-node.12&#39;</span>,
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#microservices-7.react-app-__codelineno-5-24"></a><span class="w">  </span>zlib:<span class="w"> </span><span class="s1">&#39;1.2.13&#39;</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#microservices-7.react-app-__codelineno-5-25"></a><span class="o">}</span>
</span></code></pre></div></p>
<h2 id="microservices-7.react-app-step-2-create-a-new-react-js-application">Step-2: Create a new React JS application</h2>
<p>Once you have Node.js installed, you can create a new React JS application using the <code>create-react-app</code> command. Open a terminal window and run the following command:</p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#microservices-7.react-app-__codelineno-6-1"></a>npx<span class="w"> </span>create-react-app<span class="w"> </span>react-app
</span></code></pre></div>
Wait for few mins for completing the installation.</p>
<p><a href="../microservices/images/image-20.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-20.jpg" /></a></p>
<p>This command will create a new React JS application with all the necessary files and directories in a folder named <code>react-app</code> in your current directory.</p>
<p>output</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#microservices-7.react-app-__codelineno-7-1"></a>Need<span class="w"> </span>to<span class="w"> </span>install<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>packages:
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#microservices-7.react-app-__codelineno-7-2"></a><span class="w">  </span>create-react-app@5.0.1
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#microservices-7.react-app-__codelineno-7-3"></a>Ok<span class="w"> </span>to<span class="w"> </span>proceed?<span class="w"> </span><span class="o">(</span>y<span class="o">)</span><span class="w"> </span>Y
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#microservices-7.react-app-__codelineno-7-4"></a>npm<span class="w"> </span>WARN<span class="w"> </span>deprecated<span class="w"> </span>tar@2.2.2:<span class="w"> </span>This<span class="w"> </span>version<span class="w"> </span>of<span class="w"> </span>tar<span class="w"> </span>is<span class="w"> </span>no<span class="w"> </span>longer<span class="w"> </span>supported,<span class="w"> </span>and<span class="w"> </span>will<span class="w"> </span>not<span class="w"> </span>receive<span class="w"> </span>security<span class="w"> </span>updates.<span class="w"> </span>Please<span class="w"> </span>upgrade<span class="w"> </span>asap.
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#microservices-7.react-app-__codelineno-7-5"></a>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#microservices-7.react-app-__codelineno-7-6"></a>Creating<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>React<span class="w"> </span>app<span class="w"> </span><span class="k">in</span><span class="w"> </span>C:<span class="se">\S</span>ource<span class="se">\R</span>epos<span class="se">\M</span>icroservices<span class="se">\r</span>eact-app.
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#microservices-7.react-app-__codelineno-7-7"></a>Installing<span class="w"> </span>packages.<span class="w"> </span>This<span class="w"> </span>might<span class="w"> </span>take<span class="w"> </span>a<span class="w"> </span>couple<span class="w"> </span>of<span class="w"> </span>minutes.
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#microservices-7.react-app-__codelineno-7-8"></a>Installing<span class="w"> </span>react,<span class="w"> </span>react-dom,<span class="w"> </span>and<span class="w"> </span>react-scripts<span class="w"> </span>with<span class="w"> </span>cra-template...
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#microservices-7.react-app-__codelineno-7-9"></a>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#microservices-7.react-app-__codelineno-7-10"></a>added<span class="w"> </span><span class="m">1419</span><span class="w"> </span>packages<span class="w"> </span><span class="k">in</span><span class="w"> </span>2m
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#microservices-7.react-app-__codelineno-7-11"></a>.
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#microservices-7.react-app-__codelineno-7-12"></a>.
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#microservices-7.react-app-__codelineno-7-13"></a>.
</span></code></pre></div>
<p>If you closely look at the output produced by installer, it has some details to get start by React JS application.</p>
<!-- Here is the list of files created by the installer. -->

<p><strong>Run the Application</strong></p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#microservices-7.react-app-__codelineno-8-1"></a><span class="nb">cd</span><span class="w"> </span>react-app
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#microservices-7.react-app-__codelineno-8-2"></a>npm<span class="w"> </span>start
</span></code></pre></div>
<p>output</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#microservices-7.react-app-__codelineno-9-1"></a>Compiled<span class="w"> </span>successfully!
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#microservices-7.react-app-__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#microservices-7.react-app-__codelineno-9-3"></a>You<span class="w"> </span>can<span class="w"> </span>now<span class="w"> </span>view<span class="w"> </span>react-app<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>browser.
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#microservices-7.react-app-__codelineno-9-4"></a>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#microservices-7.react-app-__codelineno-9-5"></a><span class="w">  </span>Local:<span class="w">            </span>http://localhost:3000
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#microservices-7.react-app-__codelineno-9-6"></a><span class="w">  </span>On<span class="w"> </span>Your<span class="w"> </span>Network:<span class="w">  </span>http://172.21.128.1:3000
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#microservices-7.react-app-__codelineno-9-7"></a>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#microservices-7.react-app-__codelineno-9-8"></a>Note<span class="w"> </span>that<span class="w"> </span>the<span class="w"> </span>development<span class="w"> </span>build<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>optimized.
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#microservices-7.react-app-__codelineno-9-9"></a>To<span class="w"> </span>create<span class="w"> </span>a<span class="w"> </span>production<span class="w"> </span>build,<span class="w"> </span>use<span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>build.
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#microservices-7.react-app-__codelineno-9-10"></a>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#microservices-7.react-app-__codelineno-9-11"></a>webpack<span class="w"> </span>compiled<span class="w"> </span>successfully
</span></code></pre></div>
<p><a href="../microservices/images/image-21.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-21.jpg" /></a></p>
<h2 id="microservices-7.react-app-step-3-add-dockerfiles-to-the-mvc-project">Step-3: Add Dockerfiles to the MVC project</h2>
<p>Create a Dockerfile in the root directory of your project and copy following code. Dockerfile will provide instructions for building a container image of our React JS Website.</p>
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#microservices-7.react-app-__codelineno-10-1"></a><span class="c"># pull official base image</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#microservices-7.react-app-__codelineno-10-2"></a><span class="k">FROM</span><span class="w"> </span><span class="s">node:13.12.0-alpine</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#microservices-7.react-app-__codelineno-10-3"></a>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#microservices-7.react-app-__codelineno-10-4"></a><span class="c"># set working directory</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#microservices-7.react-app-__codelineno-10-5"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#microservices-7.react-app-__codelineno-10-6"></a>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#microservices-7.react-app-__codelineno-10-7"></a><span class="c"># add `/app/node_modules/.bin` to $PATH</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#microservices-7.react-app-__codelineno-10-8"></a><span class="k">ENV</span><span class="w"> </span>PATH<span class="w"> </span>/app/node_modules/.bin:<span class="nv">$PATH</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#microservices-7.react-app-__codelineno-10-9"></a>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#microservices-7.react-app-__codelineno-10-10"></a><span class="c"># install app dependencies</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#microservices-7.react-app-__codelineno-10-11"></a><span class="k">COPY</span><span class="w"> </span>package.json<span class="w"> </span>./
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#microservices-7.react-app-__codelineno-10-12"></a><span class="k">COPY</span><span class="w"> </span>package-lock.json<span class="w"> </span>./
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#microservices-7.react-app-__codelineno-10-13"></a><span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>install<span class="w"> </span>--silent
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#microservices-7.react-app-__codelineno-10-14"></a><span class="k">RUN</span><span class="w"> </span>npm<span class="w"> </span>install<span class="w"> </span>react-scripts@3.4.1<span class="w"> </span>-g<span class="w"> </span>--silent
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#microservices-7.react-app-__codelineno-10-15"></a>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#microservices-7.react-app-__codelineno-10-16"></a><span class="c"># add app</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#microservices-7.react-app-__codelineno-10-17"></a><span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>./
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#microservices-7.react-app-__codelineno-10-18"></a>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#microservices-7.react-app-__codelineno-10-19"></a><span class="c"># start app</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#microservices-7.react-app-__codelineno-10-20"></a><span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;npm&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;start&quot;</span><span class="p">]</span>
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Read inline comments of the Dockerfile for understanding the Dockerfile instructions</p>
</div>
<h2 id="microservices-7.react-app-step-4-docker-build-locally">Step-4: Docker Build locally</h2>
<p>We will build the Docker container locally using the Dockerfiles and ensure that the containerized application functions as expected.</p>
<p>The <code>docker build</code> command is used to build Docker images from a Dockerfile.  </p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#microservices-7.react-app-__codelineno-11-1"></a>docker build -t sample/react-app:20230322.1 .
</span></code></pre></div>
<p>output</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#microservices-7.react-app-__codelineno-12-1"></a><span class="o">=</span>&gt;<span class="w"> </span><span class="o">[</span><span class="m">6</span>/7<span class="o">]</span><span class="w"> </span>RUN<span class="w"> </span>npm<span class="w"> </span>install<span class="w"> </span>react-scripts@3.4.1<span class="w"> </span>-g
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#microservices-7.react-app-__codelineno-12-2"></a><span class="o">=</span>&gt;<span class="w"> </span><span class="o">[</span><span class="m">7</span>/7<span class="o">]</span><span class="w"> </span>COPY<span class="w"> </span>.
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#microservices-7.react-app-__codelineno-12-3"></a><span class="o">=</span>&gt;<span class="w"> </span>exporting<span class="w"> </span>to<span class="w"> </span><span class="nv">image</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#microservices-7.react-app-__codelineno-12-4"></a><span class="o">=</span>&gt;<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>exporting<span class="w"> </span><span class="nv">layers</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#microservices-7.react-app-__codelineno-12-5"></a><span class="o">=</span>&gt;<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>writing<span class="w"> </span>image<span class="w"> </span>sha256:552d7e73a9fbecf6f51397becc9af1b69df05429b3731513f53f6e89dd8a7cab<span class="w"> </span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#microservices-7.react-app-__codelineno-12-6"></a><span class="o">=</span>&gt;<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>naming<span class="w"> </span>to<span class="w"> </span>docker.io/sample/react-app:20230322.
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#microservices-7.react-app-__codelineno-12-7"></a>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#microservices-7.react-app-__codelineno-12-8"></a>Use<span class="w"> </span><span class="s1">&#39;docker scan&#39;</span><span class="w"> </span>to<span class="w"> </span>run<span class="w"> </span>Snyk<span class="w"> </span>tests<span class="w"> </span>against<span class="w"> </span>images<span class="w"> </span>to<span class="w"> </span>find<span class="w"> </span>vulnerabilities<span class="w"> </span>and<span class="w"> </span>learn<span class="w"> </span>how<span class="w"> </span>to<span class="w"> </span>fix<span class="w"> </span>them
</span></code></pre></div>
<p>When you run the <code>docker build</code> command, Docker looks for a Dockerfile in the specified directory (PATH) and reads the instructions in the file to build a new image. </p>
<p>The Dockerfile contains a series of instructions that define how to build the image, such as copying files, running commands, and setting environment variables. </p>
<h2 id="microservices-7.react-app-step-5-docker-run-locally">Step-5: Docker Run locally</h2>
<p>Run the Docker container locally to verify that the application functions correctly within a containerized environment. This step ensures that the containerized application operates as expected on your local machine.</p>
<p>Run the <code>docker run</code> command to start a container based on the image:</p>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#microservices-7.react-app-__codelineno-13-1"></a>docker run --rm -p 3000:3000 sample/react-app:20230322.1
</span></code></pre></div>
output</p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#microservices-7.react-app-__codelineno-14-1"></a>Compiled<span class="w"> </span>successfully!
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#microservices-7.react-app-__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#microservices-7.react-app-__codelineno-14-3"></a>You<span class="w"> </span>can<span class="w"> </span>now<span class="w"> </span>view<span class="w"> </span>react-app<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>browser.
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#microservices-7.react-app-__codelineno-14-4"></a>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#microservices-7.react-app-__codelineno-14-5"></a><span class="w">  </span>Local:<span class="w">            </span>http://localhost:3000
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#microservices-7.react-app-__codelineno-14-6"></a><span class="w">  </span>On<span class="w"> </span>Your<span class="w"> </span>Network:<span class="w">  </span>http://172.17.0.2:3000
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#microservices-7.react-app-__codelineno-14-7"></a>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#microservices-7.react-app-__codelineno-14-8"></a>Note<span class="w"> </span>that<span class="w"> </span>the<span class="w"> </span>development<span class="w"> </span>build<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>optimized.
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#microservices-7.react-app-__codelineno-14-9"></a>To<span class="w"> </span>create<span class="w"> </span>a<span class="w"> </span>production<span class="w"> </span>build,<span class="w"> </span>use<span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>build.
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#microservices-7.react-app-__codelineno-14-10"></a>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#microservices-7.react-app-__codelineno-14-11"></a>webpack<span class="w"> </span>compiled<span class="w"> </span>successfully
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#microservices-7.react-app-__codelineno-14-12"></a>Compiling...
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#microservices-7.react-app-__codelineno-14-13"></a>Compiled<span class="w"> </span>successfully!
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#microservices-7.react-app-__codelineno-14-14"></a>webpack<span class="w"> </span>compiled<span class="w"> </span>successfully
</span></code></pre></div>
if you open the docker desktop you will notice the new image &amp; container started running.</p>
<p><strong>Image</strong></p>
<p><a href="../microservices/images/image-22.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-22.jpg" /></a></p>
<p><strong>Container</strong></p>
<p><a href="../microservices/images/image-23.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-23.jpg" /></a></p>
<p>This will start the ReactJS application in the Docker container and map the container's port 3000 to your local machine's port 3000. </p>
<p>Your ReactJS application is now running inside a Docker container.</p>
<p>Open your favorite browser and enter the following URL to see the running application in port 3000</p>
<p><a href="http://localhost:3000/">http://localhost:3000/</a></p>
<p><a href="../microservices/images/image-21.jpg" target="_blank"><img alt="Alt text" src="../microservices/images/image-21.jpg" /></a></p>
<p>You now have a basic React JS application up and running. From here, you can continue building out your application by adding more and more code as per your requirements.</p>
<h2 id="microservices-7.react-app-step-6-push-docker-container-to-acr">Step-6: Push docker container to ACR</h2>
<p>Now we've Docker Containers ready locally for push to Container Registry so that we can use them in future deployment to Azure Kubernetes Services (AKS). This step prepares the container for deployment to the cloud environment.</p>
<p>To publish a Docker container to Azure Container Registry (ACR), you will need to have the following:</p>
<ol>
<li>Create an Azure Container Registry. If you don't have one, you can create one by following the instructions in the Azure Portal or using Azure CLI.</li>
<li>Log in to your Azure Container Registry using the Docker command-line interface. You can do this by running the following command:
<div class="language-sh highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#microservices-7.react-app-__codelineno-15-1"></a><span class="c1"># azure Login</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#microservices-7.react-app-__codelineno-15-2"></a>az<span class="w"> </span>login
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#microservices-7.react-app-__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#microservices-7.react-app-__codelineno-15-4"></a><span class="c1"># set the azure subscription</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#microservices-7.react-app-__codelineno-15-5"></a>az<span class="w"> </span>account<span class="w"> </span><span class="nb">set</span><span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;anji.keesari&quot;</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#microservices-7.react-app-__codelineno-15-6"></a>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#microservices-7.react-app-__codelineno-15-7"></a><span class="c1"># Log in to the container registry</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#microservices-7.react-app-__codelineno-15-8"></a>az<span class="w"> </span>acr<span class="w"> </span>login<span class="w"> </span>--name<span class="w"> </span>acr1dev
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#microservices-7.react-app-__codelineno-15-9"></a><span class="c1"># Login Succeeded</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#microservices-7.react-app-__codelineno-15-10"></a><span class="c1"># To get the login server address for verification</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#microservices-7.react-app-__codelineno-15-11"></a>az<span class="w"> </span>acr<span class="w"> </span>list<span class="w"> </span>--resource-group<span class="w"> </span>rg-acr-dev<span class="w"> </span>--query<span class="w"> </span><span class="s2">&quot;[].{acrLoginServer:loginServer}&quot;</span><span class="w"> </span>--output<span class="w"> </span>table
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#microservices-7.react-app-__codelineno-15-12"></a>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#microservices-7.react-app-__codelineno-15-13"></a><span class="c1"># output should look similar to this.</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#microservices-7.react-app-__codelineno-15-14"></a>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#microservices-7.react-app-__codelineno-15-15"></a><span class="c1"># AcrLoginServer    </span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#microservices-7.react-app-__codelineno-15-16"></a><span class="c1"># ------------------</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#microservices-7.react-app-__codelineno-15-17"></a><span class="c1"># acr1dev.azurecr.io</span>
</span></code></pre></div>
list all the Docker images that are available on the local system
<div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#microservices-7.react-app-__codelineno-16-1"></a>docker images
</span></code></pre></div>
output
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#microservices-7.react-app-__codelineno-17-1"></a>REPOSITORY                                                TAG                                                                          IMAGE ID       CREATED         SIZE
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#microservices-7.react-app-__codelineno-17-2"></a>sample/aspnet-app                                         20230312.1                                                                   587f347206bc   8 minutes ago   216MB
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#microservices-7.react-app-__codelineno-17-3"></a>.
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#microservices-7.react-app-__codelineno-17-4"></a>.
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#microservices-7.react-app-__codelineno-17-5"></a>.
</span></code></pre></div></li>
<li><code>Tag</code> your Docker container image with the full name of your Azure Container Registry, including the repository name and the version tag. You can do this by running the following command:
<div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#microservices-7.react-app-__codelineno-18-1"></a>docker tag sample/react-app:20230322.1 acr1dev.azurecr.io/sample/react-app:20230322.1
</span></code></pre></div></li>
<li>Push your Docker container image to your Azure Container Registry using the Docker command-line interface. You can do this by running the following command:
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#microservices-7.react-app-__codelineno-19-1"></a>docker push acr1dev.azurecr.io/sample/react-app:20230322.1
</span></code></pre></div>
Output
<div class="language-sh highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#microservices-7.react-app-__codelineno-20-1"></a>The<span class="w"> </span>push<span class="w"> </span>refers<span class="w"> </span>to<span class="w"> </span>repository<span class="w"> </span><span class="o">[</span>acr1dev.azurecr.io/sample/react-app<span class="o">]</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#microservices-7.react-app-__codelineno-20-2"></a>649a035a1734:<span class="w"> </span>Pushed
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#microservices-7.react-app-__codelineno-20-3"></a>4061bd2dd536:<span class="w"> </span>Pushed
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#microservices-7.react-app-__codelineno-20-4"></a>c0257b3030b0:<span class="w"> </span>Pushed
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#microservices-7.react-app-__codelineno-20-5"></a>912a3b0fc587:<span class="w"> </span>Pushed
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#microservices-7.react-app-__codelineno-20-6"></a>a36186d93e25:<span class="w"> </span>Pushed
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#microservices-7.react-app-__codelineno-20-7"></a>a3d997b065bc:<span class="w"> </span>Pushed
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#microservices-7.react-app-__codelineno-20-8"></a>65d358b7de11:<span class="w"> </span>Pushed
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#microservices-7.react-app-__codelineno-20-9"></a>f97384e8ccbc:<span class="w"> </span>Pushed
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#microservices-7.react-app-__codelineno-20-10"></a>d56e5e720148:<span class="w"> </span>Pushed
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#microservices-7.react-app-__codelineno-20-11"></a>beee9f30bc1f:<span class="w"> </span>Pushed
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#microservices-7.react-app-__codelineno-20-12"></a><span class="m">20230322</span>.1:<span class="w"> </span>digest:<span class="w"> </span>sha256:73f0669d18c6cae79beb81edc8c523191710f9ec4781d590884b46326f9ad6f9<span class="w"> </span>size:<span class="w"> </span><span class="m">2419</span>
</span></code></pre></div></li>
<li>Wait for the push to complete. Depending on the size of your Docker container image and the speed of your internet connection, this may take a few minutes.</li>
<li>Verify the newly pushed image to ACR.
<div class="language-sh highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#microservices-7.react-app-__codelineno-21-1"></a>az<span class="w"> </span>acr<span class="w"> </span>repository<span class="w"> </span>list<span class="w"> </span>--name<span class="w"> </span>acr1dev<span class="w"> </span>--output<span class="w"> </span>table
</span></code></pre></div>
Output
<div class="language-text highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#microservices-7.react-app-__codelineno-22-1"></a>Result
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#microservices-7.react-app-__codelineno-22-2"></a>-------------------------------
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#microservices-7.react-app-__codelineno-22-3"></a>mcr.microsoft.com/dotnet/aspnet
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#microservices-7.react-app-__codelineno-22-4"></a>mcr.microsoft.com/dotnet/sdk
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#microservices-7.react-app-__codelineno-22-5"></a>sample/aspnet-api
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#microservices-7.react-app-__codelineno-22-6"></a>sample/aspnet-app
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#microservices-7.react-app-__codelineno-22-7"></a>sample/react-app
</span></code></pre></div></li>
<li>Show the new tags of a image in the acr
<div class="language-text highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#microservices-7.react-app-__codelineno-23-1"></a>az acr repository show-tags --name acr1dev --repository sample/react-app --output table
</span></code></pre></div>
output
<div class="language-text highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#microservices-7.react-app-__codelineno-24-1"></a>Result
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#microservices-7.react-app-__codelineno-24-2"></a>----------
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#microservices-7.react-app-__codelineno-24-3"></a>20230322.1
</span></code></pre></div></li>
</ol>
<p>You've successfully pushed your Docker container image to Azure Container Registry. You can now use the Azure Portal or Azure CLI to manage your container images and deploy them to Azure services like Azure Kubernetes Service (AKS).</p></section><section class="print-page" id="microservices-8.sqlserver-db" heading-number="3.8"><h1 id="microservices-8.sqlserver-db-chapter-8-setting-up-sql-server-database-in-a-docker-container">Chapter-8: Setting up SQL Server database in a Docker Container</h1>
<h2 id="microservices-8.sqlserver-db-introduction">Introduction</h2>
<p>Running <code>SQL Server</code> in a Docker container is best suited for development, testing, learning, or quick experimentation scenarios where you need a lightweight, isolated environment that can be spun up or torn down easily. It works well offline, and your can run it without any cost, and is perfect for local development workflows. However, it's not ideal for production use. for production environments you can use Azure SQL Database which is a fully managed platform-as-a-service (PaaS) offering that's optimized for production workloads. It provides built-in high availability, automated backups, scalability, and security, making it ideal for applications that need global reach, minimal maintenance, and enterprise-grade reliability.</p>
<p>In this lab, I will guide you through the process of creating Docker container for SQL Server database and run SQL Server database in the docker, and finally accessing the SQL Server database using SQL Server Management Studio (<code>SSMS</code>) and <code>Azure Data Studio</code> tools.</p>
<!-- 
## Benefits of SQL Server Container

Creating a Docker container for SQL Server database offers several benefits:

- **Portability**: Docker containers encapsulate the SQL Server database and its dependencies, making it easy to deploy and run the database on any system that supports Docker, regardless of the underlying operating system or hardware. This portability ensures consistency in development, testing, and production environments.

- **Isolation**: Docker containers provide a lightweight and isolated environment for running applications, including databases like SQL Server. Each container operates independently of other containers and the host system, reducing potential conflicts and dependencies.

3. **Consistency**: Docker containers use a declarative approach to define the environment and dependencies required for running the SQL Server database. This ensures consistency across different environments, such as development, testing, and production, reducing the risk of configuration errors and deployment issues.

4. **Scalability**: Docker containers allow for easy scaling of SQL Server databases by spinning up multiple instances of the containerized database as needed. Container orchestration tools like Kubernetes can automate the deployment and management of containerized databases to meet varying workload demands.

5. **Ease of Deployment**: Docker containers simplify the deployment process for SQL Server databases by packaging the database and its dependencies into a single unit that can be easily distributed and deployed across different environments. This streamlines the deployment workflow and reduces the time and effort required for provisioning and configuring databases. -->

<h2 id="microservices-8.sqlserver-db-objective">Objective</h2>
<p>The objective is to establish a local development environment for the SQL Server database. To accomplish this, you will create a Dockerfile file, run them locally. All of these tasks we are doing here will be useful in later chapters when deploying to the Azure Kubernetes Service (AKS).</p>
<p>In this exercise, our objective is to accomplish and learn the following tasks:</p>
<ul>
<li><strong>Step-1:</strong> Setup Git Repository for SQL Server database.</li>
<li><strong>Step-2:</strong> Create Folder Structure for SQL Server database.</li>
<li><strong>Step-3:</strong> Add Dockerfiles to the Database Project</li>
<li><strong>Step-3.1:</strong> Docker Build Locally</li>
<li><strong>Step-3.2:</strong> Docker Run Locally</li>
</ul>
<!-- - **Step-4:** Create Docker Compose file
   - **Step-4.1:** Build SQL Server database locally.
   - **Step-4.2:** Run SQL Server database Container locally. -->
<ul>
<li><strong>Step-4:</strong> Test the SQL Server database connection using SSMS</li>
<li><strong>Step-5:</strong> Test the SQL Server database connection using Azure Data Studio</li>
<li><strong>Step-6:</strong> Push Docker Container to ACR</li>
</ul>
<p>By the end of this lab, you will have a SQL Server database running in a Docker container, managed through Azure DevOps, and ready for use in your development and production environments.</p>
<h2 id="microservices-8.sqlserver-db-prerequisites">Prerequisites</h2>
<p>Before starting this lab, ensure you have the following prerequisites in place:</p>
<ul>
<li>Docker Desktop: - <a href="https://docs.docker.com/get-docker/" target="_blank">Docker Downloads</a>.</li>
<li>Docker compose installed</li>
<li>SQL Server Management Studio installed - this will allow you to manage the SQL Server databases</li>
<li>Azure Data Studio installed - this will allow you to connect to SQL server databases</li>
<li>Basic understanding of Docker and SQL Server.</li>
<li>Access to an Azure Container Registry (ACR).</li>
</ul>
<p>Verify the docker installation by running following commands:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#microservices-8.sqlserver-db-__codelineno-0-1"></a>docker<span class="w"> </span>version
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#microservices-8.sqlserver-db-__codelineno-0-2"></a><span class="c1"># or</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#microservices-8.sqlserver-db-__codelineno-0-3"></a>docker<span class="w"> </span>--version
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#microservices-8.sqlserver-db-__codelineno-0-4"></a><span class="c1"># or</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#microservices-8.sqlserver-db-__codelineno-0-5"></a>docker<span class="w"> </span>-v
</span></code></pre></div>
<p>Verify the docker compose by running following commands:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#microservices-8.sqlserver-db-__codelineno-1-1"></a>docker-compose<span class="w"> </span>version
</span></code></pre></div>
<h2 id="microservices-8.sqlserver-db-architecture-diagram">Architecture Diagram</h2>
<p>The following diagram shows the high level steps to create docker container for SQL Server database.</p>
<p><a href="../microservices/images/sqlserver/image-8.png" target="_blank"><img alt="Alt text" src="../microservices/images/sqlserver/image-8.png" /></a></p>
<h2 id="microservices-8.sqlserver-db-step-1-setup-git-repository-for-sql-server-database">Step-1: Setup Git Repository for SQL Server database</h2>
<p>Setting up a Git repository for your SQL Server database project allows you to manage your code effectively, work in teams, and track the changes of your database codebase.</p>
<ul>
<li>Create a new project in Azure DevOps for your database-related work.</li>
<li>Create a repository within the project to store your database scripts and Dockerfiles.</li>
</ul>
<p>For example to clone an existing repository, run the following command:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#microservices-8.sqlserver-db-__codelineno-2-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://keesari.visualstudio.com/Microservices/_git/microservices
</span></code></pre></div>
<h2 id="microservices-8.sqlserver-db-step-2-create-folder-structure-for-sql-server-database">Step-2: Create Folder Structure for SQL Server database</h2>
<p>In this step, we'll create a dedicated project or folder for our SQL Server database</p>
<p><em>Create a new database project:</em></p>
<p>Inside our Git repository, create a new directory or folder specifically for your SQL Server database. This folder will contain all the necessary files for SQL Server database, including databaseschema scripts, sample data scripts, docker compose &amp; Dockerfile and other sql files.</p>
<p>Here's a suggestion for a folder structure for a SQL Server database project:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#microservices-8.sqlserver-db-__codelineno-3-1"></a>your-project-name/
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#microservices-8.sqlserver-db-__codelineno-3-2"></a>│
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#microservices-8.sqlserver-db-__codelineno-3-3"></a>├──<span class="w"> </span>sql/
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#microservices-8.sqlserver-db-__codelineno-3-4"></a>│<span class="w">   </span>├──<span class="w"> </span>scripts/
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#microservices-8.sqlserver-db-__codelineno-3-5"></a>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>schema/
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#microservices-8.sqlserver-db-__codelineno-3-6"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>tables/
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#microservices-8.sqlserver-db-__codelineno-3-7"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>table1.sql
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#microservices-8.sqlserver-db-__codelineno-3-8"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>table2.sql
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#microservices-8.sqlserver-db-__codelineno-3-9"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>...
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#microservices-8.sqlserver-db-__codelineno-3-10"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>views/
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#microservices-8.sqlserver-db-__codelineno-3-11"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>view1.sql
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#microservices-8.sqlserver-db-__codelineno-3-12"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>view2.sql
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#microservices-8.sqlserver-db-__codelineno-3-13"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>...
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#microservices-8.sqlserver-db-__codelineno-3-14"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>functions/
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#microservices-8.sqlserver-db-__codelineno-3-15"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>function1.sql
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#microservices-8.sqlserver-db-__codelineno-3-16"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>function2.sql
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#microservices-8.sqlserver-db-__codelineno-3-17"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>...
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#microservices-8.sqlserver-db-__codelineno-3-18"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>procedures/
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#microservices-8.sqlserver-db-__codelineno-3-19"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">       </span>├──<span class="w"> </span>procedure1.sql
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#microservices-8.sqlserver-db-__codelineno-3-20"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">       </span>├──<span class="w"> </span>procedure2.sql
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#microservices-8.sqlserver-db-__codelineno-3-21"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">       </span>└──<span class="w"> </span>...
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#microservices-8.sqlserver-db-__codelineno-3-22"></a>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>data/
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#microservices-8.sqlserver-db-__codelineno-3-23"></a>│<span class="w">   </span>│<span class="w">       </span>├──<span class="w"> </span>seed_data.sql
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#microservices-8.sqlserver-db-__codelineno-3-24"></a>│<span class="w">   </span>│<span class="w">       </span>└──<span class="w"> </span>...
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#microservices-8.sqlserver-db-__codelineno-3-25"></a>│<span class="w">   </span>└──<span class="w"> </span>migrations/
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#microservices-8.sqlserver-db-__codelineno-3-26"></a>│<span class="w">       </span>├──<span class="w"> </span>version1/
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#microservices-8.sqlserver-db-__codelineno-3-27"></a>│<span class="w">       </span>│<span class="w">   </span>├──<span class="w"> </span>up.sql
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#microservices-8.sqlserver-db-__codelineno-3-28"></a>│<span class="w">       </span>│<span class="w">   </span>└──<span class="w"> </span>down.sql
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#microservices-8.sqlserver-db-__codelineno-3-29"></a>│<span class="w">       </span>├──<span class="w"> </span>version2/
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#microservices-8.sqlserver-db-__codelineno-3-30"></a>│<span class="w">       </span>│<span class="w">   </span>├──<span class="w"> </span>up.sql
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#microservices-8.sqlserver-db-__codelineno-3-31"></a>│<span class="w">       </span>│<span class="w">   </span>└──<span class="w"> </span>down.sql
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#microservices-8.sqlserver-db-__codelineno-3-32"></a>│<span class="w">       </span>└──<span class="w"> </span>...
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#microservices-8.sqlserver-db-__codelineno-3-33"></a>│
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#microservices-8.sqlserver-db-__codelineno-3-34"></a>├──<span class="w"> </span>Dockerfile
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#microservices-8.sqlserver-db-__codelineno-3-35"></a>└──<span class="w"> </span>README.md
</span></code></pre></div>
<p>Explanation:</p>
<ul>
<li><code>sql/</code>: This folder contains all SQL-related files for your project.</li>
<li><code>scripts/</code>: Contains scripts for creating database objects like tables, views, functions, and stored procedures.<ul>
<li><code>schema/</code>: Contains subfolders for different types of database objects.</li>
<li><code>tables/</code>, <code>views/</code>, <code>functions/</code>, <code>procedures/</code>: Each of these folders contains SQL scripts for the respective database objects.</li>
</ul>
</li>
<li><code>data/</code>: Contains data scripts such as seed data.</li>
<li><code>migrations/</code>: Contains SQL migration scripts for managing database schema changes over time. Each migration version should have an <code>up.sql</code> script for applying the migration and a <code>down.sql</code> script for reverting it.</li>
<li><code>Dockerfile</code>: The Dockerfile for building a Docker image for your SQL Server database.</li>
<li><code>README.md</code>: Documentation for your project.</li>
</ul>
<p>You can adjust this structure based on the specific needs of your project. For instance, if you have additional folders or files, you can add them accordingly.</p>
<p><a href="../microservices/images/sqlserver/image-7.png" target="_blank"><img alt="Alt text" src="../microservices/images/sqlserver/image-7.png" /></a></p>
<!-- 
**Dockerfile vs Docker Compose**

A `Dockerfile` contains a set of instructions and commands used by Docker to automatically build a new container image.

The `docker-compose.yaml` file is a configuration file used by Docker Compose, a tool for defining and running multi-container Docker applications. With a single command, Docker Compose uses the docker-compose.yaml file to create and start all the services defined in the file.

In this lab I'll show you both approaches for creating SQL Server database. -->

<h2 id="microservices-8.sqlserver-db-step-3-add-dockerfiles-to-the-database-project">Step-3: Add Dockerfiles to the Database Project</h2>
<p>To build a Docker image for SQL Server, create a Dockerfile in your project's root directory:</p>
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#microservices-8.sqlserver-db-__codelineno-4-1"></a><span class="c"># Use the official SQL Server 2019 image from Microsoft</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#microservices-8.sqlserver-db-__codelineno-4-2"></a><span class="k">FROM</span><span class="w"> </span><span class="s">mcr.microsoft.com/mssql/server:2019-latest</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#microservices-8.sqlserver-db-__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#microservices-8.sqlserver-db-__codelineno-4-4"></a><span class="c"># Set the environment variables for SQL Server</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#microservices-8.sqlserver-db-__codelineno-4-5"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">ACCEPT_EULA</span><span class="o">=</span>Y
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#microservices-8.sqlserver-db-__codelineno-4-6"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">SA_PASSWORD</span><span class="o">=</span>Strong@Passw0rd
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#microservices-8.sqlserver-db-__codelineno-4-7"></a><span class="c"># ENV MSSQL_PID=Developer</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#microservices-8.sqlserver-db-__codelineno-4-8"></a><span class="c"># ENV MSSQL_TCP_PORT=1433</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#microservices-8.sqlserver-db-__codelineno-4-9"></a>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#microservices-8.sqlserver-db-__codelineno-4-10"></a><span class="c"># Create a directory inside the container to copy your SQL scripts</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#microservices-8.sqlserver-db-__codelineno-4-11"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/src</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#microservices-8.sqlserver-db-__codelineno-4-12"></a>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#microservices-8.sqlserver-db-__codelineno-4-13"></a><span class="c"># Copy your SQL scripts into the container [optional]</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#microservices-8.sqlserver-db-__codelineno-4-14"></a><span class="k">COPY</span><span class="w"> </span>scripts.sql<span class="w"> </span>./scripts.sql
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#microservices-8.sqlserver-db-__codelineno-4-15"></a>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#microservices-8.sqlserver-db-__codelineno-4-16"></a><span class="c"># Set permissions for the SQL scripts</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#microservices-8.sqlserver-db-__codelineno-4-17"></a><span class="c"># RUN chmod +x ./scripts.sql</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#microservices-8.sqlserver-db-__codelineno-4-18"></a>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#microservices-8.sqlserver-db-__codelineno-4-19"></a><span class="c"># RUN SQL SERVER and Access SQL CLI on localhost with given credentials</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#microservices-8.sqlserver-db-__codelineno-4-20"></a><span class="c"># Then run SQL Script - scripts.sql</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#microservices-8.sqlserver-db-__codelineno-4-21"></a><span class="k">RUN</span><span class="w"> </span><span class="o">(</span>/opt/mssql/bin/sqlservr<span class="w"> </span>--accept-eula<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-q<span class="w"> </span><span class="s2">&quot;Service Broker manager has started&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w">  </span>/opt/mssql-tools/bin/sqlcmd<span class="w"> </span>-S127.0.0.1<span class="w"> </span>-Usa<span class="w"> </span>-PStrong@Passw0rd<span class="w"> </span>-i<span class="w"> </span>scripts.sql
</span></code></pre></div>
<p>In this Dockerfile:</p>
<ul>
<li>We start with the official SQL Server 2019 image provided by Microsoft.</li>
<li>Set environment variables <code>ACCEPT_EULA</code> to 'Y' and <code>SA_PASSWORD</code> to the desired strong password for the 'sa' account.</li>
<li>Create a directory inside the container to copy your SQL scripts (<code>/src</code> in this case).</li>
<li>Copy your SQL scripts into the container (assuming you have them in the same directory as your Dockerfile).</li>
<li>Set permissions for the SQL scripts (if needed).</li>
<li>Finally, specify the command to start SQL Server when the container starts.</li>
</ul>
<p>You would replace <code>"./scripts.sql"</code> with the path to your actual SQL script file.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#microservices-8.sqlserver-db-__codelineno-5-1"></a>USE<span class="w"> </span>master<span class="p">;</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#microservices-8.sqlserver-db-__codelineno-5-2"></a>GO
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#microservices-8.sqlserver-db-__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#microservices-8.sqlserver-db-__codelineno-5-4"></a>--<span class="w"> </span>Create<span class="w"> </span>SampleDB
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#microservices-8.sqlserver-db-__codelineno-5-5"></a>CREATE<span class="w"> </span>DATABASE<span class="w"> </span>SampleDB<span class="p">;</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#microservices-8.sqlserver-db-__codelineno-5-6"></a>GO
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#microservices-8.sqlserver-db-__codelineno-5-7"></a>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#microservices-8.sqlserver-db-__codelineno-5-8"></a>USE<span class="w"> </span>SampleDB<span class="p">;</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#microservices-8.sqlserver-db-__codelineno-5-9"></a>GO
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#microservices-8.sqlserver-db-__codelineno-5-10"></a>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#microservices-8.sqlserver-db-__codelineno-5-11"></a>--<span class="w"> </span>Create<span class="w"> </span>Users<span class="w"> </span>table
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#microservices-8.sqlserver-db-__codelineno-5-12"></a>CREATE<span class="w"> </span>TABLE<span class="w"> </span>Users<span class="w"> </span><span class="o">(</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#microservices-8.sqlserver-db-__codelineno-5-13"></a><span class="w">    </span>UserID<span class="w"> </span>INT<span class="w"> </span>PRIMARY<span class="w"> </span>KEY,
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#microservices-8.sqlserver-db-__codelineno-5-14"></a><span class="w">    </span>Username<span class="w"> </span>NVARCHAR<span class="o">(</span><span class="m">50</span><span class="o">)</span>,
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#microservices-8.sqlserver-db-__codelineno-5-15"></a><span class="w">    </span>Email<span class="w"> </span>NVARCHAR<span class="o">(</span><span class="m">100</span><span class="o">)</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#microservices-8.sqlserver-db-__codelineno-5-16"></a><span class="o">)</span><span class="p">;</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#microservices-8.sqlserver-db-__codelineno-5-17"></a>GO
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#microservices-8.sqlserver-db-__codelineno-5-18"></a>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#microservices-8.sqlserver-db-__codelineno-5-19"></a>--<span class="w"> </span>Insert<span class="w"> </span>some<span class="w"> </span>sample<span class="w"> </span>data<span class="w"> </span>into<span class="w"> </span>Users<span class="w"> </span>table
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#microservices-8.sqlserver-db-__codelineno-5-20"></a>INSERT<span class="w"> </span>INTO<span class="w"> </span>Users<span class="w"> </span><span class="o">(</span>UserID,<span class="w"> </span>Username,<span class="w"> </span>Email<span class="o">)</span><span class="w"> </span>VALUES<span class="w"> </span><span class="o">(</span><span class="m">1</span>,<span class="w"> </span><span class="s1">&#39;user1&#39;</span>,<span class="w"> </span><span class="s1">&#39;user1@example.com&#39;</span><span class="o">)</span><span class="p">;</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#microservices-8.sqlserver-db-__codelineno-5-21"></a>INSERT<span class="w"> </span>INTO<span class="w"> </span>Users<span class="w"> </span><span class="o">(</span>UserID,<span class="w"> </span>Username,<span class="w"> </span>Email<span class="o">)</span><span class="w"> </span>VALUES<span class="w"> </span><span class="o">(</span><span class="m">2</span>,<span class="w"> </span><span class="s1">&#39;user2&#39;</span>,<span class="w"> </span><span class="s1">&#39;user2@example.com&#39;</span><span class="o">)</span><span class="p">;</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#microservices-8.sqlserver-db-__codelineno-5-22"></a>INSERT<span class="w"> </span>INTO<span class="w"> </span>Users<span class="w"> </span><span class="o">(</span>UserID,<span class="w"> </span>Username,<span class="w"> </span>Email<span class="o">)</span><span class="w"> </span>VALUES<span class="w"> </span><span class="o">(</span><span class="m">3</span>,<span class="w"> </span><span class="s1">&#39;user3&#39;</span>,<span class="w"> </span><span class="s1">&#39;user3@example.com&#39;</span><span class="o">)</span><span class="p">;</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#microservices-8.sqlserver-db-__codelineno-5-23"></a>GO
</span></code></pre></div>
<p><strong>Step-3.1: Docker Build Locally</strong></p>
<p>To build the Docker image, navigate to the directory containing the Dockerfile and your SQL script, then run:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#microservices-8.sqlserver-db-__codelineno-6-1"></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>my-sqlserver-image<span class="w"> </span>.
</span></code></pre></div>
<p><strong>Docker desktop &gt; Image</strong></p>
<p><a href="../microservices/images/sqlserver/image-1.png" target="_blank"><img alt="Alt text" src="../microservices/images/sqlserver/image-1.png" /></a></p>
<p><strong>Step-3.2: Docker Run Locally</strong></p>
<p>To run your SQL Server container locally for testing and development, use the following command:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#microservices-8.sqlserver-db-__codelineno-7-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>my-sqlserver-container<span class="w"> </span>-p<span class="w"> </span><span class="m">5432</span>:5432<span class="w"> </span>my-sqlserver-image
</span></code></pre></div>
<p>This command creates a container named <code>my-sqlserver-container</code> and maps port 5432 from the container to the host.</p>
<p><strong>Docker desktop &gt; Container</strong></p>
<p><a href="../microservices/images/sqlserver/image-2.png" target="_blank"><img alt="Alt text" src="../microservices/images/sqlserver/image-2.png" /></a></p>
<!-- ## Step-4:  Create Docker Compose file

To setup the SQL Server database with docker compose you need to first create a docker compose file that defines the SQL Server database service and any necessary dependencies.

Create a file named `docker-compose.yml` in your project directory. This file will define the services and configurations for your SQL Server database setup.

In the docker-compose.yml file, define the SQL Server database service. Use the official SQL Server database Docker image and specify any necessary configurations. Here's an example of a SQL Server database service definition:


<div class="language-text highlight"><span class="filename">docker-compose.yml</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#microservices-8.sqlserver-db-__codelineno-8-1"></a># Database type: SQL Server
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#microservices-8.sqlserver-db-__codelineno-8-2"></a># Database name: postgres
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#microservices-8.sqlserver-db-__codelineno-8-3"></a># Database username: postgres
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#microservices-8.sqlserver-db-__codelineno-8-4"></a># Database password: example
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#microservices-8.sqlserver-db-__codelineno-8-5"></a># ADVANCED OPTIONS; Database host: postgres
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#microservices-8.sqlserver-db-__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#microservices-8.sqlserver-db-__codelineno-8-7"></a>version: &#39;3&#39;
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#microservices-8.sqlserver-db-__codelineno-8-8"></a>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#microservices-8.sqlserver-db-__codelineno-8-9"></a>services:
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#microservices-8.sqlserver-db-__codelineno-8-10"></a>  postgres:
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#microservices-8.sqlserver-db-__codelineno-8-11"></a>    image: postgres:16
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#microservices-8.sqlserver-db-__codelineno-8-12"></a>    environment:
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#microservices-8.sqlserver-db-__codelineno-8-13"></a>      POSTGRES_USER : postgres
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#microservices-8.sqlserver-db-__codelineno-8-14"></a>      POSTGRES_PASSWORD: example
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#microservices-8.sqlserver-db-__codelineno-8-15"></a>    # ports:
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#microservices-8.sqlserver-db-__codelineno-8-16"></a>    #     - &quot;5432:5432&quot;
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#microservices-8.sqlserver-db-__codelineno-8-17"></a>    restart: always
</span></code></pre></div>


- Uses the `postgres:16` Docker image.
- Maps port 5432 on your host to port 5432 in the SQL Server database container.
- Sets up an initial user and password for SQL Server database.

**Step-4.1: Build SQL Server database locally**

The `docker-compose up` command is used to start and initialize the services defined in a Docker Compose file. We will build the Docker container locally using the docker compose and ensure that the containerized application working as expected.

<div class="language-sh highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#microservices-8.sqlserver-db-__codelineno-9-1"></a>docker-compose<span class="w"> </span>up
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#microservices-8.sqlserver-db-__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#microservices-8.sqlserver-db-__codelineno-9-3"></a><span class="c1"># or - -d flag, it tells Docker Compose to run the containers in detached mode</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#microservices-8.sqlserver-db-__codelineno-9-4"></a>docker-compose<span class="w"> </span>up<span class="w"> </span>-d
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#microservices-8.sqlserver-db-__codelineno-9-5"></a>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#microservices-8.sqlserver-db-__codelineno-9-6"></a><span class="c1">#output</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#microservices-8.sqlserver-db-__codelineno-9-7"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span><span class="m">33</span>/2
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#microservices-8.sqlserver-db-__codelineno-9-8"></a><span class="w"> </span>✔<span class="w"> </span>postgres<span class="w"> </span><span class="m">14</span><span class="w"> </span>layers<span class="w"> </span><span class="o">[</span>⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿<span class="o">]</span><span class="w">      </span>0B/0B<span class="w">      </span>Pulled
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#microservices-8.sqlserver-db-__codelineno-9-9"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span><span class="m">3</span>/3
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#microservices-8.sqlserver-db-__codelineno-9-10"></a><span class="w"> </span>✔<span class="w"> </span>Network<span class="w"> </span>sqlserver_default<span class="w">       </span>Created
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#microservices-8.sqlserver-db-__codelineno-9-11"></a><span class="w"> </span>✔<span class="w"> </span>Container<span class="w"> </span>sqlserver-postgres-1<span class="w">  </span>Started
</span></code></pre></div>

List running Docker containers on your system.

<div class="language-sh highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#microservices-8.sqlserver-db-__codelineno-10-1"></a>docker<span class="w"> </span>ps
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#microservices-8.sqlserver-db-__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#microservices-8.sqlserver-db-__codelineno-10-3"></a><span class="c1"># output</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#microservices-8.sqlserver-db-__codelineno-10-4"></a>CONTAINER<span class="w"> </span>ID<span class="w">   </span>IMAGE<span class="w">         </span>COMMAND<span class="w">                  </span>CREATED<span class="w">          </span>STATUS<span class="w">          </span>PORTS<span class="w">                    </span>NAMES
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#microservices-8.sqlserver-db-__codelineno-10-5"></a>a433ad35d0a1<span class="w">   </span>postgres:16<span class="w">   </span><span class="s2">&quot;docker-entrypoint.s…&quot;</span><span class="w">   </span><span class="m">20</span><span class="w"> </span>seconds<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">19</span><span class="w"> </span>seconds<span class="w">   </span><span class="m">0</span>.0.0.0:5432-&gt;5432/tcp<span class="w">   </span>sqlserver-postgres-1
</span></code></pre></div>

List Docker images that are currently available on your local system.

<div class="language-sh highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#microservices-8.sqlserver-db-__codelineno-11-1"></a>docker<span class="w"> </span>image<span class="w"> </span>ls
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#microservices-8.sqlserver-db-__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#microservices-8.sqlserver-db-__codelineno-11-3"></a><span class="c1"># output</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#microservices-8.sqlserver-db-__codelineno-11-4"></a>REPOSITORY<span class="w">   </span>TAG<span class="w">       </span>IMAGE<span class="w"> </span>ID<span class="w">       </span>CREATED<span class="w">       </span>SIZE
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#microservices-8.sqlserver-db-__codelineno-11-5"></a>postgres<span class="w">     </span><span class="m">16</span><span class="w">        </span>488c2842403b<span class="w">   </span><span class="m">4</span><span class="w"> </span>weeks<span class="w"> </span>ago<span class="w">   </span>448MB
</span></code></pre></div>


**Step-4.2: Run SQL Server database Container locally**

Run the Docker container locally to verify that the SQL Server database  working correctly within a containerized environment. This step ensures that the containerized SQL Server database  works as expected on your local machine.


List the running Docker containers on your system

<div class="language-sh highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#microservices-8.sqlserver-db-__codelineno-12-1"></a>docker<span class="w"> </span>container<span class="w"> </span>ls
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#microservices-8.sqlserver-db-__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#microservices-8.sqlserver-db-__codelineno-12-3"></a><span class="c1"># output</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#microservices-8.sqlserver-db-__codelineno-12-4"></a>CONTAINER<span class="w"> </span>ID<span class="w">   </span>IMAGE<span class="w">         </span>COMMAND<span class="w">                  </span>CREATED<span class="w">          </span>STATUS<span class="w">          </span>PORTS<span class="w">                    </span>NAMES
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#microservices-8.sqlserver-db-__codelineno-12-5"></a>a433ad35d0a1<span class="w">   </span>postgres:16<span class="w">   </span><span class="s2">&quot;docker-entrypoint.s…&quot;</span><span class="w">   </span><span class="m">42</span><span class="w"> </span>seconds<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">41</span><span class="w"> </span>seconds<span class="w">   </span><span class="m">0</span>.0.0.0:5432-&gt;5432/tcp<span class="w">   </span>sqlserver-postgres-1
</span></code></pre></div>

List the Docker networks that are available on your local system

<div class="language-sh highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#microservices-8.sqlserver-db-__codelineno-13-1"></a>docker<span class="w"> </span>network<span class="w"> </span>ls
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#microservices-8.sqlserver-db-__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#microservices-8.sqlserver-db-__codelineno-13-3"></a><span class="c1"># output</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#microservices-8.sqlserver-db-__codelineno-13-4"></a>NETWORK<span class="w"> </span>ID<span class="w">     </span>NAME<span class="w">      </span>DRIVER<span class="w">    </span>SCOPE
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#microservices-8.sqlserver-db-__codelineno-13-5"></a>a63fce88f432<span class="w">   </span>bridge<span class="w">    </span>bridge<span class="w">    </span><span class="nb">local</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#microservices-8.sqlserver-db-__codelineno-13-6"></a>3a43b39f60b0<span class="w">   </span>host<span class="w">      </span>host<span class="w">      </span><span class="nb">local</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#microservices-8.sqlserver-db-__codelineno-13-7"></a>21fbef3d5c78<span class="w">   </span>none<span class="w">      </span>null<span class="w">      </span><span class="nb">local</span>
</span></code></pre></div>


if you open the docker desktop you will notice the new image & container started running.


<!--

docker run b0b90c1d9579 --env=POSTGRES_PASSWORD=example

docker run b0b90c1d9579 POSTGRES_HOST_AUTH_METHOD=trust

docker run -d -p 5432:5432 --name SQL Server database-postgres -e POSTGRES_PASSWORD=example postgres:16

docker run --name postgres -e POSTGRES_PASSWORD=example -d postgres -p 5432:5432

docker run --name postgres-test -e POSTGRES_PASSWORD=password \
    -p 5432:5432 -v postgres-data:/var/lib/sqlserver/data \
    -d postgres:latest

psql -h localhost -U postgres -d postgres 
!!!note
    Ensure that you test the SQL Server connection using either the pgAdmin tool or the `psql` command-line tool.
 -->

<h2 id="microservices-8.sqlserver-db-step-4-test-the-sql-server-database-connection-using-ssms">Step-4: Test the SQL Server database connection using SSMS</h2>
<p>Testing the SQL Server database connection using SQL Server Management Studio (SSMS) ensures that the database server is accessible and that users can connect to it successfully.</p>
<p>Launch SQL Server Management Studio (SSMS) and provide the necessary credentials to connect to the SQL Server instance.</p>
<p>SSMS &gt; Login Page</p>
<p><a href="../microservices/images/sqlserver/image-5.png" target="_blank"><img alt="Alt text" src="../microservices/images/sqlserver/image-5.png" /></a></p>
<p>SSMS &gt; After Login</p>
<p><a href="../microservices/images/sqlserver/image-6.png" target="_blank"><img alt="Alt text" src="../microservices/images/sqlserver/image-6.png" /></a></p>
<h2 id="microservices-8.sqlserver-db-step-5-test-the-sql-server-database-connection-using-azure-data-studio">Step-5: Test the SQL server database connection using Azure Data Studio</h2>
<p>Azure Data Studio is a cross-platform database tool that offers features similar to SQL Server Management Studio (SSMS) but with additional support for Azure services and extensions.</p>
<p>Launch Azure Data Studio and provide the necessary credentials to connect to the SQL Server instance.</p>
<p>SSMS &gt; Login Page</p>
<p><a href="../microservices/images/sqlserver/image-3.png" target="_blank"><img alt="Alt text" src="../microservices/images/sqlserver/image-3.png" /></a></p>
<p>SSMS &gt; After Login</p>
<p><a href="../microservices/images/sqlserver/image-4.png" target="_blank"><img alt="Alt text" src="../microservices/images/sqlserver/image-4.png" /></a></p>
<h2 id="microservices-8.sqlserver-db-step-6-push-docker-container-to-acr">Step-6: Push Docker Container to ACR</h2>
<p>Push your SQL Server container image to Azure Container Registry (ACR) for use in AKS. Follow these steps:</p>
<p><strong>Log in</strong> to your Azure account using the Azure CLI:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#microservices-8.sqlserver-db-__codelineno-14-1"></a>az<span class="w"> </span>login
</span></code></pre></div>
<p><strong>Authenticate</strong> to your ACR:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#microservices-8.sqlserver-db-__codelineno-15-1"></a>az<span class="w"> </span>acr<span class="w"> </span>login<span class="w"> </span>--name<span class="w"> </span>myacr
</span></code></pre></div>
<p>Replace <code>myacr</code> with your ACR name.</p>
<p><strong>Tag</strong> your local Docker image with the ACR login server:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#microservices-8.sqlserver-db-__codelineno-16-1"></a>docker<span class="w"> </span>tag<span class="w"> </span>my-sqlserver-image<span class="w"> </span>myacr.azurecr.io/my-sqlserver-image:v1
</span></code></pre></div>
<p><strong>Push</strong> the Docker image to ACR:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#microservices-8.sqlserver-db-__codelineno-17-1"></a>docker<span class="w"> </span>push<span class="w"> </span>myacr.azurecr.io/my-sqlserver-image:v1
</span></code></pre></div>
<p>Replace <code>myacr</code> and <code>v1</code> with your ACR name and desired image version.</p>
<p>Now, your SQL Server container image is stored in Azure Container Registry and can be easily pulled and deployed from AKS to Azure Database for SQL Server - Flexible Server.</p>
<h2 id="microservices-8.sqlserver-db-conclusion">Conclusion</h2>
<p>You have successfully created a Docker container for SQL Server database, container created as part of this task will be used in the future labs in AKS.</p>
<h2 id="microservices-8.sqlserver-db-references">References</h2>
<ul>
<li><a href="https://hub.docker.com/search?q=" target="_blank">Docker Hub</a></li>
<li><a href="https://hub.docker.com/_/microsoft-mssql-server" target="_blank">Docker Hub - Microsoft SQL Server image</a></li>
<li><a href="https://hub.docker.com/_/microsoft-mssql-server" target="_blank">Microsoft MSDN- Install SQL Server</a></li>
<li><a href="https://github.com/microsoft/mssql-docker/blob/master/linux/mssql-server-linux/Dockerfile" target="_blank">Microsoft Github- mssql-docker</a></li>
</ul>
<!-- ## Reference
https://medium.com/bright-days/basic-docker-image-dockerfile-sql-server-with-custom-prefill-db-script-8f12f197867a
https://github.com/brightdays/dockersqlgen/blob/master/Dockerfile
https://learn.microsoft.com/en-us/sql/linux/quickstart-install-connect-docker?view=sql-server-linux-2017&pivots=cs1-bash&source=post_page-----8f12f197867a--------------------------------#pullandrun2017
https://learn.microsoft.com/en-us/sql/linux/quickstart-install-connect-ubuntu?view=sql-server-linux-2017&tabs=ubuntu2004
https://www.sqlshack.com/creating-your-own-sql-server-docker-image/
https://github.com/microsoft/mssql-docker/blob/master/linux/mssql-server-linux/Dockerfile
https://www.youtube.com/watch?v=fFpDf5si_Hw
--></section><section class="print-page" id="microservices-9.postgresql-db" heading-number="3.9"><h1 id="microservices-9.postgresql-db-chapter-9-setting-up-postgresql-database-in-a-docker-container">Chapter-9: Setting up PostgreSQL database in a Docker Container</h1>
<h2 id="microservices-9.postgresql-db-introduction">Introduction</h2>
<p>PostgreSQL, also known as <code>Postgres</code> is a powerful, open-source relational database management system (RDBMS). PostgreSQL has gained popularity due to its advanced features and capabilities. PostgreSQL is a reliable choice for a wide range of applications, from small projects to large-scale enterprise systems. Its open-source nature, strong adherence to standards, and extensive feature set making it a popular database solution in the application development.</p>
<p>Running <code>PostgresSQL</code> in a Docker container is best suited for development, testing, learning, or quick experimentation scenarios where you need a lightweight, isolated environment that can be spun up or torn down easily,  it's not ideal for production use. For production environments you can use <code>azure database for postgresql flexible server</code> which is a fully managed platform-as-a-service (PaaS).</p>
<p>In this lab, I will guide you through the process of creating Docker container for PostgreSQL database and run PostgreSQL database in the docker, and finally accessing the PostgreSQL database from <code>pgadmin</code> and <code>psql</code> command line tools.</p>
<!-- ## Technical Scenario


As an `Application Architect`, you are responsible for setting up a microservices architecture and databases for your product development. Your task is to streamline the process of creating development environments for your project and developers. As part of this process, you will use Azure DevOps to manage our PostgreSQL project. We will create a separate database project, add Dockerfiles to the PostgreSQL database project, and push the container image to Azure Container Registry (ACR) so that developers can focus on building and testing applications without worrying about the complexities of setting up and managing PostgreSQL databases on their local machines. This approach improves productivity, ensures consistency, and enhances the overall development workflow. -->

<h2 id="microservices-9.postgresql-db-objective">Objective</h2>
<p>The objective is to establish a local development environment for the PostgreSQL database. To accomplish this, you will create a docker compose file, run them locally. All of these tasks we are doing here will be useful in later chapters when deploying to the Azure Kubernetes Service (AKS).</p>
<p>In this exercise, our objective is to accomplish and learn the following tasks:</p>
<ul>
<li><strong>Step-1:</strong> Setup Git Repository for PostgreSQL database.</li>
<li><strong>Step-2:</strong> Create Folder Structure for PostgreSQL database.</li>
<li><strong>Step-3:</strong> Add Dockerfiles to the Database Project</li>
<li><strong>Step-3.1:</strong> Docker Build Locally</li>
<li><strong>Step-3.2:</strong> Docker Run Locally</li>
<li><strong>Step-4:</strong> Create Docker Compose file</li>
<li><strong>Step-4.1:</strong> Build PostgreSQL database locally.</li>
<li><strong>Step-4.2:</strong> Run PostgreSQL database Container locally.</li>
<li><strong>Step-5:</strong> Test the PostgreSQL database connection from <code>psql</code> tool</li>
<li><strong>Step-6:</strong> Test the PostgreSQL database from <code>pgadmin4</code> tool</li>
<li><strong>Step-7:</strong> Push Docker Container to ACR</li>
</ul>
<p>By the end of this lab, you will have a PostgreSQL database running in a Docker container, managed through Azure DevOps, and ready for use in your development and production environments.</p>
<h2 id="microservices-9.postgresql-db-prerequisites">Prerequisites</h2>
<p>Before starting this lab, ensure you have the following prerequisites in place:</p>
<ul>
<li>Docker Desktop: - <a href="https://docs.docker.com/get-docker/" target="_blank">Docker Downloads</a>.</li>
<li>Docker compose installed</li>
<li>Git Client tool: - <a href="https://git-scm.com/downloads" target="_blank">Git Downloads</a>.</li>
<li>PostgreSQL installed - this will allow you to run <code>psql</code> command line tool</li>
<li>Basic understanding of Docker and PostgreSQL.</li>
<li>Access to an Azure Container Registry (ACR).</li>
</ul>
<p>Verify the docker installation by running following commands:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#microservices-9.postgresql-db-__codelineno-0-1"></a>docker<span class="w"> </span>version
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#microservices-9.postgresql-db-__codelineno-0-2"></a><span class="c1"># or</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#microservices-9.postgresql-db-__codelineno-0-3"></a>docker<span class="w"> </span>--version
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#microservices-9.postgresql-db-__codelineno-0-4"></a><span class="c1"># or</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#microservices-9.postgresql-db-__codelineno-0-5"></a>docker<span class="w"> </span>-v
</span></code></pre></div>
<p>Verify the docker compose by running following commands:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#microservices-9.postgresql-db-__codelineno-1-1"></a>docker-compose<span class="w"> </span>version
</span></code></pre></div>
<!-- ## Architecture Diagram

The following diagram shows the high level steps to create docker container for PostgreSQL database . -->

<!-- [![Alt text](images/postgresql/postgresql-9.png)](images/postgresql/postgresql-9.png){:target="_blank"} -->

<h2 id="microservices-9.postgresql-db-step-1-setup-git-repository-for-postgresql-database">Step-1: Setup Git Repository for PostgreSQL database</h2>
<p>Setting up a Git repository for your PostgreSQL database project allows you to manage your code effectively, work in teams, and track the changes of your database codebase.</p>
<ul>
<li>Create a new project in Azure DevOps for your database-related work.</li>
<li>Create a repository within the project to store your database scripts and Dockerfiles.</li>
</ul>
<p>For example to clone an existing repository, run the following command:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#microservices-9.postgresql-db-__codelineno-2-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://keesari.visualstudio.com/Microservices/_git/microservices
</span></code></pre></div>
<h2 id="microservices-9.postgresql-db-step-2-create-folder-structure-for-postgresql-database">Step-2: Create Folder Structure for PostgreSQL database</h2>
<p>In this step, we'll create a dedicated project or folder for our PostgreSQL database</p>
<p><em>Create a new project:</em></p>
<p>Inside our Git repository, create a new directory or folder specifically for your PostgreSQL database. This folder will contain all the necessary files for PostgreSQL database, including database scripts, docker compose &amp; Dockerfile and other psql files.</p>
<p>Here's a suggested folder structure for a PostgreSQL database project:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#microservices-9.postgresql-db-__codelineno-3-1"></a>your-project-name/
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#microservices-9.postgresql-db-__codelineno-3-2"></a>│
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#microservices-9.postgresql-db-__codelineno-3-3"></a>├──<span class="w"> </span>psql/
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#microservices-9.postgresql-db-__codelineno-3-4"></a>│<span class="w">   </span>├──<span class="w"> </span>scripts/
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#microservices-9.postgresql-db-__codelineno-3-5"></a>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>schema/
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#microservices-9.postgresql-db-__codelineno-3-6"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>tables/
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#microservices-9.postgresql-db-__codelineno-3-7"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>table1.sql
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#microservices-9.postgresql-db-__codelineno-3-8"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>table2.sql
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#microservices-9.postgresql-db-__codelineno-3-9"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>...
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#microservices-9.postgresql-db-__codelineno-3-10"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>views/
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#microservices-9.postgresql-db-__codelineno-3-11"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>view1.sql
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#microservices-9.postgresql-db-__codelineno-3-12"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>view2.sql
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#microservices-9.postgresql-db-__codelineno-3-13"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>...
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#microservices-9.postgresql-db-__codelineno-3-14"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>functions/
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#microservices-9.postgresql-db-__codelineno-3-15"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>function1.sql
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#microservices-9.postgresql-db-__codelineno-3-16"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>function2.sql
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#microservices-9.postgresql-db-__codelineno-3-17"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>...
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#microservices-9.postgresql-db-__codelineno-3-18"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>procedures/
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#microservices-9.postgresql-db-__codelineno-3-19"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">       </span>├──<span class="w"> </span>procedure1.sql
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#microservices-9.postgresql-db-__codelineno-3-20"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">       </span>├──<span class="w"> </span>procedure2.sql
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#microservices-9.postgresql-db-__codelineno-3-21"></a>│<span class="w">   </span>│<span class="w">   </span>│<span class="w">       </span>└──<span class="w"> </span>...
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#microservices-9.postgresql-db-__codelineno-3-22"></a>│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>data/
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#microservices-9.postgresql-db-__codelineno-3-23"></a>│<span class="w">   </span>│<span class="w">       </span>├──<span class="w"> </span>seed_data.sql
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#microservices-9.postgresql-db-__codelineno-3-24"></a>│<span class="w">   </span>│<span class="w">       </span>└──<span class="w"> </span>...
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#microservices-9.postgresql-db-__codelineno-3-25"></a>│<span class="w">   </span>└──<span class="w"> </span>migrations/
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#microservices-9.postgresql-db-__codelineno-3-26"></a>│<span class="w">       </span>├──<span class="w"> </span>version1/
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#microservices-9.postgresql-db-__codelineno-3-27"></a>│<span class="w">       </span>│<span class="w">   </span>├──<span class="w"> </span>up.sql
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#microservices-9.postgresql-db-__codelineno-3-28"></a>│<span class="w">       </span>│<span class="w">   </span>└──<span class="w"> </span>down.sql
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#microservices-9.postgresql-db-__codelineno-3-29"></a>│<span class="w">       </span>├──<span class="w"> </span>version2/
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#microservices-9.postgresql-db-__codelineno-3-30"></a>│<span class="w">       </span>│<span class="w">   </span>├──<span class="w"> </span>up.sql
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#microservices-9.postgresql-db-__codelineno-3-31"></a>│<span class="w">       </span>│<span class="w">   </span>└──<span class="w"> </span>down.sql
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#microservices-9.postgresql-db-__codelineno-3-32"></a>│<span class="w">       </span>└──<span class="w"> </span>...
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#microservices-9.postgresql-db-__codelineno-3-33"></a>│
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#microservices-9.postgresql-db-__codelineno-3-34"></a>├──<span class="w"> </span>Dockerfile
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#microservices-9.postgresql-db-__codelineno-3-35"></a>├──<span class="w"> </span>docker-compose.yml
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#microservices-9.postgresql-db-__codelineno-3-36"></a>└──<span class="w"> </span>README.md
</span></code></pre></div>
<p>Explanation:</p>
<ul>
<li><code>sql/</code>: This folder contains all SQL-related files for your project.</li>
<li><code>scripts/</code>: Contains scripts for creating database objects like tables, views, functions, and stored procedures.<ul>
<li><code>schema/</code>: Contains subfolders for different types of database objects.</li>
<li><code>tables/</code>, <code>views/</code>, <code>functions/</code>, <code>procedures/</code>: Each of these folders contains SQL scripts for the respective database objects.</li>
</ul>
</li>
<li><code>data/</code>: Contains data scripts such as seed data.</li>
<li><code>migrations/</code>: Contains SQL migration scripts for managing database schema changes over time. Each migration version should have an <code>up.sql</code> script for applying the migration and a <code>down.sql</code> script for reverting it.</li>
<li><code>Dockerfile</code>: The Dockerfile for building a Docker image for your PostgreSQL database.</li>
<li><code>docker-compose.yml</code>: A Docker Compose file that defines the services, networks, and volumes for your PostgreSQL container.</li>
<li><code>README.md</code>: Include documentation or instructions for using the repository, such as setup steps, environment variables, or specific details about the database scripts.</li>
</ul>
<p>Feel free to customize this structure according to your project's needs. You can add additional folders or files as required.</p>
<p><strong>Dockerfile vs Docker Compose</strong></p>
<p>A <code>Dockerfile</code> contains a set of instructions and commands used by Docker to automatically build a new container image.</p>
<p>The <code>docker-compose.yaml</code> file is a configuration file used by Docker Compose, a tool for defining and running multi-container Docker applications. With a single command, Docker Compose uses the docker-compose.yaml file to create and start all the services defined in the file. </p>
<p>In this lab I'll show you both approaches for creating PostgreSQL database.</p>
<h2 id="microservices-9.postgresql-db-step-3-add-dockerfiles-to-the-database-project">Step-3: Add Dockerfiles to the Database Project</h2>
<p>To build a Docker image for PostgreSQL, create a Dockerfile in your project's root directory:</p>
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#microservices-9.postgresql-db-__codelineno-4-1"></a><span class="c"># Use the official PostgreSQL image as the base image</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#microservices-9.postgresql-db-__codelineno-4-2"></a><span class="k">FROM</span><span class="w"> </span><span class="s">postgres:latest</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#microservices-9.postgresql-db-__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#microservices-9.postgresql-db-__codelineno-4-4"></a><span class="c"># Set environment variables for PostgreSQL</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#microservices-9.postgresql-db-__codelineno-4-5"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">POSTGRES_USER</span><span class="o">=</span>myuser
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#microservices-9.postgresql-db-__codelineno-4-6"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">POSTGRES_PASSWORD</span><span class="o">=</span>mypassword
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#microservices-9.postgresql-db-__codelineno-4-7"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">POSTGRES_DB</span><span class="o">=</span>mydatabase
</span></code></pre></div>
<p>In this Dockerfile:</p>
<ul>
<li>We use the official PostgreSQL image as our base image.</li>
<li>Set environment variables to configure the PostgreSQL instance.</li>
</ul>
<p><strong>Step-3.1: Docker Build Locally</strong></p>
<p>Navigate to your project's root directory and build the Docker image locally using the following command:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#microservices-9.postgresql-db-__codelineno-5-1"></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>my-postgresql-image<span class="w"> </span>.
</span></code></pre></div>
<p>Replace <code>my-postgresql-image</code> with a meaningful name for your image.</p>
<p><strong>Docker desktop &gt; Image</strong></p>
<p><a href="../microservices/images/postgresql/postgresql-3.png" target="_blank"><img alt="Alt text" src="../microservices/images/postgresql/postgresql-3.png" /></a></p>
<p><strong>Step-3.2: Docker Run Locally</strong></p>
<p>To run your PostgreSQL container locally for testing and development, use the following command:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#microservices-9.postgresql-db-__codelineno-6-1"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>my-postgresql-container<span class="w"> </span>-p<span class="w"> </span><span class="m">5432</span>:5432<span class="w"> </span>my-postgresql-image
</span></code></pre></div>
<p>This command creates a container named <code>my-postgresql-container</code> and maps port 5432 from the container to the host.</p>
<p><strong>Docker desktop &gt; Container</strong></p>
<p><a href="../microservices/images/postgresql/postgresql-4.png" target="_blank"><img alt="Alt text" src="../microservices/images/postgresql/postgresql-4.png" /></a></p>
<h2 id="microservices-9.postgresql-db-step-4-create-docker-compose-file">Step-4:  Create Docker Compose file</h2>
<p>To setup the PostgreSQL database with docker compose you need to first create a docker compose file that defines the PostgreSQL database service and any necessary dependencies.</p>
<p>Create a file named <code>docker-compose.yml</code> in your project directory. This file will define the services and configurations for your PostgreSQL database setup.</p>
<p>In the docker-compose.yml file, define the PostgreSQL database service. Use the official PostgreSQL database Docker image and specify any necessary configurations. Here's an example of a PostgreSQL database service definition:</p>
<div class="language-text highlight"><span class="filename">docker-compose.yml</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#microservices-9.postgresql-db-__codelineno-7-1"></a># Database type: PostgreSQL
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#microservices-9.postgresql-db-__codelineno-7-2"></a># Database name: postgres
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#microservices-9.postgresql-db-__codelineno-7-3"></a># Database username: postgres
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#microservices-9.postgresql-db-__codelineno-7-4"></a># Database password: example
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#microservices-9.postgresql-db-__codelineno-7-5"></a># ADVANCED OPTIONS; Database host: postgres
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#microservices-9.postgresql-db-__codelineno-7-6"></a>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#microservices-9.postgresql-db-__codelineno-7-7"></a>version: &#39;3&#39;
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#microservices-9.postgresql-db-__codelineno-7-8"></a>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#microservices-9.postgresql-db-__codelineno-7-9"></a>services:
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#microservices-9.postgresql-db-__codelineno-7-10"></a>  postgres:
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#microservices-9.postgresql-db-__codelineno-7-11"></a>    image: postgres:16
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#microservices-9.postgresql-db-__codelineno-7-12"></a>    environment:
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#microservices-9.postgresql-db-__codelineno-7-13"></a>      POSTGRES_USER : postgres
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#microservices-9.postgresql-db-__codelineno-7-14"></a>      POSTGRES_PASSWORD: example
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#microservices-9.postgresql-db-__codelineno-7-15"></a>    # ports:
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#microservices-9.postgresql-db-__codelineno-7-16"></a>    #     - &quot;5432:5432&quot;
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#microservices-9.postgresql-db-__codelineno-7-17"></a>    restart: always
</span></code></pre></div>
<ul>
<li>Uses the <code>postgres:16</code> Docker image.</li>
<li>Maps port 5432 on your host to port 5432 in the PostgreSQL database container.</li>
<li>Sets up an initial user and password for PostgreSQL database.</li>
</ul>
<p><strong>Step-4.1: Build PostgreSQL database locally</strong></p>
<p>The <code>docker-compose up</code> command is used to start and initialize the services defined in a Docker Compose file. We will build the Docker container locally using the docker compose and ensure that the containerized application working as expected.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#microservices-9.postgresql-db-__codelineno-8-1"></a>docker-compose<span class="w"> </span>up
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#microservices-9.postgresql-db-__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#microservices-9.postgresql-db-__codelineno-8-3"></a><span class="c1"># or - -d flag, it tells Docker Compose to run the containers in detached mode</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#microservices-9.postgresql-db-__codelineno-8-4"></a>docker-compose<span class="w"> </span>up<span class="w"> </span>-d
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#microservices-9.postgresql-db-__codelineno-8-5"></a>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#microservices-9.postgresql-db-__codelineno-8-6"></a><span class="c1">#output</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#microservices-9.postgresql-db-__codelineno-8-7"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span><span class="m">33</span>/2
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#microservices-9.postgresql-db-__codelineno-8-8"></a><span class="w"> </span>✔<span class="w"> </span>postgres<span class="w"> </span><span class="m">14</span><span class="w"> </span>layers<span class="w"> </span><span class="o">[</span>⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿<span class="o">]</span><span class="w">      </span>0B/0B<span class="w">      </span>Pulled
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#microservices-9.postgresql-db-__codelineno-8-9"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span><span class="m">3</span>/3
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#microservices-9.postgresql-db-__codelineno-8-10"></a><span class="w"> </span>✔<span class="w"> </span>Network<span class="w"> </span>Postgresql_default<span class="w">       </span>Created
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#microservices-9.postgresql-db-__codelineno-8-11"></a><span class="w"> </span>✔<span class="w"> </span>Container<span class="w"> </span>Postgresql-postgres-1<span class="w">  </span>Started
</span></code></pre></div>
<p>List running Docker containers on your system.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#microservices-9.postgresql-db-__codelineno-9-1"></a>docker<span class="w"> </span>ps
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#microservices-9.postgresql-db-__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#microservices-9.postgresql-db-__codelineno-9-3"></a><span class="c1"># output</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#microservices-9.postgresql-db-__codelineno-9-4"></a>CONTAINER<span class="w"> </span>ID<span class="w">   </span>IMAGE<span class="w">         </span>COMMAND<span class="w">                  </span>CREATED<span class="w">          </span>STATUS<span class="w">          </span>PORTS<span class="w">                    </span>NAMES
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#microservices-9.postgresql-db-__codelineno-9-5"></a>a433ad35d0a1<span class="w">   </span>postgres:16<span class="w">   </span><span class="s2">&quot;docker-entrypoint.s…&quot;</span><span class="w">   </span><span class="m">20</span><span class="w"> </span>seconds<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">19</span><span class="w"> </span>seconds<span class="w">   </span><span class="m">0</span>.0.0.0:5432-&gt;5432/tcp<span class="w">   </span>postgresql-postgres-1
</span></code></pre></div>
<p>List Docker images that are currently available on your local system.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#microservices-9.postgresql-db-__codelineno-10-1"></a>docker<span class="w"> </span>image<span class="w"> </span>ls
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#microservices-9.postgresql-db-__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#microservices-9.postgresql-db-__codelineno-10-3"></a><span class="c1"># output</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#microservices-9.postgresql-db-__codelineno-10-4"></a>REPOSITORY<span class="w">   </span>TAG<span class="w">       </span>IMAGE<span class="w"> </span>ID<span class="w">       </span>CREATED<span class="w">       </span>SIZE
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#microservices-9.postgresql-db-__codelineno-10-5"></a>postgres<span class="w">     </span><span class="m">16</span><span class="w">        </span>488c2842403b<span class="w">   </span><span class="m">4</span><span class="w"> </span>weeks<span class="w"> </span>ago<span class="w">   </span>448MB
</span></code></pre></div>
<p><strong>Step-4.2: Run PostgreSQL database Container locally</strong></p>
<p>Run the Docker container locally to verify that the PostgreSQL database  working correctly within a containerized environment. This step ensures that the containerized PostgreSQL database  works as expected on your local machine.</p>
<p>List the running Docker containers on your system</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#microservices-9.postgresql-db-__codelineno-11-1"></a>docker<span class="w"> </span>container<span class="w"> </span>ls
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#microservices-9.postgresql-db-__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#microservices-9.postgresql-db-__codelineno-11-3"></a><span class="c1"># output</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#microservices-9.postgresql-db-__codelineno-11-4"></a>CONTAINER<span class="w"> </span>ID<span class="w">   </span>IMAGE<span class="w">         </span>COMMAND<span class="w">                  </span>CREATED<span class="w">          </span>STATUS<span class="w">          </span>PORTS<span class="w">                    </span>NAMES
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#microservices-9.postgresql-db-__codelineno-11-5"></a>a433ad35d0a1<span class="w">   </span>postgres:16<span class="w">   </span><span class="s2">&quot;docker-entrypoint.s…&quot;</span><span class="w">   </span><span class="m">42</span><span class="w"> </span>seconds<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">41</span><span class="w"> </span>seconds<span class="w">   </span><span class="m">0</span>.0.0.0:5432-&gt;5432/tcp<span class="w">   </span>postgresql-postgres-1
</span></code></pre></div>
<p>List the Docker networks that are available on your local system</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#microservices-9.postgresql-db-__codelineno-12-1"></a>docker<span class="w"> </span>network<span class="w"> </span>ls
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#microservices-9.postgresql-db-__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#microservices-9.postgresql-db-__codelineno-12-3"></a><span class="c1"># output</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#microservices-9.postgresql-db-__codelineno-12-4"></a>NETWORK<span class="w"> </span>ID<span class="w">     </span>NAME<span class="w">      </span>DRIVER<span class="w">    </span>SCOPE
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#microservices-9.postgresql-db-__codelineno-12-5"></a>a63fce88f432<span class="w">   </span>bridge<span class="w">    </span>bridge<span class="w">    </span><span class="nb">local</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#microservices-9.postgresql-db-__codelineno-12-6"></a>3a43b39f60b0<span class="w">   </span>host<span class="w">      </span>host<span class="w">      </span><span class="nb">local</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#microservices-9.postgresql-db-__codelineno-12-7"></a>21fbef3d5c78<span class="w">   </span>none<span class="w">      </span>null<span class="w">      </span><span class="nb">local</span>
</span></code></pre></div>
<p>if you open the docker desktop you will notice the new image &amp; container started running.</p>
<!--

docker run b0b90c1d9579 --env=POSTGRES_PASSWORD=example

docker run b0b90c1d9579 POSTGRES_HOST_AUTH_METHOD=trust

docker run -d -p 5432:5432 --name PostgreSQL database-postgres -e POSTGRES_PASSWORD=example postgres:16

docker run --name postgres -e POSTGRES_PASSWORD=example -d postgres -p 5432:5432

docker run --name postgres-test -e POSTGRES_PASSWORD=password \
    -p 5432:5432 -v postgres-data:/var/lib/postgresql/data \
    -d postgres:latest

psql -h localhost -U postgres -d postgres -->
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ensure that you test the PostgreSQL connection using either the pgAdmin tool or the <code>psql</code> command-line tool.</p>
</div>
<h2 id="microservices-9.postgresql-db-step-5-test-the-postgresql-database-connection-from-psql-tool">Step-5: Test the PostgreSQL database connection from psql tool</h2>
<p>The psql tool is a command-line interface (CLI) provided by PostgreSQL that allows users to interact with PostgreSQL databases directly from the terminal or command prompt.</p>
<p>To test a PostgreSQL database connection using the <code>psql</code> command-line tool, follow these steps:</p>
<p><strong>Opening a terminal</strong> or command prompt on your computer.</p>
<p><strong>Use the <code>psql</code></strong> utility to connect to your PostgreSQL database. </p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#microservices-9.postgresql-db-__codelineno-13-1"></a>psql<span class="w"> </span>-h<span class="w"> </span>&lt;hostname&gt;<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database_name&gt;
</span></code></pre></div>
<p>Replace the placeholders with your specific information:</p>
<ul>
<li><code>&lt;hostname&gt;</code>: The hostname  of the PostgreSQL server.</li>
<li><code>&lt;username&gt;</code>: Your PostgreSQL username.</li>
<li><code>&lt;database_name&gt;</code>: The name of the PostgreSQL database you want to connect to.</li>
</ul>
<p>For example, to connect to a PostgreSQL database running on the local machine with the username "myuser" and the database "mydatabase," you would use the following command:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#microservices-9.postgresql-db-__codelineno-14-1"></a>psql -h localhost -U myuser -d mydatabase
</span></code></pre></div>
<p>If the PostgreSQL server is running on the default port (5432), you don't need to specify the port. However, if it's running on a different port, you can use the <code>-p</code> option to specify the port number.</p>
<p><strong>Provide Password</strong>(if required):</p>
<p>If your PostgreSQL database is configured to require a password for the specified username, you will be prompted to enter the password. Type the password and press Enter.</p>
<p><strong>Successful Connection:</strong></p>
<p>If the connection is successful, you should see the <code>psql</code> command prompt, which indicates that you are connected to the PostgreSQL database. It will look something like this:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#microservices-9.postgresql-db-__codelineno-15-1"></a>psql<span class="w"> </span><span class="o">(</span><span class="m">12</span>.7<span class="o">)</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#microservices-9.postgresql-db-__codelineno-15-2"></a>Type<span class="w"> </span><span class="s2">&quot;help&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>help.
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#microservices-9.postgresql-db-__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#microservices-9.postgresql-db-__codelineno-15-4"></a><span class="nv">mydatabase</span><span class="o">=</span><span class="c1">#</span>
</span></code></pre></div>
<p>You are now in an interactive session with the PostgreSQL database, and you can run SQL commands and queries.</p>
<p><strong>Test SQL Commands:</strong></p>
<p>To further test the database connection, you can execute SQL commands to retrieve or manipulate data. For example, you can run a simple SQL query like:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#microservices-9.postgresql-db-__codelineno-16-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="k">version</span><span class="p">();</span>
</span></code></pre></div>
<p>This query will return the PostgreSQL version, confirming that you can interact with the database.</p>
<p><strong>Exit <code>psql</code>:</strong></p>
<p>To exit the <code>psql</code> session and return to your command prompt, you can type:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#microservices-9.postgresql-db-__codelineno-17-1"></a>\q
</span></code></pre></div>
<p>or press <code>Ctrl + D</code> (on Unix-based systems) or <code>Ctrl + Z</code> (on Windows).</p>
<p><a href="../microservices/images/postgresql/postgresql-1.png" target="_blank"><img alt="Alt text" src="../microservices/images/postgresql/postgresql-1.png" /></a></p>
<p>By following these steps, you can connect to a PostgreSQL database using the psql tool and start interacting with the database using SQL commands directly from the command line.</p>
<p><strong>Create a Database</strong></p>
<p>Creating a database is really simple. Execute the command below, and the database should be created.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#microservices-9.postgresql-db-__codelineno-18-1"></a><span class="c1"># command</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#microservices-9.postgresql-db-__codelineno-18-2"></a><span class="nv">postgres</span><span class="o">=</span><span class="c1"># CREATE DATABASE [databasename];</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#microservices-9.postgresql-db-__codelineno-18-3"></a>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#microservices-9.postgresql-db-__codelineno-18-4"></a><span class="c1"># example</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#microservices-9.postgresql-db-__codelineno-18-5"></a>CREATE<span class="w"> </span>DATABASE<span class="w"> </span>mydatabase2<span class="p">;</span>
</span></code></pre></div>
<h2 id="microservices-9.postgresql-db-step-6-test-the-postgresql-database-from-pgadmin4-tool">Step-6: Test the PostgreSQL database from pgadmin4 tool</h2>
<p>pgAdmin is a popular open-source graphical user interface (GUI) administration tool for PostgreSQL. It provides a comprehensive set of features for managing PostgreSQL databases, including creating and managing databases, schemas, tables, indexes, users, and permissions. pgAdmin allows users to interact with PostgreSQL databases visually, making database administration tasks more intuitive and efficient.</p>
<p>To connect to a PostgreSQL database using the pgAdmin tool, follow these steps:</p>
<p><strong>Install and Launch pgAdmin 4:</strong></p>
<p><a href="https://www.pgadmin.org">Download</a> and install pgAdmin 4 on your computer. Once installed, launch the pgAdmin 4 application.</p>
<p><strong>Log in to pgAdmin</strong></p>
<p>When you launch pgAdmin for the first time, you'll be prompted to set the master password. Enter the password you want to use to log in to pgAdmin. You can also choose to save the login information for future use.</p>
<p><strong>Add a Server:</strong></p>
<p>After logging in, you'll see the pgAdmin interface. To connect to a PostgreSQL server, you need to add a server to pgAdmin. Follow these steps:</p>
<ul>
<li>In the left sidebar, expand "Servers" to reveal the "PostgreSQL" group.</li>
<li>Right-click on "PostgreSQL" and select "Register &gt; Server..."</li>
<li>
<p>Configure Server Connection: you'll need to provide the following information:</p>
</li>
<li>
<p><strong>Name:</strong> Give your server a descriptive name to identify it within pgAdmin.</p>
</li>
<li><strong>Host name/address:</strong> Specify the hostname or IP address of the PostgreSQL server you want to connect to.</li>
<li><strong>Port:</strong> Enter the port number where PostgreSQL is running (default is 5432).</li>
<li><strong>Maintenance database:</strong> Specify the name of a database to connect to initially (e.g., "postgres" or "mydatabase").</li>
<li><strong>Username:</strong> Enter the PostgreSQL username you want to use for this connection.</li>
<li><strong>Password:</strong> Provide the password for the specified username.</li>
</ul>
<p>for example:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#microservices-9.postgresql-db-__codelineno-19-1"></a>hostname<span class="w"> </span>-<span class="w"> </span><span class="sb">`</span>localhost<span class="sb">`</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#microservices-9.postgresql-db-__codelineno-19-2"></a>default<span class="w"> </span>database<span class="w"> </span>-<span class="w"> </span><span class="sb">`</span>postgres<span class="sb">`</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#microservices-9.postgresql-db-__codelineno-19-3"></a>port<span class="w"> </span>-<span class="w"> </span><span class="sb">`</span><span class="m">5432</span><span class="sb">`</span><span class="w"> </span>-<span class="w"> </span>default<span class="w"> </span>postgresql<span class="w"> </span>port<span class="w"> </span><span class="c1">#</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#microservices-9.postgresql-db-__codelineno-19-4"></a>default<span class="w"> </span>user<span class="w"> </span>-<span class="w"> </span><span class="sb">`</span>user<span class="sb">`</span><span class="w"> </span>-<span class="w"> </span>this<span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>owner<span class="w"> </span>of<span class="w"> </span>default<span class="w"> </span>database<span class="w"> </span>postgres
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#microservices-9.postgresql-db-__codelineno-19-5"></a>password<span class="w"> </span>-<span class="w"> </span><span class="sb">`</span>example<span class="sb">`</span><span class="w"> </span>-<span class="w"> </span>this<span class="w"> </span>is<span class="w"> </span>what<span class="w"> </span>we<span class="err">&#39;</span>ve<span class="w"> </span>setup<span class="w"> </span><span class="k">in</span><span class="w"> </span>our<span class="w"> </span>container
</span></code></pre></div>
<p><a href="../microservices/images/postgresql/postgresql-2.png" target="_blank"><img alt="Alt text" src="../microservices/images/postgresql/postgresql-2.png" /></a></p>
<p>Once you've entered the connection details, click the "Save" button to add the server.</p>
<h2 id="microservices-9.postgresql-db-step-7-push-docker-container-to-acr">Step-7: Push Docker Container to ACR</h2>
<p>Push your PostgreSQL container image to Azure Container Registry (ACR) for use in AKS. Follow these steps:</p>
<p><strong>Log in</strong> to your Azure account using the Azure CLI:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#microservices-9.postgresql-db-__codelineno-20-1"></a>az<span class="w"> </span>login
</span></code></pre></div>
<p><strong>Authenticate</strong> to your ACR:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#microservices-9.postgresql-db-__codelineno-21-1"></a>az<span class="w"> </span>acr<span class="w"> </span>login<span class="w"> </span>--name<span class="w"> </span>myacr
</span></code></pre></div>
<p>Replace <code>myacr</code> with your ACR name.</p>
<p><strong>Tag</strong> your local Docker image with the ACR login server:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#microservices-9.postgresql-db-__codelineno-22-1"></a>docker<span class="w"> </span>tag<span class="w"> </span>my-postgresql-image<span class="w"> </span>myacr.azurecr.io/my-postgresql-image:v1
</span></code></pre></div>
<p><strong>Push</strong> the Docker image to ACR:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#microservices-9.postgresql-db-__codelineno-23-1"></a>docker<span class="w"> </span>push<span class="w"> </span>myacr.azurecr.io/my-postgresql-image:v1
</span></code></pre></div>
<p>Replace <code>myacr</code> and <code>v1</code> with your ACR name and desired image version.</p>
<p>Now, your PostgreSQL container image is stored in Azure Container Registry and can be easily pulled and deployed from AKS to Azure Database for PostgreSQL - Flexible Server.</p>
<h2 id="microservices-9.postgresql-db-conclusion">Conclusion</h2>
<p>You have successfully created a Docker container for PostgreSQL database, container created as part of this task will be used in the future labs in AKS.</p>
<h2 id="microservices-9.postgresql-db-references">References</h2>
<ul>
<li><a href="https://www.docker.com/blog/how-to-use-the-postgres-docker-official-image/" target="_blank">Postgres Docker Official Image</a></li>
</ul>
<!-- ## Reference 
- https://betterprogramming.pub/connect-from-local-machine-to-postgresql-docker-container-f785f00461a7
- https://www.postgresguide.com/utilities/psql/
- https://www.postgresql.org/docs/current/app-psql.html
- https://www.geeksforgeeks.org/postgresql-psql-commands/
- https://tomcam.github.io/postgres/
- https://www.sqlshack.com/how-to-install-postgresql-on-windows/
- https://www.sqlshack.com/how-to-install-postgresql-on-ubuntu/
--></section><section class="print-page" id="microservices-10.keycloak" heading-number="3.10"><h1 id="microservices-10.keycloak-chapter-10-setting-up-keycloak-in-a-docker-container">Chapter-10: Setting up Keycloak in a Docker Container</h1>
<h2 id="microservices-10.keycloak-introduction">Introduction</h2>
<p>As part of this chapter, I will introduce Keycloak as one of the applications in the microservices landscape for Security, which is a common requirement across many organizations. Keycloak is a free, open-source, powerful, and flexible popular open-source identity and access management solution that enables you to secure your applications and services.</p>
<p>If you are new to Keycloak and would like to learn more, you can refer to my article on <a href="https://anjikeesari.com/articles/keycloak/" target="_blank">Getting Started with Keycloak</a></p>
<p>In this lab, I will guide you through the process of creating Docker container for Keycloak, and finally accessing the Keycloak application in the web browser.</p>
<p>Running Keycloak in a Docker container provides greater control and flexibility over its configuration and deployment, allowing us to tailor authentication, authorization, and identity management features to meet specific organizational requirements. This approach enables seamless customization of realms, themes, user federation, and integration with external identity providers, all while maintaining consistency across environments through containerized infrastructure.</p>
<p>The objective is to establish a local development environment for the Keycloak application, securing Microservices with Keycloak in a Microservices Architecture,  our goal is to implement authentication and authorization mechanisms across the microservices, ensuring that only authorized users and services can access specific resources. To accomplish this, you will create a Dockerfile or Docker Compose files, run them locally, and subsequently push the image to an Azure Container Registry (ACR). All of these tasks we are doing here will be useful in later chapters when deploying to the Azure Kubernetes Service (AKS).</p>
<p>Here are some Keycloak requirements within microservices architecture:</p>
<ul>
<li>
<p><strong>Keycloak integration</strong>:
   Integrate Keycloak into the microservices architecture to provide authentication and authorization capabilities.
   Keycloak should act as the central identity provider for all microservices.</p>
</li>
<li>
<p><strong>User management</strong>:
   Implement user management within Keycloak, allowing users to sign up, log in, and manage their profiles.
   Define user roles and groups for fine-grained access control.</p>
</li>
<li>
<p><strong>Secure API endpoints</strong>:
   Protect API endpoints to ensure that only authenticated users or services with the appropriate permissions can access them.
   Implement OAuth 2.0 or OpenID Connect for securing APIs.</p>
</li>
<li>
<p><strong>Single Sign-On (SSO)</strong>:
   Keycloak can serve as a versatile solution for enabling SSO between companies by establishing federated trust relationships between IdPs and SPs. This approach simplifies user access across organizations, enhances security, and provides a seamless user experience when accessing services and applications from different companies.</p>
</li>
<li>
<p><strong>JWT Tokens</strong>:
   Utilize JSON Web Tokens (JWT) for secure communication between microservices and Keycloak.
   Configure token expiration, signing, and validation.</p>
</li>
</ul>
<h2 id="microservices-10.keycloak-objective">Objective</h2>
<p>In this exercise, our objective is to accomplish and learn the following tasks:</p>
<ul>
<li><strong>Step-1:</strong> Setup repository for Keycloak in Azure devops.</li>
<li><strong>Step-2:</strong> Create Keycloak Folder.</li>
<li><strong>Step-3:</strong> Add Dockerfiles to the Keycloak project.</li>
<li><strong>Step-4:</strong> Docker build locally.</li>
<li><strong>Step-5:</strong> Docker run locally.</li>
<li><strong>Step-6:</strong> Publish the Keycloak docker container to container registry.</li>
</ul>
<h2 id="microservices-10.keycloak-prerequisites">Prerequisites</h2>
<p>Before starting this lab, ensure you have the following prerequisites in place:</p>
<ul>
<li>Docker and the VS Code Docker extension :  - <a href="https://docs.docker.com/get-docker/" target="_blank">Docker Downloads</a>.</li>
<li>Git Client tool:  - <a href="https://git-scm.com/downloads" target="_blank">Git Downloads</a>.</li>
<li>Azure devops and Git Repository: Initialize a Git repository for your Keycloak application.</li>
<li>Azure Container Registry (ACR)</li>
<li>Docker compose installed</li>
</ul>
<p>Verify the docker installation by running following commands:
<div class="language-sh highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#microservices-10.keycloak-__codelineno-0-1"></a>docker<span class="w"> </span>version
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#microservices-10.keycloak-__codelineno-0-2"></a><span class="c1"># or</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#microservices-10.keycloak-__codelineno-0-3"></a>docker<span class="w"> </span>--version
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#microservices-10.keycloak-__codelineno-0-4"></a><span class="c1"># or</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#microservices-10.keycloak-__codelineno-0-5"></a>docker<span class="w"> </span>-v
</span></code></pre></div></p>
<p>Verify the docker compose by running following commands:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#microservices-10.keycloak-__codelineno-1-1"></a>docker-compose<span class="w"> </span>version
</span></code></pre></div>
<h2 id="microservices-10.keycloak-architecture-diagram">Architecture Diagram</h2>
<p>The following diagram shows the high level steps to create docker container for Keycloak application.</p>
<p><a href="../microservices/images/image-13.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-13.png" /></a></p>
<h2 id="microservices-10.keycloak-step-1-setup-repository-for-keycloak-in-azure-devops">Step-1: Setup repository for Keycloak in Azure DevOps</h2>
<p>Before you begin with the Keycloak setup, it's necessary to have a version control repository to manage your project. </p>
<ul>
<li>Create azure devops project</li>
<li>Initialize repository</li>
</ul>
<p>For this Keycloak application, we can either use an existing git repository created in our first chapter or initiate a new one.</p>
<p>To clone an existing repository, run the following command:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#microservices-10.keycloak-__codelineno-2-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://keesari.visualstudio.com/Microservices/_git/microservices
</span></code></pre></div>
<h2 id="microservices-10.keycloak-step-2-create-keycloak-project">Step-2: Create Keycloak project</h2>
<p>In this step, we'll create a dedicated Folder for our Keycloak application</p>
<p>Create a new Folder: Inside our Git repository, create a new directory or folder specifically for your Keycloak application. This folder will contain all the necessary files for Keycloak, including Dockerfiles and configurations.</p>
<p><a href="../microservices/images/image-14.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-14.png" /></a></p>
<h2 id="microservices-10.keycloak-step-3-keycloak-setup-with-docker-compose">Step-3: Keycloak setup with docker compose</h2>
<p>Setup Keycloak Service:</p>
<p>To setup the Keycloak with docker compose you need to first create a docker compose file that defines the Keycloak service and any necessary dependencies, such as a PostgreSQL database. </p>
<p>Here's a step-by-step explanation of how to set up Keycloak with docker compose:</p>
<p>Create a file named <code>docker-compose.yml</code> in your project directory. This file will define the services and configurations for your Keycloak setup.</p>
<p>In the docker-compose.yml file, define the Keycloak service. Use the official Keycloak Docker image and specify any necessary configurations. Here's an example of a Keycloak service definition:</p>
<div class="language-text highlight"><span class="filename">docker-compose.yml</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#microservices-10.keycloak-__codelineno-3-1"></a>services:
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#microservices-10.keycloak-__codelineno-3-2"></a>  auth:
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#microservices-10.keycloak-__codelineno-3-3"></a>    image: quay.io/keycloak/keycloak
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#microservices-10.keycloak-__codelineno-3-4"></a>    ports:
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#microservices-10.keycloak-__codelineno-3-5"></a>      - &quot;8080:8080&quot;
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#microservices-10.keycloak-__codelineno-3-6"></a>    environment:
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#microservices-10.keycloak-__codelineno-3-7"></a>      KEYCLOAK_ADMIN: admin 
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#microservices-10.keycloak-__codelineno-3-8"></a>      KEYCLOAK_ADMIN_PASSWORD: admin
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#microservices-10.keycloak-__codelineno-3-9"></a>    command: 
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#microservices-10.keycloak-__codelineno-3-10"></a>      - start-dev 
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#microservices-10.keycloak-__codelineno-3-11"></a>      - --import-realm
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#microservices-10.keycloak-__codelineno-3-12"></a>    volumes:
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#microservices-10.keycloak-__codelineno-3-13"></a>      - /home/keycloak/realm.json:/opt/keycloak/data/import/realm.json
</span></code></pre></div>
<p>This definition:</p>
<ul>
<li>Uses the <code>quay.io/keycloak/keycloak</code> Docker image.</li>
<li>Maps port 8080 on your host to port 8080 in the Keycloak container.</li>
<li>Sets up an initial admin user and password for Keycloak.</li>
</ul>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#microservices-10.keycloak-__codelineno-4-1"></a>docker-compose<span class="w"> </span>up
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#microservices-10.keycloak-__codelineno-4-2"></a><span class="c1"># or</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#microservices-10.keycloak-__codelineno-4-3"></a>docker-compose<span class="w"> </span>up<span class="w"> </span>-d
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#microservices-10.keycloak-__codelineno-4-4"></a>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#microservices-10.keycloak-__codelineno-4-5"></a><span class="c1">#output</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#microservices-10.keycloak-__codelineno-4-6"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span><span class="m">1</span>/0
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#microservices-10.keycloak-__codelineno-4-7"></a><span class="w"> </span>✔<span class="w"> </span>Container<span class="w"> </span>keycloak-auth-1<span class="w">  </span>Created<span class="w">                                                                                                                                                                                   </span><span class="m">0</span>.0s<span class="w"> </span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#microservices-10.keycloak-__codelineno-4-8"></a>Attaching<span class="w"> </span>to<span class="w"> </span>keycloak-auth-1
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#microservices-10.keycloak-__codelineno-4-9"></a>.
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#microservices-10.keycloak-__codelineno-4-10"></a>.
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#microservices-10.keycloak-__codelineno-4-11"></a>.
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#microservices-10.keycloak-__codelineno-4-12"></a>Running<span class="w"> </span>the<span class="w"> </span>server<span class="w"> </span><span class="k">in</span><span class="w"> </span>development<span class="w"> </span>mode.<span class="w"> </span>DO<span class="w"> </span>NOT<span class="w"> </span>use<span class="w"> </span>this<span class="w"> </span>configuration<span class="w"> </span><span class="k">in</span><span class="w"> </span>production.
</span></code></pre></div>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#microservices-10.keycloak-__codelineno-5-1"></a>docker<span class="w"> </span>ps
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#microservices-10.keycloak-__codelineno-5-2"></a>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#microservices-10.keycloak-__codelineno-5-3"></a><span class="c1"># output</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#microservices-10.keycloak-__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#microservices-10.keycloak-__codelineno-5-5"></a>CONTAINER<span class="w"> </span>ID<span class="w">   </span>IMAGE<span class="w">                                </span>COMMAND<span class="w">                  </span>CREATED<span class="w">              </span>STATUS<span class="w">              </span>PORTS<span class="w">                              </span>NAMES
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#microservices-10.keycloak-__codelineno-5-6"></a>d3ee7cef046e<span class="w">   </span>quay.io/keycloak/keycloak<span class="w">            </span><span class="s2">&quot;/opt/keycloak/bin/k…&quot;</span><span class="w">   </span>About<span class="w"> </span>a<span class="w"> </span>minute<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span>About<span class="w"> </span>a<span class="w"> </span>minute<span class="w">   </span><span class="m">0</span>.0.0.0:8080-&gt;8080/tcp,<span class="w"> </span><span class="m">8443</span>/tcp<span class="w">   </span>keycloak-auth-1
</span></code></pre></div>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#microservices-10.keycloak-__codelineno-6-1"></a>docker<span class="w"> </span>image<span class="w"> </span>ls
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#microservices-10.keycloak-__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#microservices-10.keycloak-__codelineno-6-3"></a><span class="c1"># output</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#microservices-10.keycloak-__codelineno-6-4"></a>REPOSITORY<span class="w">                                </span>TAG<span class="w">                                        </span>IMAGE<span class="w"> </span>ID<span class="w">       </span>CREATED<span class="w">         </span>SIZE<span class="w">  </span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#microservices-10.keycloak-__codelineno-6-5"></a>quay.io/keycloak/keycloak<span class="w">                 </span>latest<span class="w">                                     </span>273d68e6fb8c<span class="w">   </span><span class="m">6</span><span class="w"> </span>days<span class="w"> </span>ago<span class="w">      </span>459MB<span class="w"> </span>
</span></code></pre></div></p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#microservices-10.keycloak-__codelineno-7-1"></a>docker<span class="w"> </span>container<span class="w"> </span>ls
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#microservices-10.keycloak-__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#microservices-10.keycloak-__codelineno-7-3"></a><span class="c1"># output</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#microservices-10.keycloak-__codelineno-7-4"></a>CONTAINER<span class="w"> </span>ID<span class="w">   </span>IMAGE<span class="w">                                </span>COMMAND<span class="w">                  </span>CREATED<span class="w">          </span>STATUS<span class="w">          </span>PORTS<span class="w">                              </span>NAMES
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#microservices-10.keycloak-__codelineno-7-5"></a>d3ee7cef046e<span class="w">   </span>quay.io/keycloak/keycloak<span class="w">            </span><span class="s2">&quot;/opt/keycloak/bin/k…&quot;</span><span class="w">   </span><span class="m">22</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">22</span><span class="w"> </span>minutes<span class="w">   </span><span class="m">0</span>.0.0.0:8080-&gt;8080/tcp,<span class="w"> </span><span class="m">8443</span>/tcp<span class="w">   </span>keycloak-auth-1
</span></code></pre></div>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#microservices-10.keycloak-__codelineno-8-1"></a>docker<span class="w"> </span>network<span class="w"> </span>ls
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#microservices-10.keycloak-__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#microservices-10.keycloak-__codelineno-8-3"></a><span class="c1"># output</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#microservices-10.keycloak-__codelineno-8-4"></a>NETWORK<span class="w"> </span>ID<span class="w">     </span>NAME<span class="w">                           </span>DRIVER<span class="w">    </span>SCOPE
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#microservices-10.keycloak-__codelineno-8-5"></a>e71f9c6bd718<span class="w">   </span>bridge<span class="w">                         </span>bridge<span class="w">    </span><span class="nb">local</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#microservices-10.keycloak-__codelineno-8-6"></a>d08c17ea4f0e<span class="w">   </span>docker-nodejs-sample_default<span class="w">   </span>bridge<span class="w">    </span><span class="nb">local</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#microservices-10.keycloak-__codelineno-8-7"></a>cfb02a162739<span class="w">   </span>host<span class="w">                           </span>host<span class="w">      </span><span class="nb">local</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#microservices-10.keycloak-__codelineno-8-8"></a>c8fb8d726406<span class="w">   </span>keycloak_default<span class="w">               </span>bridge<span class="w">    </span><span class="nb">local</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#microservices-10.keycloak-__codelineno-8-9"></a>8bba86e6ad07<span class="w">   </span>none<span class="w">                           </span>null<span class="w">      </span><span class="nb">local</span>
</span></code></pre></div></p>
<p>Access Keycloak: </p>
<p>Once the Keycloak service is up and running, you can access the Keycloak admin console by opening a web browser and navigating to <a href="http://localhost:8080">http://localhost:8080</a>. You can log in using the admin user and password you defined in the Keycloak service configuration.</p>
<p>Keycloal admin console</p>
<p><a href="../microservices/images/image-15.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-15.png" /></a></p>
<p>Keycloak Login page</p>
<p><a href="../microservices/images/image-16.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-16.png" /></a></p>
<p>Keycloak master relm</p>
<p><a href="../microservices/images/image-17.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-17.png" /></a></p>
<p>Setup Keycloak Service with PostgreSQL database:</p>
<p>If you want to use a PostgreSQL database as Keycloak's backend, define a PostgreSQL service in the same <code>docker-compose.yml</code> file. </p>
<p>Here's a complete <code>docker-compose.yml</code> file that sets up Keycloak with a PostgreSQL database:</p>
<div class="language-text highlight"><span class="filename">docker-compose.yml</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#microservices-10.keycloak-__codelineno-9-1"></a>version: &#39;3&#39;
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#microservices-10.keycloak-__codelineno-9-2"></a>services:
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#microservices-10.keycloak-__codelineno-9-3"></a>  keycloak:
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#microservices-10.keycloak-__codelineno-9-4"></a>    image: quay.io/keycloak/keycloak
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#microservices-10.keycloak-__codelineno-9-5"></a>    container_name: keycloak
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#microservices-10.keycloak-__codelineno-9-6"></a>    ports:
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#microservices-10.keycloak-__codelineno-9-7"></a>      - &quot;8080:8080&quot;
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#microservices-10.keycloak-__codelineno-9-8"></a>    environment:
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#microservices-10.keycloak-__codelineno-9-9"></a>      - KEYCLOAK_ADMIN=admin
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#microservices-10.keycloak-__codelineno-9-10"></a>      - KEYCLOAK_ADMIN_PASSWORD=admin
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#microservices-10.keycloak-__codelineno-9-11"></a>    command: 
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#microservices-10.keycloak-__codelineno-9-12"></a>      - start-dev 
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#microservices-10.keycloak-__codelineno-9-13"></a>      - --import-realm
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#microservices-10.keycloak-__codelineno-9-14"></a>    volumes:
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#microservices-10.keycloak-__codelineno-9-15"></a>      - /home/keycloak/realm.json:/opt/keycloak/data/import/realm.json
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#microservices-10.keycloak-__codelineno-9-16"></a>    depends_on:
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#microservices-10.keycloak-__codelineno-9-17"></a>      - postgres
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#microservices-10.keycloak-__codelineno-9-18"></a>    networks:
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#microservices-10.keycloak-__codelineno-9-19"></a>      - keycloak_network
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#microservices-10.keycloak-__codelineno-9-20"></a>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#microservices-10.keycloak-__codelineno-9-21"></a>  postgres:
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#microservices-10.keycloak-__codelineno-9-22"></a>    image: postgres:latest
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#microservices-10.keycloak-__codelineno-9-23"></a>    container_name: postgres
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#microservices-10.keycloak-__codelineno-9-24"></a>    ports:
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#microservices-10.keycloak-__codelineno-9-25"></a>      - &quot;5432:5432&quot;
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#microservices-10.keycloak-__codelineno-9-26"></a>    environment:
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#microservices-10.keycloak-__codelineno-9-27"></a>      - POSTGRES_DB=keycloak
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#microservices-10.keycloak-__codelineno-9-28"></a>      - POSTGRES_USER=keycloak
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#microservices-10.keycloak-__codelineno-9-29"></a>      - POSTGRES_PASSWORD=keycloak
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#microservices-10.keycloak-__codelineno-9-30"></a>    networks:
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31" href="#microservices-10.keycloak-__codelineno-9-31"></a>      - keycloak_network
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32" href="#microservices-10.keycloak-__codelineno-9-32"></a>
</span><span id="__span-9-33"><a id="__codelineno-9-33" name="__codelineno-9-33" href="#microservices-10.keycloak-__codelineno-9-33"></a>networks:
</span><span id="__span-9-34"><a id="__codelineno-9-34" name="__codelineno-9-34" href="#microservices-10.keycloak-__codelineno-9-34"></a>  keycloak_network:
</span><span id="__span-9-35"><a id="__codelineno-9-35" name="__codelineno-9-35" href="#microservices-10.keycloak-__codelineno-9-35"></a>    driver: bridge
</span></code></pre></div>
<p>In this <code>docker-compose.yml</code> file:</p>
<ul>
<li>The <code>keycloak</code> service uses the official Keycloak Docker image, maps port 8080 on your host to port 8080 in the Keycloak container, and sets up an initial admin user and password.</li>
<li>The <code>postgres</code> service uses the official PostgreSQL Docker image, specifies the database name, username, and password for PostgreSQL, and maps port 5432 on your host to port 5432 in the PostgreSQL container.</li>
<li><code>depends_on</code> ensures that the <code>keycloak</code> service starts only after the <code>postgres</code> service is up and running, as Keycloak relies on the PostgreSQL database.</li>
<li>Both services are connected to a custom network called <code>keycloak_network</code> for communication between containers.</li>
</ul>
<p><a href="../microservices/images/image-18.png" target="_blank"><img alt="Alt text" src="../microservices/images/image-18.png" /></a></p>
<p>Once both services are up and running, you can access the Keycloak admin console by opening a web browser and navigating to <code>http://localhost:8080/auth</code>. Log in using the admin user and password you specified in the Keycloak service configuration.</p>
<h2 id="microservices-10.keycloak-step-4-keycloak-setup-with-dockerfile">Step-4: Keycloak setup with Dockerfile</h2>
<p><strong>Step-4.1: Create Dockerfile</strong></p>
<p>Let's create a Dockerfile in the root directory of our project and include the following code. We are going to use this Dockerfile to containerize our Keycloak application as per our need.</p>
<div class="language-Dockerfile highlight"><span class="filename">Dockerfile</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#microservices-10.keycloak-__codelineno-10-1"></a><span class="k">FROM</span><span class="w"> </span><span class="s">quay.io/keycloak/keycloak:latest</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="s">builder</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#microservices-10.keycloak-__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#microservices-10.keycloak-__codelineno-10-3"></a><span class="c"># Enable health and metrics support</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#microservices-10.keycloak-__codelineno-10-4"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">KC_HEALTH_ENABLED</span><span class="o">=</span><span class="nb">true</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#microservices-10.keycloak-__codelineno-10-5"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">KC_METRICS_ENABLED</span><span class="o">=</span><span class="nb">true</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#microservices-10.keycloak-__codelineno-10-6"></a>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#microservices-10.keycloak-__codelineno-10-7"></a><span class="c"># Configure a database vendor</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#microservices-10.keycloak-__codelineno-10-8"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">KC_DB</span><span class="o">=</span>postgres
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#microservices-10.keycloak-__codelineno-10-9"></a>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#microservices-10.keycloak-__codelineno-10-10"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/opt/keycloak</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#microservices-10.keycloak-__codelineno-10-11"></a><span class="c"># for demonstration purposes only, please make sure to use proper certificates in production instead</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#microservices-10.keycloak-__codelineno-10-12"></a><span class="k">RUN</span><span class="w"> </span>keytool<span class="w"> </span>-genkeypair<span class="w"> </span>-storepass<span class="w"> </span>password<span class="w"> </span>-storetype<span class="w"> </span>PKCS12<span class="w"> </span>-keyalg<span class="w"> </span>RSA<span class="w"> </span>-keysize<span class="w"> </span><span class="m">2048</span><span class="w"> </span>-dname<span class="w"> </span><span class="s2">&quot;CN=server&quot;</span><span class="w"> </span>-alias<span class="w"> </span>server<span class="w"> </span>-ext<span class="w"> </span><span class="s2">&quot;SAN:c=DNS:localhost,IP:127.0.0.1&quot;</span><span class="w"> </span>-keystore<span class="w"> </span>conf/server.keystore
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#microservices-10.keycloak-__codelineno-10-13"></a><span class="k">RUN</span><span class="w"> </span>/opt/keycloak/bin/kc.sh<span class="w"> </span>build
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#microservices-10.keycloak-__codelineno-10-14"></a>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#microservices-10.keycloak-__codelineno-10-15"></a><span class="k">FROM</span><span class="w"> </span><span class="s">quay.io/keycloak/keycloak:latest</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#microservices-10.keycloak-__codelineno-10-16"></a><span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>/opt/keycloak/<span class="w"> </span>/opt/keycloak/
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#microservices-10.keycloak-__codelineno-10-17"></a>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#microservices-10.keycloak-__codelineno-10-18"></a><span class="c"># change these values to point to a running postgres instance</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#microservices-10.keycloak-__codelineno-10-19"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">KC_DB</span><span class="o">=</span>postgres
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#microservices-10.keycloak-__codelineno-10-20"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">KC_DB_URL</span><span class="o">=</span>&lt;DBURL&gt;
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#microservices-10.keycloak-__codelineno-10-21"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">KC_DB_USERNAME</span><span class="o">=</span>&lt;DBUSERNAME&gt;
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#microservices-10.keycloak-__codelineno-10-22"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">KC_DB_PASSWORD</span><span class="o">=</span>&lt;DBPASSWORD&gt;
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#microservices-10.keycloak-__codelineno-10-23"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">KC_HOSTNAME</span><span class="o">=</span>localhost
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#microservices-10.keycloak-__codelineno-10-24"></a><span class="k">ENTRYPOINT</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;/opt/keycloak/bin/kc.sh&quot;</span><span class="p">]</span>
</span></code></pre></div>
<p><strong>Step-4.2: Docker build locally</strong></p>
<p>We will build the Docker container locally using the Dockerfiles and ensure that the containerized application working as expected.</p>
<p>The <code>docker build</code> command is used to build Docker images from a Dockerfile.  </p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#microservices-10.keycloak-__codelineno-11-1"></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>sample/keycloak-app:20240101.1<span class="w"> </span>.
</span></code></pre></div>
<p>output</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#microservices-10.keycloak-__codelineno-12-1"></a>Docker<span class="w"> </span>build<span class="w"> </span>output<span class="w"> </span>goes<span class="w"> </span>here
</span></code></pre></div>
<p>When you run the <code>docker build</code> command, Docker looks for a Dockerfile in the specified directory and reads the instructions in the file to build a new image. </p>
<p>The Dockerfile contains a series of instructions that define how to build the image, such as copying files, running commands, and setting environment variables. </p>
<p><strong>Step-4.3: Docker run locally</strong></p>
<p>Run the Docker container locally to verify that the keycloak application working correctly within a containerized environment. This step ensures that the containerized keycloak application works as expected on your local machine.</p>
<p>Run the <code>docker run</code> command to start a container based on the image:</p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#microservices-10.keycloak-__codelineno-13-1"></a>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-p<span class="w"> </span><span class="m">8080</span>:8080<span class="w"> </span>sample/keycloak-app:20240101.1<span class="w"> </span>.
</span></code></pre></div>
output</p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#microservices-10.keycloak-__codelineno-14-1"></a>Docker<span class="w"> </span>run<span class="w"> </span>output<span class="w"> </span>goes<span class="w"> </span>here
</span></code></pre></div>
if you open the docker desktop you will notice the new image &amp; container started running.</p>
<h2 id="microservices-10.keycloak-step-5-publish-the-keycloak-docker-container-to-container-registry">Step-5: Publish the Keycloak docker container to container registry</h2>
<p>Now that we have Keycloak Docker container ready locally, it's time to push them to the Container Registry for future deployment on Azure Kubernetes Services (AKS). This step is important for preparing the container for deployment in a cloud environment.</p>
<p>To publish a Keycloak Docker container to Azure Container Registry (ACR), you will need to have the following:</p>
<p>Create an Azure Container Registry. If you don't have one, you can create one by following the instructions in the Azure Portal or using Azure CLI.</p>
<p>Log in to your Azure Container Registry using the Docker command-line interface. You can do this by running the following command:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#microservices-10.keycloak-__codelineno-15-1"></a><span class="c1"># azure Login</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#microservices-10.keycloak-__codelineno-15-2"></a>az<span class="w"> </span>login
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#microservices-10.keycloak-__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#microservices-10.keycloak-__codelineno-15-4"></a><span class="c1"># set the azure subscription</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#microservices-10.keycloak-__codelineno-15-5"></a>az<span class="w"> </span>account<span class="w"> </span><span class="nb">set</span><span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;anji.keesari&quot;</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#microservices-10.keycloak-__codelineno-15-6"></a>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#microservices-10.keycloak-__codelineno-15-7"></a><span class="c1"># Log in to the container registry</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#microservices-10.keycloak-__codelineno-15-8"></a>az<span class="w"> </span>acr<span class="w"> </span>login<span class="w"> </span>--name<span class="w"> </span>acr1dev
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#microservices-10.keycloak-__codelineno-15-9"></a><span class="c1"># Login Succeeded</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#microservices-10.keycloak-__codelineno-15-10"></a><span class="c1"># To get the login server address for verification</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#microservices-10.keycloak-__codelineno-15-11"></a>az<span class="w"> </span>acr<span class="w"> </span>list<span class="w"> </span>--resource-group<span class="w"> </span>rg-acr-dev<span class="w"> </span>--query<span class="w"> </span><span class="s2">&quot;[].{acrLoginServer:loginServer}&quot;</span><span class="w"> </span>--output<span class="w"> </span>table
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#microservices-10.keycloak-__codelineno-15-12"></a>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#microservices-10.keycloak-__codelineno-15-13"></a><span class="c1"># output should look similar to this.</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#microservices-10.keycloak-__codelineno-15-14"></a>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#microservices-10.keycloak-__codelineno-15-15"></a><span class="c1"># AcrLoginServer    </span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#microservices-10.keycloak-__codelineno-15-16"></a><span class="c1"># ------------------</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#microservices-10.keycloak-__codelineno-15-17"></a><span class="c1"># acr1dev.azurecr.io</span>
</span></code></pre></div>
<p>list all the Docker images that are available on the local system</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#microservices-10.keycloak-__codelineno-16-1"></a>docker<span class="w"> </span>images
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#microservices-10.keycloak-__codelineno-16-2"></a>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#microservices-10.keycloak-__codelineno-16-3"></a><span class="c1"># output</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#microservices-10.keycloak-__codelineno-16-4"></a>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#microservices-10.keycloak-__codelineno-16-5"></a>REPOSITORY<span class="w">                                                </span>TAG<span class="w">                                                                          </span>IMAGE<span class="w"> </span>ID<span class="w">       </span>CREATED<span class="w">         </span>SIZE
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#microservices-10.keycloak-__codelineno-16-6"></a>sample/keycloak-app<span class="w">                                         </span><span class="m">20230312</span>.1<span class="w">                                                                   </span>587f347206bc<span class="w">   </span><span class="m">8</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">   </span>216MB
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#microservices-10.keycloak-__codelineno-16-7"></a>.
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#microservices-10.keycloak-__codelineno-16-8"></a>.
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#microservices-10.keycloak-__codelineno-16-9"></a>.
</span></code></pre></div>
<p><code>Tag</code> your Docker container image with the full name of your Azure Container Registry, including the repository name and the version tag. You can do this by running the following command:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#microservices-10.keycloak-__codelineno-17-1"></a>docker<span class="w"> </span>tag<span class="w"> </span>sample/keycloak-app:20240101.1<span class="w"> </span>acr1dev.azurecr.io/sample/keycloak-app:20240101.1
</span></code></pre></div>
<p>Push your Docker container image to your Azure Container Registry using the Docker command-line interface. You can do this by running the following command:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#microservices-10.keycloak-__codelineno-18-1"></a>docker<span class="w"> </span>push<span class="w"> </span>acr1dev.azurecr.io/sample/keycloak-app:20240101.1
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#microservices-10.keycloak-__codelineno-18-2"></a>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#microservices-10.keycloak-__codelineno-18-3"></a><span class="c1">#Output</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#microservices-10.keycloak-__codelineno-18-4"></a>The<span class="w"> </span>push<span class="w"> </span>refers<span class="w"> </span>to<span class="w"> </span>repository<span class="w"> </span><span class="o">[</span>acr1dev.azurecr.io/sample/keycloak-app<span class="o">]</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#microservices-10.keycloak-__codelineno-18-5"></a>649a035a1734:<span class="w"> </span>Pushed
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#microservices-10.keycloak-__codelineno-18-6"></a>4061bd2dd536:<span class="w"> </span>Pushed
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#microservices-10.keycloak-__codelineno-18-7"></a>c0257b3030b0:<span class="w"> </span>Pushed
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#microservices-10.keycloak-__codelineno-18-8"></a>912a3b0fc587:<span class="w"> </span>Pushed
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#microservices-10.keycloak-__codelineno-18-9"></a>a36186d93e25:<span class="w"> </span>Pushed
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#microservices-10.keycloak-__codelineno-18-10"></a>a3d997b065bc:<span class="w"> </span>Pushed
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#microservices-10.keycloak-__codelineno-18-11"></a>65d358b7de11:<span class="w"> </span>Pushed
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#microservices-10.keycloak-__codelineno-18-12"></a>f97384e8ccbc:<span class="w"> </span>Pushed
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#microservices-10.keycloak-__codelineno-18-13"></a>d56e5e720148:<span class="w"> </span>Pushed
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#microservices-10.keycloak-__codelineno-18-14"></a>beee9f30bc1f:<span class="w"> </span>Pushed
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#microservices-10.keycloak-__codelineno-18-15"></a><span class="m">20240101</span>.1:<span class="w"> </span>digest:<span class="w"> </span>sha256:73f0669d18c6cae79beb81edc8c523191710f9ec4781d590884b46326f9ad6f9<span class="w"> </span>size:<span class="w"> </span><span class="m">2419</span>
</span></code></pre></div>
<p>Wait for the push to complete. Depending on the size of your Docker container image and the speed of your internet connection, this may take a few minutes.</p>
<p>Verify the newly pushed image to ACR.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#microservices-10.keycloak-__codelineno-19-1"></a>az<span class="w"> </span>acr<span class="w"> </span>repository<span class="w"> </span>list<span class="w"> </span>--name<span class="w"> </span>acr1dev<span class="w"> </span>--output<span class="w"> </span>table
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#microservices-10.keycloak-__codelineno-19-2"></a>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#microservices-10.keycloak-__codelineno-19-3"></a><span class="c1"># Output</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#microservices-10.keycloak-__codelineno-19-4"></a>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#microservices-10.keycloak-__codelineno-19-5"></a>Result
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#microservices-10.keycloak-__codelineno-19-6"></a>-------------------------------
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#microservices-10.keycloak-__codelineno-19-7"></a>mcr.microsoft.com/dotnet/aspnet
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#microservices-10.keycloak-__codelineno-19-8"></a>mcr.microsoft.com/dotnet/sdk
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#microservices-10.keycloak-__codelineno-19-9"></a>sample/aspnet-api
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#microservices-10.keycloak-__codelineno-19-10"></a>sample/aspnet-app
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#microservices-10.keycloak-__codelineno-19-11"></a>sample/node-api
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#microservices-10.keycloak-__codelineno-19-12"></a>sample/postgresql-db
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#microservices-10.keycloak-__codelineno-19-13"></a>sample/keycloak-app
</span></code></pre></div>
<p>Show the new tags of a image in the acr</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#microservices-10.keycloak-__codelineno-20-1"></a>az<span class="w"> </span>acr<span class="w"> </span>repository<span class="w"> </span>show-tags<span class="w"> </span>--name<span class="w"> </span>acr1dev<span class="w"> </span>--repository<span class="w"> </span>sample/keycloak-app<span class="w"> </span>--output<span class="w"> </span>table
</span></code></pre></div>
<p>You've successfully pushed your Docker container image to Azure Container Registry. You can now use the Azure Portal or Azure CLI to manage your container images and deploy them to Azure services like Azure Kubernetes Service (AKS).</p>
<h2 id="microservices-10.keycloak-conclusion">Conclusion</h2>
<p>You have successfully created a Docker container for keycloak application, container created as part of this task will be used in the future labs in AKS.</p>
<h2 id="microservices-10.keycloak-references">References</h2>
<ul>
<li><a href="https://hub.docker.com/r/keycloak/keycloak" target="_blank">keycloak Docker image</a></li>
<li><a href="https://www.keycloak.org/documentation">Keycloak Official Documentation</a> </li>
<li><a href="https://github.com/keycloak/keycloak">GitHub repository</a></li>
<li><a href="https://stackoverflow.com/questions/tagged/keycloak">Stack Overflow</a> </li>
</ul>
<!-- ## Reference 
- https://www.mastertheboss.com/keycloak/keycloak-with-docker/
- https://www.youtube.com/watch?v=HUpIoF_conA
- https://hub.docker.com/r/keycloak/keycloak
- https://www.youtube.com/watch?v=Fl6-RI2JaGE
- https://www.youtube.com/watch?v=KA4Qs6v-0uo&list=PLQZfys2xO5kgpa9-qpJly78d-t7_Fnjec
-->

<p>-</p></section><section class="print-page" id="microservices-11.drupal" heading-number="3.11"><h1 id="microservices-11.drupal-chapter-11-setting-up-drupal-in-a-docker-container">Chapter-11: Setting up Drupal in a Docker Container</h1>
<h2 id="microservices-11.drupal-introduction">Introduction</h2>
<p>As part of this chapter, I will introduce Drupal as one of the applications in the microservices landscape for content management, which is a common requirement across many organizations. Drupal is a free, open-source, powerful, and flexible CMS written in PHP that enables you to create and manage websites with ease.</p>
<p>If you are new to Drupal and would like to learn more, you can refer to my article on <a href="https://anjikeesari.com/articles/drupal/" target="_blank">Getting Started with Drupal: A Beginner's Guide</a></p>
<p>In this lab, I will guide you through the process of creating Docker container for Drupal and run PostgreSQL database in the backend, and finally accessing the drupal website in the web browser.</p>
<p>The objective is to establish a local development environment for the drupal website. To accomplish this, you will create a docker Compose file, run them locally. All of these tasks we are doing here will be useful in later chapters when deploying to the Azure Kubernetes Service (AKS).</p>
<h2 id="microservices-11.drupal-technical-scenario">Technical Scenario</h2>
<p>As an <code>Application Architect</code>, your responsibility is to design a content management system (CMS) that provides you with enhanced control and flexibility. By creating a custom Docker container with Drupal, you gain the ability to make modifications. You can adapt the Dockerfile to include additional packages, configurations, or custom modules/themes as per your project's specific requirements. This approach guarantees that your Drupal environment aligns with your project's needs while simultaneously utilizing Docker's advantages, including isolation, portability, and scalability.</p>
<h2 id="microservices-11.drupal-objective">Objective</h2>
<p>In this exercise, our objective is to accomplish and learn the following tasks:</p>
<ul>
<li><strong>Step-1:</strong> Setup Git Repository for Drupal.</li>
<li><strong>Step-2:</strong> Create Drupal Folder locally.</li>
<li><strong>Step-3:</strong> Create Docker Compose file</li>
<li><strong>Step-4:</strong> Build Drupal locally.</li>
<li><strong>Step-5:</strong> Run Drupal Container locally.</li>
</ul>
<h2 id="microservices-11.drupal-prerequisites">Prerequisites</h2>
<p>Before starting this lab, ensure you have the following prerequisites in place:</p>
<ul>
<li>Docker Desktop: - <a href="https://docs.docker.com/get-docker/" target="_blank">Docker Downloads</a>.</li>
<li>Git Client tool: - <a href="https://git-scm.com/downloads" target="_blank">Git Downloads</a>.</li>
<li>Git Repository: Initialize a Git repository for your Drupal website.</li>
<li>Docker installed</li>
<li>Docker compose installed</li>
<li>PostgreSQL installed - this will allow you to run <code>psql</code> command line tool</li>
</ul>
<p>Verify the docker installation by running following commands:
<div class="language-sh highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#microservices-11.drupal-__codelineno-0-1"></a>docker<span class="w"> </span>version
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#microservices-11.drupal-__codelineno-0-2"></a><span class="c1"># or</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#microservices-11.drupal-__codelineno-0-3"></a>docker<span class="w"> </span>--version
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#microservices-11.drupal-__codelineno-0-4"></a><span class="c1"># or</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#microservices-11.drupal-__codelineno-0-5"></a>docker<span class="w"> </span>-v
</span></code></pre></div></p>
<p>Verify the docker compose by running following commands:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#microservices-11.drupal-__codelineno-1-1"></a>docker-compose<span class="w"> </span>version
</span></code></pre></div>
<h2 id="microservices-11.drupal-architecture-diagram">Architecture Diagram</h2>
<p>The following diagram shows the high level steps to create docker container for Drupal website.</p>
<p><a href="../microservices/images/drupal/drupal-9.png" target="_blank"><img alt="Alt text" src="../microservices/images/drupal/drupal-9.png" /></a></p>
<h2 id="microservices-11.drupal-step-1-setup-git-repository-for-drupal">Step-1: Setup Git Repository for Drupal</h2>
<p>Setting up a Git repository for your Drupal project allows you to manage your code effectively, work in teams, and track the changes of your website's codebase.</p>
<ul>
<li>Create azure devops project</li>
<li>Initialize repository</li>
</ul>
<p>For this Drupal website, we can either use an existing git repository created in our first chapter or initiate a new one.</p>
<p>For example to clone an existing repository, run the following command:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#microservices-11.drupal-__codelineno-2-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://keesari.visualstudio.com/Microservices/_git/microservices
</span></code></pre></div>
<h2 id="microservices-11.drupal-step-2-create-drupal-project">Step-2: Create Drupal Project</h2>
<p>In this step, we'll create a dedicated project or folder for our Drupal Website</p>
<p><em>Create a new project:</em></p>
<p>Inside our Git repository, create a new directory or folder specifically for your Drupal website. This folder will contain all the necessary files for Drupal website, including docker compose &amp; Dockerfile and configurations.</p>
<p><a href="../microservices/images/drupal/drupal-7.png" target="_blank"><img alt="Alt text" src="../microservices/images/drupal/drupal-7.png" /></a></p>
<h2 id="microservices-11.drupal-step-3-create-docker-compose-file">Step-3:  Create Docker Compose file</h2>
<p>To setup the Drupal with docker compose you need to first create a docker compose file that defines the drupal service and any necessary dependencies, such as a PostgreSQL database. </p>
<p>Create a file named <code>docker-compose.yml</code> in your project directory. This file will define the services and configurations for your Drupal setup.</p>
<p>In the docker-compose.yml file, define the Drupal service. Use the official Drupal Docker image and specify any necessary configurations. Here's an example of a Drupal service definition:</p>
<div class="language-text highlight"><span class="filename">docker-compose.yml</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#microservices-11.drupal-__codelineno-3-1"></a># Drupal with PostgreSQL
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#microservices-11.drupal-__codelineno-3-2"></a>#
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#microservices-11.drupal-__codelineno-3-3"></a># Access via &quot;http://localhost:8080&quot;
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#microservices-11.drupal-__codelineno-3-4"></a>#   (or &quot;http://$(docker-machine ip):8080&quot; if using docker-machine)
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#microservices-11.drupal-__codelineno-3-5"></a>#
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#microservices-11.drupal-__codelineno-3-6"></a># During initial Drupal setup,
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#microservices-11.drupal-__codelineno-3-7"></a># Database type: PostgreSQL
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#microservices-11.drupal-__codelineno-3-8"></a># Database name: postgres
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#microservices-11.drupal-__codelineno-3-9"></a># Database username: postgres
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#microservices-11.drupal-__codelineno-3-10"></a># Database password: example
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#microservices-11.drupal-__codelineno-3-11"></a># ADVANCED OPTIONS; Database host: postgres
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#microservices-11.drupal-__codelineno-3-12"></a>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#microservices-11.drupal-__codelineno-3-13"></a>version: &#39;3.1&#39;
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#microservices-11.drupal-__codelineno-3-14"></a>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#microservices-11.drupal-__codelineno-3-15"></a>services:
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#microservices-11.drupal-__codelineno-3-16"></a>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#microservices-11.drupal-__codelineno-3-17"></a>  drupal:
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#microservices-11.drupal-__codelineno-3-18"></a>    image: drupal:10-apache
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#microservices-11.drupal-__codelineno-3-19"></a>    ports:
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#microservices-11.drupal-__codelineno-3-20"></a>      - 8080:80
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#microservices-11.drupal-__codelineno-3-21"></a>    volumes:
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#microservices-11.drupal-__codelineno-3-22"></a>      - /var/www/html/modules
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#microservices-11.drupal-__codelineno-3-23"></a>      - /var/www/html/profiles
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#microservices-11.drupal-__codelineno-3-24"></a>      - /var/www/html/themes
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#microservices-11.drupal-__codelineno-3-25"></a>      # this takes advantage of the feature in Docker that a new anonymous
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#microservices-11.drupal-__codelineno-3-26"></a>      # volume (which is what we&#39;re creating here) will be initialized with the
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#microservices-11.drupal-__codelineno-3-27"></a>      # existing content of the image at the same location
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#microservices-11.drupal-__codelineno-3-28"></a>      - /var/www/html/sites
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#microservices-11.drupal-__codelineno-3-29"></a>    restart: always
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#microservices-11.drupal-__codelineno-3-30"></a>
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#microservices-11.drupal-__codelineno-3-31"></a>  postgres:
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#microservices-11.drupal-__codelineno-3-32"></a>    image: postgres:16
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#microservices-11.drupal-__codelineno-3-33"></a>    environment:
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#microservices-11.drupal-__codelineno-3-34"></a>      POSTGRES_USER : postgres
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#microservices-11.drupal-__codelineno-3-35"></a>      POSTGRES_PASSWORD: example   
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#microservices-11.drupal-__codelineno-3-36"></a>    # ports:
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37" href="#microservices-11.drupal-__codelineno-3-37"></a>    #     - &quot;5432:5432&quot;
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38" href="#microservices-11.drupal-__codelineno-3-38"></a>    restart: always
</span></code></pre></div>
<ul>
<li>Uses the <code>drupal:10-apache</code> Docker image.</li>
<li>Maps port 8080 on your host to port 8080 in the drupal container.</li>
<li>Sets up an initial admin user and password for drupal.</li>
</ul>
<h2 id="microservices-11.drupal-step-4-build-drupal-locally">Step-4: Build Drupal locally</h2>
<p>The <code>docker-compose up</code> command is used to start and initialize the services defined in a Docker Compose file. We will build the Docker container locally using the docker compose and ensure that the containerized application working as expected.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#microservices-11.drupal-__codelineno-4-1"></a>docker-compose<span class="w"> </span>up
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#microservices-11.drupal-__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#microservices-11.drupal-__codelineno-4-3"></a><span class="c1"># or - -d flag, it tells Docker Compose to run the containers in detached mode</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#microservices-11.drupal-__codelineno-4-4"></a>docker-compose<span class="w"> </span>up<span class="w"> </span>-d
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#microservices-11.drupal-__codelineno-4-5"></a>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#microservices-11.drupal-__codelineno-4-6"></a><span class="c1">#output</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#microservices-11.drupal-__codelineno-4-7"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span><span class="m">33</span>/2
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#microservices-11.drupal-__codelineno-4-8"></a><span class="w"> </span>✔<span class="w"> </span>postgres<span class="w"> </span><span class="m">14</span><span class="w"> </span>layers<span class="w"> </span><span class="o">[</span>⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿<span class="o">]</span><span class="w">      </span>0B/0B<span class="w">      </span>Pulled
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#microservices-11.drupal-__codelineno-4-9"></a><span class="w"> </span>✔<span class="w"> </span>drupal<span class="w"> </span><span class="m">17</span><span class="w"> </span>layers<span class="w"> </span><span class="o">[</span>⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿<span class="o">]</span><span class="w">      </span>0B/0B<span class="w">      </span>Pulled
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#microservices-11.drupal-__codelineno-4-10"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Running<span class="w"> </span><span class="m">3</span>/3
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#microservices-11.drupal-__codelineno-4-11"></a><span class="w"> </span>✔<span class="w"> </span>Network<span class="w"> </span>drupal_default<span class="w">       </span>Created
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#microservices-11.drupal-__codelineno-4-12"></a><span class="w"> </span>✔<span class="w"> </span>Container<span class="w"> </span>drupal-drupal-1<span class="w">    </span>Started
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#microservices-11.drupal-__codelineno-4-13"></a><span class="w"> </span>✔<span class="w"> </span>Container<span class="w"> </span>drupal-postgres-1<span class="w">  </span>Started
</span></code></pre></div>
<p>List running Docker containers on your system. </p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#microservices-11.drupal-__codelineno-5-1"></a>docker<span class="w"> </span>ps
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#microservices-11.drupal-__codelineno-5-2"></a>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#microservices-11.drupal-__codelineno-5-3"></a><span class="c1"># output</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#microservices-11.drupal-__codelineno-5-4"></a>CONTAINER<span class="w"> </span>ID<span class="w">   </span>IMAGE<span class="w">                       </span>COMMAND<span class="w">                  </span>CREATED<span class="w">          </span>STATUS<span class="w">          </span>PORTS<span class="w">                    </span>NAMES
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#microservices-11.drupal-__codelineno-5-5"></a>b2701f4c0b44<span class="w">   </span>postgres:16<span class="w">                 </span><span class="s2">&quot;docker-entrypoint.s…&quot;</span><span class="w">   </span><span class="m">24</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">24</span><span class="w"> </span>minutes<span class="w">   </span><span class="m">5432</span>/tcp<span class="w">                 </span>drupal-postgres-1
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#microservices-11.drupal-__codelineno-5-6"></a>5141598054d3<span class="w">   </span>drupal:10-apache<span class="w">            </span><span class="s2">&quot;docker-php-entrypoi…&quot;</span><span class="w">   </span><span class="m">24</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">24</span><span class="w"> </span>minutes<span class="w">   </span><span class="m">0</span>.0.0.0:8080-&gt;80/tcp<span class="w">     </span>drupal-drupal-1
</span></code></pre></div>
<p>List Docker images that are currently available on your local system.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#microservices-11.drupal-__codelineno-6-1"></a>docker<span class="w"> </span>image<span class="w"> </span>ls
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#microservices-11.drupal-__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#microservices-11.drupal-__codelineno-6-3"></a><span class="c1"># output</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#microservices-11.drupal-__codelineno-6-4"></a>REPOSITORY<span class="w">                                                </span>TAG<span class="w">                                                                          </span>IMAGE<span class="w"> </span>ID<span class="w">       </span>CREATED<span class="w">         </span>SIZE
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#microservices-11.drupal-__codelineno-6-5"></a>drupal<span class="w">                                                    </span><span class="m">10</span>-apache<span class="w">                                                                    </span>48fb247e75d6<span class="w">   </span><span class="m">2</span><span class="w"> </span>weeks<span class="w"> </span>ago<span class="w">     </span>594MB
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#microservices-11.drupal-__codelineno-6-6"></a>postgres<span class="w">                                                  </span><span class="m">16</span><span class="w">                                                                           </span>b0b90c1d9579<span class="w">   </span><span class="m">4</span><span class="w"> </span>weeks<span class="w"> </span>ago<span class="w">     </span>425MB
</span></code></pre></div>
<h2 id="microservices-11.drupal-step-43-run-drupal-container-locally">Step-4.3: Run Drupal Container locally.</h2>
<p>Run the Docker container locally to verify that the drupal website working correctly within a containerized environment. This step ensures that the containerized drupal website works as expected on your local machine.</p>
<p>List the running Docker containers on your system</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#microservices-11.drupal-__codelineno-7-1"></a>docker<span class="w"> </span>container<span class="w"> </span>ls
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#microservices-11.drupal-__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#microservices-11.drupal-__codelineno-7-3"></a><span class="c1"># output</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#microservices-11.drupal-__codelineno-7-4"></a>CONTAINER<span class="w"> </span>ID<span class="w">   </span>IMAGE<span class="w">                       </span>COMMAND<span class="w">                  </span>CREATED<span class="w">          </span>STATUS<span class="w">          </span>PORTS<span class="w">                    </span>NAMES
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#microservices-11.drupal-__codelineno-7-5"></a>b2701f4c0b44<span class="w">   </span>postgres:16<span class="w">                 </span><span class="s2">&quot;docker-entrypoint.s…&quot;</span><span class="w">   </span><span class="m">25</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">25</span><span class="w"> </span>minutes<span class="w">   </span><span class="m">5432</span>/tcp<span class="w">                 </span>drupal-postgres-1
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#microservices-11.drupal-__codelineno-7-6"></a>5141598054d3<span class="w">   </span>drupal:10-apache<span class="w">            </span><span class="s2">&quot;docker-php-entrypoi…&quot;</span><span class="w">   </span><span class="m">25</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">25</span><span class="w"> </span>minutes<span class="w">   </span><span class="m">0</span>.0.0.0:8080-&gt;80/tcp<span class="w">     </span>drupal-drupal-1
</span></code></pre></div>
<p>List the Docker networks that are available on your local system</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#microservices-11.drupal-__codelineno-8-1"></a>docker<span class="w"> </span>network<span class="w"> </span>ls
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#microservices-11.drupal-__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#microservices-11.drupal-__codelineno-8-3"></a><span class="c1"># output</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#microservices-11.drupal-__codelineno-8-4"></a>026de34a62dc<span class="w">   </span>bridge<span class="w">                         </span>bridge<span class="w">    </span><span class="nb">local</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#microservices-11.drupal-__codelineno-8-5"></a>0dcb9a6803a2<span class="w">   </span>drupal_default<span class="w">                 </span>bridge<span class="w">    </span><span class="nb">local</span>
</span></code></pre></div>
<p>if you open the docker desktop you will notice the new image &amp; container started running.</p>
<!-- 

docker run b0b90c1d9579 --env=POSTGRES_PASSWORD=example

docker run b0b90c1d9579 POSTGRES_HOST_AUTH_METHOD=trust

docker run -d -p 5432:5432 --name drupal-postgres -e POSTGRES_PASSWORD=example postgres:16

docker run --name postgres -e POSTGRES_PASSWORD=example -d postgres -p 5432:5432

docker run --name postgres-test -e POSTGRES_PASSWORD=password \
    -p 5432:5432 -v postgres-data:/var/lib/postgresql/data \
    -d postgres:latest

psql -h localhost -U postgres -d postgres -->
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ensure that you test the PostgreSQL connection using either the pgAdmin tool or the <code>psql</code> command-line tool.</p>
</div>
<p><a href="../microservices/images/drupal/drupal-8.png" target="_blank"><img alt="Alt text" src="../microservices/images/drupal/drupal-8.png" /></a></p>
<p><em>Access Drupal Webstie</em></p>
<p>Once the Drupal service is up and running, you can access the Drupal website by opening a web browser and navigating to http://localhost:8080. You can log in using the admin user and password you defined in the Drupal service configuration.</p>
<p>Drupal website &gt; language</p>
<p><a href="../microservices/images/drupal/drupal-1.png" target="_blank"><img alt="Alt text" src="../microservices/images/drupal/drupal-1.png" /></a></p>
<p>Drupal &gt; Installation Profile</p>
<p><a href="../microservices/images/drupal/drupal-2.png" target="_blank"><img alt="Alt text" src="../microservices/images/drupal/drupal-2.png" /></a></p>
<p>Drupal &gt; Database configuration</p>
<p><a href="../microservices/images/drupal/drupal-3.png" target="_blank"><img alt="Alt text" src="../microservices/images/drupal/drupal-3.png" /></a></p>
<p>Drupal &gt; configure site</p>
<p><a href="../microservices/images/drupal/drupal-4.png" target="_blank"><img alt="Alt text" src="../microservices/images/drupal/drupal-4.png" /></a></p>
<p>Drupal &gt; welcome page</p>
<p><a href="../microservices/images/drupal/drupal-5.png" target="_blank"><img alt="Alt text" src="../microservices/images/drupal/drupal-5.png" /></a></p>
<p>Drupal &gt; Users page</p>
<p><a href="../microservices/images/drupal/drupal-6.png" target="_blank"><img alt="Alt text" src="../microservices/images/drupal/drupal-6.png" /></a></p>
<h2 id="microservices-11.drupal-conclusion">Conclusion</h2>
<p>You have successfully created a Docker container for Drupal Website, container created as part of this task will be used in the future labs in AKS.</p>
<h2 id="microservices-11.drupal-references">References</h2>
<p>For further information and resources related to setting up Drupal in a Docker container, refer to the following:</p>
<ul>
<li><a href="https://hub.docker.com/_/drupal" target="_blank">Drupal Docker Official Repository</a></li>
<li><a href="https://docs.docker.com/" target="_blank">Docker Documentation</a></li>
<li><a href="https://docs.docker.com/compose/" target="_blank">Docker Compose Documentation</a></li>
<li><a href="https://www.drupal.org/" target="_blank">Drupal.org - Official Drupal Website</a></li>
</ul>
<!-- 

https://www.linode.com/docs/guides/how-to-install-drupal-with-docker-compose-ubuntu-18-04/ 
https://www.digitalocean.com/community/tutorials/how-to-install-drupal-with-docker-compose#prerequisites
--></section></section>
                    <section class='print-page md-section' id='section-4' heading-number='4'>
                        <h1>Appendix<a class='headerlink' href='#section-4' title='Permanent link'></a>
                        </h1>
                    <section class="print-page" id="appendix-git-cheat-sheet" heading-number="4.1"><h1 id="appendix-git-cheat-sheet-git-commands">Git Commands</h1>
<p>In this article, I am going to present a comprehensive cheat sheet of commonly used Git commands with examples. </p>
<h2 id="appendix-git-cheat-sheet-installing-git">Installing git</h2>
<p>Here are the commands to install Git on different operating systems:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#appendix-git-cheat-sheet-__codelineno-0-1"></a><span class="c1"># Ubuntu/Debian:</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#appendix-git-cheat-sheet-__codelineno-0-2"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>git
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#appendix-git-cheat-sheet-__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#appendix-git-cheat-sheet-__codelineno-0-4"></a><span class="c1"># MacOS (using Homebrew):</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#appendix-git-cheat-sheet-__codelineno-0-5"></a>brew<span class="w"> </span>install<span class="w"> </span>git
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#appendix-git-cheat-sheet-__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#appendix-git-cheat-sheet-__codelineno-0-7"></a><span class="c1"># Windows OS (using choco)</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#appendix-git-cheat-sheet-__codelineno-0-8"></a>choco<span class="w"> </span>install<span class="w"> </span>git
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-setting-up-git-configuration">Setting up git configuration:</h2>
<p>To begin, it's important to configure your Git settings, associating your name and email with your commits. Use the following commands to set your name and email respectively:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#appendix-git-cheat-sheet-__codelineno-1-1"></a>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>user.name<span class="w"> </span><span class="s2">&quot;anji.keesari&quot;</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#appendix-git-cheat-sheet-__codelineno-1-2"></a>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>user.email<span class="w"> </span><span class="s2">&quot;anjkeesari@gmail.com&quot;</span>
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-caching-credentials">Caching credentials:</h2>
<p>Typing in login credentials repeatedly can be time consuming. To streamline this process, you can store your credentials in the cache using the command:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#appendix-git-cheat-sheet-__codelineno-2-1"></a>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>credential.helper<span class="w"> </span>cache
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-enable-automatic-coloring-of-git-output">Enable automatic coloring of Git output</h2>
<p>This command is used to enable automatic coloring of Git output in the command line interface. Enabling this option enhances the readability of Git's output by applying different colors to various elements.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#appendix-git-cheat-sheet-__codelineno-3-1"></a>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>color.ui<span class="w"> </span>auto
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-checking-git-configuration">Checking git configuration:</h2>
<p>To verify your Git configuration, including your username and email, use the following command:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#appendix-git-cheat-sheet-__codelineno-4-1"></a>git<span class="w"> </span>config<span class="w"> </span>-l
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-initializing-git">Initializing git</h2>
<p>Before diving into Git commands, you need to initialize a new Git repository locally in your project's root directory. Execute the command:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#appendix-git-cheat-sheet-__codelineno-5-1"></a>git init
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-git-clone">Git clone</h2>
<p>To work on an existing Git repository, you can clone it using the command</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#appendix-git-cheat-sheet-__codelineno-6-1"></a>git clone &lt;repository-url&gt;
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-adding-files-to-the-staging-area">Adding files to the staging area:</h2>
<p>To stage changes and prepare them for commit, use the git add command. You can add specific files or entire directories to the staging area using the following commands:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#appendix-git-cheat-sheet-__codelineno-7-1"></a>git<span class="w"> </span>add<span class="w"> </span>&lt;file-name&gt;<span class="w">             </span><span class="c1"># Add a specific file</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#appendix-git-cheat-sheet-__codelineno-7-2"></a>git<span class="w"> </span>add<span class="w"> </span>.<span class="w">                       </span><span class="c1"># Add all changes in the current directory (excluding deletions)</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#appendix-git-cheat-sheet-__codelineno-7-3"></a>git<span class="w"> </span>add<span class="w"> </span>test*<span class="w">                   </span><span class="c1"># Add all files starting with &#39;test&#39; in the current directory</span>
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-committing-changes">Committing changes:</h2>
<p>Committing changes captures a snapshot of your code at a specific point in time. Use the following commands to commit your changes:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#appendix-git-cheat-sheet-__codelineno-8-1"></a>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;(message)&quot;</span><span class="w">       </span><span class="c1"># Commits the changes with a custom message</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#appendix-git-cheat-sheet-__codelineno-8-2"></a>git<span class="w"> </span>commit<span class="w"> </span>-am<span class="w"> </span><span class="s2">&quot;(message)&quot;</span><span class="w">      </span><span class="c1"># Adds all changes to staging and commits them with a custom message</span>
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-git-log">Git log</h2>
<p>To view the commit history of a repository, use the <code>git log</code> command. It provides you with an overview of past commits and their respective details. Additionally, you can use <code>git log -p</code> to see the commit history along with the changes made to each file.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#appendix-git-cheat-sheet-__codelineno-9-1"></a><span class="c1">#  shows the commit history for the current repository:</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#appendix-git-cheat-sheet-__codelineno-9-2"></a>git<span class="w"> </span>log
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#appendix-git-cheat-sheet-__codelineno-9-3"></a><span class="c1"># commit&#39;s history including all files and their changes:</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#appendix-git-cheat-sheet-__codelineno-9-4"></a>git<span class="w"> </span>log<span class="w"> </span>-p
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#appendix-git-cheat-sheet-__codelineno-9-5"></a>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#appendix-git-cheat-sheet-__codelineno-9-6"></a>press<span class="w"> </span>q<span class="w"> </span>any<span class="w"> </span><span class="nb">time</span><span class="w"> </span>to<span class="w"> </span>quit
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-commit-details">Commit details</h2>
<p>Use this command to see a specific commit in details</p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#appendix-git-cheat-sheet-__codelineno-10-1"></a>git<span class="w"> </span>show<span class="w"> </span>commit-id
</span></code></pre></div>
Note: replace <code>commit-id</code> with the id of the commit that you can find in the git log</p>
<h2 id="appendix-git-cheat-sheet-git-status">Git status</h2>
<p>This command will show the status of the current repository including staged, unstaged, and untracked files.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#appendix-git-cheat-sheet-__codelineno-11-1"></a>git<span class="w"> </span>status
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-undoing-changes">Undoing changes:</h2>
<p>If you have already pushed a commit to a remote repository and want to undo it, you need to create a new commit that undoes the changes. The following command will create a new commit that undoes the changes introduced by the specified commit:</p>
<p><div class="language-sh highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#appendix-git-cheat-sheet-__codelineno-12-1"></a>git<span class="w"> </span>revert<span class="w"> </span>&lt;commit-id&gt;
</span></code></pre></div>
Replace <commit-id> with the ID of the commit you want to undo.</p>
<p>If you have already committed changes and want to undo the most recent commit, you have a few options depending on your desired outcome:
- Undo the commit and keep the changes as unstaged modifications:
<div class="language-sh highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#appendix-git-cheat-sheet-__codelineno-13-1"></a>git<span class="w"> </span>reset<span class="w"> </span>HEAD^
</span></code></pre></div>
Undo the commit and completely discard the changes:
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#appendix-git-cheat-sheet-__codelineno-14-1"></a>git reset --hard HEAD^
</span></code></pre></div></p>
<h2 id="appendix-git-cheat-sheet-viewing-differences">Viewing differences</h2>
<p>To compare the differences between versions, you can use the git diff command. It displays the changes made to files since the last commit. </p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#appendix-git-cheat-sheet-__codelineno-15-1"></a>git<span class="w"> </span>diff
</span></code></pre></div>
<p>This will show the line-by-line differences between the current state of the files and the last committed version.</p>
<h2 id="appendix-git-cheat-sheet-pushing-changes">Pushing changes</h2>
<p>To push your local commits to a remote repository, you need to use following command.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#appendix-git-cheat-sheet-__codelineno-16-1"></a>git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>&lt;branch-name&gt;
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#appendix-git-cheat-sheet-__codelineno-16-2"></a>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#appendix-git-cheat-sheet-__codelineno-16-3"></a><span class="c1"># if you haven&#39;t set the upstream branch yet, you can use this</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#appendix-git-cheat-sheet-__codelineno-16-4"></a>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#appendix-git-cheat-sheet-__codelineno-16-5"></a>git<span class="w"> </span>push<span class="w"> </span>--set-upstream<span class="w"> </span>origin<span class="w"> </span>aspnet-api
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-pulling-changes">Pulling changes</h2>
<p>Use this command to incorporate the latest changes from a remote repository into your local repository.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#appendix-git-cheat-sheet-__codelineno-17-1"></a>git<span class="w"> </span>pull<span class="w"> </span>origin<span class="w"> </span>&lt;branch-name&gt;
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-git-fetch">Git fetch</h2>
<p>To fetch the latest changes from the remote repository without merging them into your local branches.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#appendix-git-cheat-sheet-__codelineno-18-1"></a>git<span class="w"> </span>fetch
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-creating-a-new-branch">Creating a new branch:</h2>
<p>To create a new branch in Git, you can use the git branch command followed by the name of the branch you want to create. </p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#appendix-git-cheat-sheet-__codelineno-19-1"></a>git<span class="w"> </span>branch<span class="w"> </span>&lt;branch-name&gt;
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#appendix-git-cheat-sheet-__codelineno-19-2"></a>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#appendix-git-cheat-sheet-__codelineno-19-3"></a><span class="c1"># Creates a new branch, `aspnet-api` is name of the branch here</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#appendix-git-cheat-sheet-__codelineno-19-4"></a>git<span class="w"> </span>branch<span class="w"> </span>aspnet-api
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-switching-branch">Switching branch:</h2>
<p>To switch to a different branch in your Git repository, you can utilize the <code>git checkout</code> command followed by the name of the branch you want to switch to. </p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#appendix-git-cheat-sheet-__codelineno-20-1"></a>git<span class="w"> </span>checkout<span class="w"> </span>&lt;branch-name&gt;
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#appendix-git-cheat-sheet-__codelineno-20-2"></a>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#appendix-git-cheat-sheet-__codelineno-20-3"></a><span class="c1"># Switched to branch &#39;aspnet-api&#39;</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#appendix-git-cheat-sheet-__codelineno-20-4"></a>git<span class="w"> </span>checkout<span class="w"> </span>aspnet-api
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-list-branches">List branches</h2>
<p>It will show a list of all branches and mark the current branch with an asterisk and highlight it in green.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#appendix-git-cheat-sheet-__codelineno-21-1"></a><span class="c1"># Shows the list of all branches.</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#appendix-git-cheat-sheet-__codelineno-21-2"></a>git<span class="w"> </span>branch<span class="w">  </span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#appendix-git-cheat-sheet-__codelineno-21-3"></a><span class="c1"># List all local branches in repository. With -a: show all branches (with remote).</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#appendix-git-cheat-sheet-__codelineno-21-4"></a>git<span class="w"> </span>branch<span class="w"> </span>-a<span class="w"> </span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#appendix-git-cheat-sheet-__codelineno-21-5"></a>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#appendix-git-cheat-sheet-__codelineno-21-6"></a><span class="c1"># press q to quit</span>
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-get-remote-urls">Get remote URLs</h2>
<p>You can see all remote repositories for your local repository with this command:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#appendix-git-cheat-sheet-__codelineno-22-1"></a>git<span class="w"> </span>remote<span class="w"> </span>-v
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-more-info-about-a-remote-repo">More info about a remote repo</h2>
<p>How to get more info about a remote repo in Git:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#appendix-git-cheat-sheet-__codelineno-23-1"></a>git<span class="w"> </span>remote<span class="w"> </span>show<span class="w"> </span>origin
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-merging-branches">Merging branches</h2>
<p>In Git, merging allows you to combine the changes from one branch into another. To merge a branch into another branch, you can use the git merge command followed by the name of the branch you want to merge. Here's an example:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#appendix-git-cheat-sheet-__codelineno-24-1"></a>git<span class="w"> </span>merge<span class="w"> </span>&lt;branch-name&gt;
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#appendix-git-cheat-sheet-__codelineno-24-2"></a>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#appendix-git-cheat-sheet-__codelineno-24-3"></a><span class="c1"># For instance, if you want to merge the changes from the develop branch into the main branch</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#appendix-git-cheat-sheet-__codelineno-24-4"></a><span class="c1"># cd to the folder</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#appendix-git-cheat-sheet-__codelineno-24-5"></a>git<span class="w"> </span>checkout<span class="w"> </span>main
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#appendix-git-cheat-sheet-__codelineno-24-6"></a>git<span class="w"> </span>merge<span class="w"> </span>develop
</span></code></pre></div>
<p>After performing the merge, it's a good practice to check the status of your repository using git status to ensure that the merge was successful and there are no conflicts to resolve. Additionally, you can view the commit history using git log to see the merged commits and their details.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#appendix-git-cheat-sheet-__codelineno-25-1"></a>git<span class="w"> </span>status
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#appendix-git-cheat-sheet-__codelineno-25-2"></a>git<span class="w"> </span>logs
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-delete-branch">Delete branch</h2>
<p>To delete a branch in Git, you can use either of the following commands:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#appendix-git-cheat-sheet-__codelineno-26-1"></a>git<span class="w"> </span>branch<span class="w"> </span>--delete<span class="w"> </span>&lt;branch-name&gt;
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#appendix-git-cheat-sheet-__codelineno-26-2"></a>git<span class="w"> </span>branch<span class="w"> </span>-d<span class="w"> </span>&lt;branch-name&gt;
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#appendix-git-cheat-sheet-__codelineno-26-3"></a>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#appendix-git-cheat-sheet-__codelineno-26-4"></a>example
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#appendix-git-cheat-sheet-__codelineno-26-5"></a><span class="c1"># git branch to see list of branches before delete</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#appendix-git-cheat-sheet-__codelineno-26-6"></a>git<span class="w"> </span>branch
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#appendix-git-cheat-sheet-__codelineno-26-7"></a><span class="c1"># delete the branch</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#appendix-git-cheat-sheet-__codelineno-26-8"></a>git<span class="w"> </span>branch<span class="w"> </span>--delete<span class="w"> </span>&lt;branch-name&gt;
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#appendix-git-cheat-sheet-__codelineno-26-9"></a><span class="c1"># git branch again to see list of branches after delete</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#appendix-git-cheat-sheet-__codelineno-26-10"></a>git<span class="w"> </span>branch
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-branch-from-a-previous-commit">Branch from a previous commit</h2>
<p>To create a new branch in Git using a specific commit hash, you can use the git branch command followed by the name of the branch and the commit hash</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#appendix-git-cheat-sheet-__codelineno-27-1"></a>git<span class="w"> </span>branch<span class="w"> </span>branch_name<span class="w"> </span>&lt;commit-hash&gt;
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#appendix-git-cheat-sheet-__codelineno-27-2"></a><span class="c1"># Step 1: Create the branch from the commit hash</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#appendix-git-cheat-sheet-__codelineno-27-3"></a>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#appendix-git-cheat-sheet-__codelineno-27-4"></a>git<span class="w"> </span>branch<span class="w"> </span>new_branch<span class="w"> </span>07615d50afde24d21e2180b90d3a0a58ec131980
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#appendix-git-cheat-sheet-__codelineno-27-5"></a>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#appendix-git-cheat-sheet-__codelineno-27-6"></a><span class="c1"># this will create the local branch</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#appendix-git-cheat-sheet-__codelineno-27-7"></a>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#appendix-git-cheat-sheet-__codelineno-27-8"></a><span class="c1"># Step 2: Switch to the new branch &amp; commit</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#appendix-git-cheat-sheet-__codelineno-27-9"></a>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#appendix-git-cheat-sheet-__codelineno-27-10"></a>git<span class="w"> </span>commit<span class="w"> </span>-am<span class="w"> </span>“<span class="o">(</span>message<span class="o">)</span>”<span class="w"> </span>
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-rollback-an-old-commit">Rollback an old commit</h2>
<p>You can revert an old commit using its commit id. </p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#appendix-git-cheat-sheet-__codelineno-28-1"></a>git<span class="w"> </span>revert<span class="w"> </span>comit_id
</span></code></pre></div>
<h2 id="appendix-git-cheat-sheet-how-to-resolve-merge-conflicts-using-git-commands">How to resolve merge conflicts using git commands</h2>
<p>Resolving merge conflicts in Git involves editing the conflicted files to choose which changes to keep and which to discard, and then committing the resolved changes. Here's a step-by-step guide:</p>
<ol>
<li>
<p>Check the status of your repository to see if there are any merge conflicts:</p>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#appendix-git-cheat-sheet-__codelineno-29-1"></a>git status
</span></code></pre></div>
If there are merge conflicts, you will see a message indicating which files have conflicts.</p>
</li>
<li>
<p>Open the conflicted files in a text editor and look for the conflict markers. The markers will look something like this:</p>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#appendix-git-cheat-sheet-__codelineno-30-1"></a>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#appendix-git-cheat-sheet-__codelineno-30-2"></a>This is the content from the current branch.
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#appendix-git-cheat-sheet-__codelineno-30-3"></a>=======
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#appendix-git-cheat-sheet-__codelineno-30-4"></a>This is the content from the branch you are merging.
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#appendix-git-cheat-sheet-__codelineno-30-5"></a>&gt;&gt;&gt;&gt;&gt;&gt;&gt; &lt;branch-name&gt;
</span></code></pre></div>
1. Decide what changes you want to keep and remove the conflict markers and any unnecessary content. The final content should only include the changes you want to keep.</p>
</li>
<li>
<p>Stage the changes using git add:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#appendix-git-cheat-sheet-__codelineno-31-1"></a>git add &lt;file-name&gt;
</span></code></pre></div></p>
</li>
<li>Commit the changes to the repository:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#appendix-git-cheat-sheet-__codelineno-32-1"></a>git commit -m &quot;Resolved merge conflicts&quot;
</span></code></pre></div></li>
<li>Push the changes to the remote repository if necessary:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#appendix-git-cheat-sheet-__codelineno-33-1"></a>git push origin &lt;branch-name&gt;
</span></code></pre></div></li>
</ol>
<h2 id="appendix-git-cheat-sheet-temporary-commits">Temporary commits</h2>
<p>In Git, you can use temporary commits to store modified, tracked files temporarily, allowing you to switch branches without losing your changes. This is a useful technique when you want to work on a different branch but are not ready to commit your changes yet.</p>
<ul>
<li>Stash your changes: 
This will create a temporary commit that stores your modifications, allowing you to switch branches.
<div class="language-sh highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#appendix-git-cheat-sheet-__codelineno-34-1"></a>git<span class="w"> </span>stash
</span></code></pre></div></li>
<li>Git stash list
Running this command will show you the stash ID, along with a description that includes the branch name and commit message.
<div class="language-sh highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#appendix-git-cheat-sheet-__codelineno-35-1"></a>git<span class="w"> </span>stash<span class="w"> </span>list
</span></code></pre></div></li>
<li>Git stash pop:
his command is used to apply the changes from the top of the stash stack and remove that stash from the stack.
<div class="language-sh highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#appendix-git-cheat-sheet-__codelineno-36-1"></a>git<span class="w"> </span>stash<span class="w"> </span>pop:
</span></code></pre></div></li>
<li>Git stash drop: 
This command allows you to discard a stash from the stash stack. It permanently removes a stash and its changes, freeing up space in the stack.
<div class="language-sh highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#appendix-git-cheat-sheet-__codelineno-37-1"></a>git<span class="w"> </span>stash<span class="w"> </span>drop:<span class="w"> </span>
</span></code></pre></div></li>
</ul>
<!-- 
## How to set global git config settings?

There are a number of ways to edit the global git config file. One way is to add properties through the command line. The global git config email and username properties are often set in the following way:

<div class="language-text highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#appendix-git-cheat-sheet-__codelineno-38-1"></a>git config –global user.name anjkeesari # Set the username to be used for all actions
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#appendix-git-cheat-sheet-__codelineno-38-2"></a>git config –global user.email anjkeesari@gmail.com  # Set the email to be used for all the actions.
</span></code></pre></div>

## git config global edit


The global git config is simply a text file, so it can be edited with whatever text editor you choose. Open, edit global git config, save and close, and the changes will take effect the next time you issue a git command. It’s that easy.

<div class="language-text highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#appendix-git-cheat-sheet-__codelineno-39-1"></a>git config --global --edit
</span></code></pre></div>

These are some of the most commonly used Git commands. However, Git is a powerful tool with many more features and commands. For more information, you can refer to the official Git documentation.



## Reference -->

<!-- - https://www.theserverside.com/blog/Coffee-Talk-Java-News-Stories-and-Opinions/The-global-Git-config-files-key-settings-and-usages#:~:text=How%20to%20do%20a%20git,It's%20that%20easy. --></section><section class="print-page" id="appendix-docker-cheat-sheet" heading-number="4.2"><h1 id="appendix-docker-cheat-sheet-docker-commands">Docker Commands</h1>
<h2 id="appendix-docker-cheat-sheet-introduction">Introduction</h2>
<p>In this article, I am going to present a comprehensive cheat sheet of commonly used <code>Docker</code> commands</p>
<h2 id="appendix-docker-cheat-sheet-installing-docker">Installing Docker</h2>
<p>Here are the commands to install Docker on different operating systems:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#appendix-docker-cheat-sheet-__codelineno-0-1"></a><span class="c1"># Ubuntu/Debian:</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#appendix-docker-cheat-sheet-__codelineno-0-2"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#appendix-docker-cheat-sheet-__codelineno-0-3"></a>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>docker.io
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#appendix-docker-cheat-sheet-__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#appendix-docker-cheat-sheet-__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#appendix-docker-cheat-sheet-__codelineno-0-6"></a><span class="c1"># MacOS (using Homebrew):</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#appendix-docker-cheat-sheet-__codelineno-0-7"></a>brew<span class="w"> </span>install<span class="w"> </span>docker
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#appendix-docker-cheat-sheet-__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#appendix-docker-cheat-sheet-__codelineno-0-9"></a><span class="c1"># Windows OS (using choco)</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#appendix-docker-cheat-sheet-__codelineno-0-10"></a>choco<span class="w"> </span>install<span class="w"> </span>docker-desktop
</span></code></pre></div>
<h2 id="appendix-docker-cheat-sheet-docker-install-verify">Docker Install verify</h2>
<p>To know docker is installed or not</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#appendix-docker-cheat-sheet-__codelineno-1-1"></a>which<span class="w"> </span>docker
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#appendix-docker-cheat-sheet-__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#appendix-docker-cheat-sheet-__codelineno-1-3"></a><span class="c1"># output</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#appendix-docker-cheat-sheet-__codelineno-1-4"></a>/usr/bin/docker
</span></code></pre></div>
<p>What is the version installed on your machine</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#appendix-docker-cheat-sheet-__codelineno-2-1"></a>docker<span class="w"> </span>-version
</span></code></pre></div>
<h2 id="appendix-docker-cheat-sheet-general-commands">General Commands</h2>
<p>Start the docker daemon</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#appendix-docker-cheat-sheet-__codelineno-3-1"></a>docker<span class="w"> </span>-d
</span></code></pre></div>
<p>Get help with Docker. Can also use –help on all subcommands</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#appendix-docker-cheat-sheet-__codelineno-4-1"></a>docker<span class="w"> </span>--help
</span></code></pre></div>
<p>Display system-wide information</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#appendix-docker-cheat-sheet-__codelineno-5-1"></a>docker<span class="w"> </span>info
</span></code></pre></div>
<h2 id="appendix-docker-cheat-sheet-docker-image">Docker Image</h2>
<p>Docker image is a lightweight, standalone, and executable package that contains everything needed to run a piece of software, including the code, runtime, system tools, libraries, and dependencies. </p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#appendix-docker-cheat-sheet-__codelineno-6-1"></a><span class="c1"># List local images</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#appendix-docker-cheat-sheet-__codelineno-6-2"></a>docker<span class="w"> </span>images
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#appendix-docker-cheat-sheet-__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#appendix-docker-cheat-sheet-__codelineno-6-4"></a><span class="c1"># Delete an Image</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#appendix-docker-cheat-sheet-__codelineno-6-5"></a>docker<span class="w"> </span>rmi<span class="w"> </span>&lt;image_name&gt;
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#appendix-docker-cheat-sheet-__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#appendix-docker-cheat-sheet-__codelineno-6-7"></a><span class="c1"># Remove all unused images</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#appendix-docker-cheat-sheet-__codelineno-6-8"></a>docker<span class="w"> </span>image<span class="w"> </span>prune
</span></code></pre></div>
<h2 id="appendix-docker-cheat-sheet-docker-build">Docker Build</h2>
<p>Build an image from a Dockerfile</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#appendix-docker-cheat-sheet-__codelineno-7-1"></a><span class="c1"># Build an image from a Dockerfile and tag it with a specified name.</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#appendix-docker-cheat-sheet-__codelineno-7-2"></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>&lt;image_name&gt;
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#appendix-docker-cheat-sheet-__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#appendix-docker-cheat-sheet-__codelineno-7-4"></a><span class="c1"># build an image and tag with naming conventions</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#appendix-docker-cheat-sheet-__codelineno-7-5"></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>projectname/domainname/appname:yyyymmdd.sequence<span class="w"> </span>.
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#appendix-docker-cheat-sheet-__codelineno-7-6"></a><span class="c1"># Example</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#appendix-docker-cheat-sheet-__codelineno-7-7"></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>sample/aspnet-api:20230226.1<span class="w"> </span>.
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#appendix-docker-cheat-sheet-__codelineno-7-8"></a>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#appendix-docker-cheat-sheet-__codelineno-7-9"></a><span class="c1"># Build an image from a Dockerfile without the cache</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#appendix-docker-cheat-sheet-__codelineno-7-10"></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>&lt;image_name&gt;<span class="w"> </span>.<span class="w"> </span>–no-cache
</span></code></pre></div>
<h2 id="appendix-docker-cheat-sheet-docker-run">Docker Run</h2>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#appendix-docker-cheat-sheet-__codelineno-8-1"></a><span class="c1"># Create and run a container from an image, with a custom name:</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#appendix-docker-cheat-sheet-__codelineno-8-2"></a>docker<span class="w"> </span>run<span class="w"> </span>--name<span class="w"> </span>&lt;container_name&gt;<span class="w"> </span>&lt;image_name&gt;
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#appendix-docker-cheat-sheet-__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#appendix-docker-cheat-sheet-__codelineno-8-4"></a><span class="c1"># Run a container with and publish a container’s port(s) to the host.</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#appendix-docker-cheat-sheet-__codelineno-8-5"></a>docker<span class="w"> </span>run<span class="w"> </span>-p<span class="w"> </span>&lt;host_port&gt;:&lt;container_port&gt;<span class="w"> </span>&lt;image_name&gt;
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#appendix-docker-cheat-sheet-__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#appendix-docker-cheat-sheet-__codelineno-8-7"></a><span class="c1"># Run a container in the background</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#appendix-docker-cheat-sheet-__codelineno-8-8"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>&lt;image_name&gt;
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#appendix-docker-cheat-sheet-__codelineno-8-9"></a>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#appendix-docker-cheat-sheet-__codelineno-8-10"></a><span class="c1"># Remove a stopped container:</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#appendix-docker-cheat-sheet-__codelineno-8-11"></a>docker<span class="w"> </span>rm<span class="w"> </span>&lt;container_name&gt;
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#appendix-docker-cheat-sheet-__codelineno-8-12"></a>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#appendix-docker-cheat-sheet-__codelineno-8-13"></a><span class="c1"># Example: </span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#appendix-docker-cheat-sheet-__codelineno-8-14"></a>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-p<span class="w"> </span><span class="m">8080</span>:80<span class="w"> </span>project1/domain1/app1:20230226.1
</span></code></pre></div>
<ul>
<li><strong>--rm:</strong> This option automatically removes the container when it exits. It ensures that the container is cleaned up after it finishes running. This is useful for temporary or disposable containers.</li>
<li><strong>-p 8080:80:</strong> This option maps the host machine's port 8080 to the container's port 80. It establishes a network connection between the host and the container, allowing access to the containerized application via port 8080 on the host.</li>
</ul>
<p>Exit the container</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#appendix-docker-cheat-sheet-__codelineno-9-1"></a><span class="nb">exit</span>
</span></code></pre></div>
<h2 id="appendix-docker-cheat-sheet-docker-push">Docker Push</h2>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#appendix-docker-cheat-sheet-__codelineno-10-1"></a><span class="c1"># Publish an image to Docker Hub</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#appendix-docker-cheat-sheet-__codelineno-10-2"></a>docker<span class="w"> </span>push<span class="w"> </span>&lt;username&gt;/&lt;image_name&gt;
</span></code></pre></div>
<h2 id="appendix-docker-cheat-sheet-docker-container">Docker container</h2>
<p>A Docker container is a lightweight, standalone, and executable runtime instance of a Docker image. It represents a running process that is isolated from the host system and other containers. Docker container providing a consistent and reproducible environment for running applications. Containers are highly portable and can be easily moved and deployed across different environments, such as development, testing, staging, and production. </p>
<h2 id="appendix-docker-cheat-sheet-docker-hub">Docker Hub</h2>
<p>Docker Hub is a cloud-based registry service provided by Docker that allows developers to store and share container images. It serves as a centralized repository for Docker images,</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#appendix-docker-cheat-sheet-__codelineno-11-1"></a><span class="c1"># Login into Docker</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#appendix-docker-cheat-sheet-__codelineno-11-2"></a>docker<span class="w"> </span>login<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#appendix-docker-cheat-sheet-__codelineno-11-3"></a>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#appendix-docker-cheat-sheet-__codelineno-11-4"></a><span class="c1"># Publish an image to Docker Hub</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#appendix-docker-cheat-sheet-__codelineno-11-5"></a>docker<span class="w"> </span>push<span class="w"> </span>&lt;username&gt;/&lt;image_name&gt;
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#appendix-docker-cheat-sheet-__codelineno-11-6"></a>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#appendix-docker-cheat-sheet-__codelineno-11-7"></a><span class="c1"># Search Hub for an image</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#appendix-docker-cheat-sheet-__codelineno-11-8"></a>docker<span class="w"> </span>search<span class="w"> </span>&lt;image_name&gt;
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#appendix-docker-cheat-sheet-__codelineno-11-9"></a>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#appendix-docker-cheat-sheet-__codelineno-11-10"></a><span class="c1"># Pull an image from a Docker Hub</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#appendix-docker-cheat-sheet-__codelineno-11-11"></a>docker<span class="w"> </span>pull<span class="w"> </span>&lt;image_name&gt;
</span></code></pre></div>
<h2 id="appendix-docker-cheat-sheet-docker-network">Docker network</h2>
<p>This command creates a new bridge network named "network1" that containers can connect to for networked communication.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#appendix-docker-cheat-sheet-__codelineno-12-1"></a>docker<span class="w"> </span>network<span class="w"> </span>create<span class="w"> </span>-d<span class="w"> </span>bridge<span class="w"> </span>network1
</span></code></pre></div>
<h2 id="appendix-docker-cheat-sheet-clean-up-resources">Clean up resources</h2>
<p>you can use the <code>docker system prune</code> command to clean up all dangling or unused resources, including images, containers, volumes, and networks that are not tagged or connected to a running container. This command is helpful for freeing up disk space and removing unnecessary resources.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#appendix-docker-cheat-sheet-__codelineno-13-1"></a><span class="c1"># before cleaning up Docker, first check all the available resources using the following commands:</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#appendix-docker-cheat-sheet-__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#appendix-docker-cheat-sheet-__codelineno-13-3"></a>docker<span class="w">  </span>container<span class="w"> </span>ls
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#appendix-docker-cheat-sheet-__codelineno-13-4"></a>docker<span class="w">  </span>image<span class="w"> </span>ls
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#appendix-docker-cheat-sheet-__codelineno-13-5"></a>docker<span class="w">  </span>volume<span class="w"> </span>ls
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#appendix-docker-cheat-sheet-__codelineno-13-6"></a>docker<span class="w">  </span>network<span class="w"> </span>ls
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#appendix-docker-cheat-sheet-__codelineno-13-7"></a>docker<span class="w">  </span>info
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#appendix-docker-cheat-sheet-__codelineno-13-8"></a>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#appendix-docker-cheat-sheet-__codelineno-13-9"></a>docker<span class="w"> </span>system<span class="w"> </span>prune
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#appendix-docker-cheat-sheet-__codelineno-13-10"></a><span class="c1"># or</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#appendix-docker-cheat-sheet-__codelineno-13-11"></a>docker<span class="w"> </span>system<span class="w"> </span>prune<span class="w"> </span>-a
</span></code></pre></div>
<p>If you need to clean up all containers and images locally in Docker Desktop, you can use the following commands:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#appendix-docker-cheat-sheet-__codelineno-14-1"></a><span class="c1"># To delete all containers including its volumes use,</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#appendix-docker-cheat-sheet-__codelineno-14-2"></a>docker<span class="w"> </span>rm<span class="w"> </span>-vf<span class="w"> </span><span class="k">$(</span>docker<span class="w"> </span>ps<span class="w"> </span>-aq<span class="k">)</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#appendix-docker-cheat-sheet-__codelineno-14-3"></a>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#appendix-docker-cheat-sheet-__codelineno-14-4"></a><span class="c1"># To delete all volumes use,</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#appendix-docker-cheat-sheet-__codelineno-14-5"></a>docker<span class="w"> </span>volume<span class="w"> </span>rm<span class="w"> </span><span class="k">$(</span>docker<span class="w"> </span>volume<span class="w"> </span>ls<span class="w"> </span>-q<span class="k">)</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#appendix-docker-cheat-sheet-__codelineno-14-6"></a>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#appendix-docker-cheat-sheet-__codelineno-14-7"></a><span class="c1"># To delete all the images,</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#appendix-docker-cheat-sheet-__codelineno-14-8"></a>docker<span class="w"> </span>rmi<span class="w"> </span>-f<span class="w"> </span><span class="k">$(</span>docker<span class="w"> </span>images<span class="w"> </span>-aq<span class="k">)</span>
</span></code></pre></div>
<h2 id="appendix-docker-cheat-sheet-docker-compose-commands">Docker Compose Commands</h2>
<p>Below are some commonly used Docker Compose commands:</p>
<h3 id="appendix-docker-cheat-sheet-starts-services">Starts services</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#appendix-docker-cheat-sheet-__codelineno-15-1"></a>docker-compose<span class="w"> </span>up
</span></code></pre></div>
<p>Starts the services defined in your <code>docker-compose.yml</code> file. It creates and starts containers as specified in the configuration.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#appendix-docker-cheat-sheet-__codelineno-16-1"></a>docker-compose<span class="w"> </span>up<span class="w"> </span>-d
</span></code></pre></div>
<p>Starts the services in the background (detached mode).</p>
<h3 id="appendix-docker-cheat-sheet-stops-services">Stops services</h3>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#appendix-docker-cheat-sheet-__codelineno-17-1"></a>docker-compose<span class="w"> </span>down
</span></code></pre></div>
Stops and removes containers, networks, volumes, and other services defined in your <code>docker-compose.yml</code> file.</p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#appendix-docker-cheat-sheet-__codelineno-18-1"></a>docker-compose<span class="w"> </span>down<span class="w"> </span>-v
</span></code></pre></div>
Stops and removes containers, networks, volumes, and other services while also removing volumes.</p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#appendix-docker-cheat-sheet-__codelineno-19-1"></a>docker-compose<span class="w"> </span>down<span class="w"> </span>--volumes<span class="w"> </span>--rmi<span class="w"> </span>all
</span></code></pre></div>
Stops and removes containers, networks, volumes, and other services, while also removing volumes and images.    </p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#appendix-docker-cheat-sheet-__codelineno-20-1"></a>docker-compose<span class="w"> </span>stop
</span></code></pre></div>
<p>Stops the services defined in your <code>docker-compose.yml</code> file without removing them.</p>
<h3 id="appendix-docker-cheat-sheet-lists-the-containers">Lists the containers</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#appendix-docker-cheat-sheet-__codelineno-21-1"></a>docker-compose<span class="w"> </span>ps
</span></code></pre></div>
<p>Lists the containers that are part of your Docker Compose setup, showing their status.</p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#appendix-docker-cheat-sheet-__codelineno-22-1"></a>docker-compose<span class="w"> </span>ps<span class="w"> </span>-a
</span></code></pre></div>
Lists all containers, including stopped ones, that are part of your Docker Compose setup.</p>
<h3 id="appendix-docker-cheat-sheet-displays-log">Displays log</h3>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#appendix-docker-cheat-sheet-__codelineno-23-1"></a>docker-compose<span class="w"> </span>logs
</span></code></pre></div>
Displays log output from services. You can use the <code>-f</code> option to follow the logs in real-time.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#appendix-docker-cheat-sheet-__codelineno-24-1"></a>docker-compose<span class="w"> </span>logs<span class="w"> </span>webserver
</span></code></pre></div>
<p>Displays logs for a specific service.</p>
<h3 id="appendix-docker-cheat-sheet-executes-a-command">Executes a command</h3>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#appendix-docker-cheat-sheet-__codelineno-25-1"></a>docker-compose<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>webserver<span class="w"> </span>ls<span class="w"> </span>-l
</span></code></pre></div>
Executes a command in a running service container.</p>
<h3 id="appendix-docker-cheat-sheet-builds-services">Builds services</h3>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#appendix-docker-cheat-sheet-__codelineno-26-1"></a>docker-compose<span class="w"> </span>build
</span></code></pre></div>
Builds or rebuilds services defined in your <code>docker-compose.yml</code> file.</p>
<h3 id="appendix-docker-cheat-sheet-restarts-services">Restarts services</h3>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#appendix-docker-cheat-sheet-__codelineno-27-1"></a>docker-compose<span class="w"> </span>restart
</span></code></pre></div>
Restarts services.</p>
<h3 id="appendix-docker-cheat-sheet-displays-configuration">Displays configuration</h3>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#appendix-docker-cheat-sheet-__codelineno-28-1"></a>docker-compose<span class="w"> </span>config
</span></code></pre></div>
Validates and displays the configuration of your <code>docker-compose.yml</code> file.</p>
<h3 id="appendix-docker-cheat-sheet-pauses-services">Pauses services</h3>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#appendix-docker-cheat-sheet-__codelineno-29-1"></a>docker-compose<span class="w"> </span>pause
</span></code></pre></div>
Pauses all services. Containers remain running, but they stop processing requests.</p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#appendix-docker-cheat-sheet-__codelineno-30-1"></a>docker-compose<span class="w"> </span>unpause
</span></code></pre></div>
Unpauses services after they have been paused.</p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#appendix-docker-cheat-sheet-__codelineno-31-1"></a>docker-compose<span class="w"> </span>top
</span></code></pre></div>
Displays the running processes of a service.</p>
<h3 id="appendix-docker-cheat-sheet-scales-service">Scales service</h3>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#appendix-docker-cheat-sheet-__codelineno-32-1"></a>docker-compose<span class="w"> </span>scale<span class="w"> </span><span class="nv">webserver</span><span class="o">=</span><span class="m">3</span>
</span></code></pre></div>
Scales a service to the specified number of instances.</p>
<h3 id="appendix-docker-cheat-sheet-display-events">Display events</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#appendix-docker-cheat-sheet-__codelineno-33-1"></a>docker-compose<span class="w"> </span>events
</span></code></pre></div>
<h3 id="appendix-docker-cheat-sheet-docker-compose-config">docker compose config</h3>
<p>Parse, resolve and render compose file in canonical forma</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#appendix-docker-cheat-sheet-__codelineno-34-1"></a>docker-compose<span class="w"> </span>config
</span></code></pre></div>
<p>Streams real-time events from your services.</p>
<h2 id="appendix-docker-cheat-sheet-docker-commands-summary">Docker commands Summary</h2>
<h3 id="appendix-docker-cheat-sheet-basic-commands">Basic Commands</h3>
<ul>
<li><code>docker run [image]</code>: Start a new container from an image</li>
<li><code>docker ps</code>: List all running containers</li>
<li><code>docker stop [container]</code>: Stop a running container</li>
<li><code>docker rm [container]</code>: Remove a container</li>
<li><code>docker images</code>: List all available images</li>
<li><code>docker pull [image]</code>: Download an image from a registry</li>
<li><code>docker push [image]</code>: Upload an image to a registry</li>
<li><code>docker build [options] [path]</code>: Build an image from a Dockerfile</li>
</ul>
<h3 id="appendix-docker-cheat-sheet-advanced-commands">Advanced Commands</h3>
<ul>
<li><code>docker exec [container] [command]</code>: Run a command inside a running container</li>
<li><code>docker-compose up</code>: Start a Docker Compose application</li>
<li><code>docker network [subcommand]</code>: Manage Docker networks</li>
<li><code>docker volume [subcommand]</code>: Manage Docker volumes</li>
<li><code>docker logs [container]</code>: View the logs of a container</li>
<li><code>docker inspect [container]</code>: Inspect a container</li>
<li><code>docker diff [container]</code>: Show changes to the filesystem of a container</li>
<li><code>docker commit [container] [image]</code>: Create a new image from a container's changes</li>
<li><code>docker save [image]</code>: Save an image to a tar archive</li>
<li><code>docker load</code>: Load an image from a tar archive</li>
</ul>
<h2 id="appendix-docker-cheat-sheet-references">References</h2>
<ul>
<li><a href="https://docs.docker.com/compose/reference/" target="_blank">Overview of docker compose CLI</a></li>
</ul>
<!-- 

- <https://docs.docker.com/get-started/docker_cheatsheet.pdf> 

--></section><section class="print-page" id="appendix-dockerfile-cheat-sheet" heading-number="4.3"><h1 id="appendix-dockerfile-cheat-sheet-dockerfile-commands">Dockerfile Commands</h1>
<h2 id="appendix-dockerfile-cheat-sheet-introduction">Introduction</h2>
<p>In this article, I am going to present a comprehensive cheat sheet of commonly used <code>Dockerfile</code> commands</p>
<h2 id="appendix-dockerfile-cheat-sheet-dockerfile">Dockerfile</h2>
<p>A Dockerfile is a text document that contains instructions for building a Docker image. Docker can automatically build images by interpreting instructions from a Dockerfile. This page outlines the commands available for use within a Dockerfile."</p>
<h2 id="appendix-dockerfile-cheat-sheet-1-from">1. FROM</h2>
<p>Specifies the base image for your Docker image.
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-0-1"></a><span class="k">FROM</span><span class="w"> </span><span class="s">&lt;image&gt;[:&lt;tag&gt;]</span><span class="w"> </span><span class="o">[</span>AS<span class="w"> </span>&lt;name&gt;<span class="o">]</span>
</span></code></pre></div>
Example:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-1-1"></a><span class="k">FROM</span><span class="w"> </span><span class="s">mcr.microsoft.com/dotnet/sdk:5.0</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">build</span>
</span></code></pre></div></p>
<h2 id="appendix-dockerfile-cheat-sheet-2-run">2. RUN</h2>
<p>Executes commands in the shell of the container.
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-2-1"></a><span class="k">RUN</span><span class="w"> </span>&lt;command&gt;
</span></code></pre></div>
Example:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-3-1"></a><span class="k">RUN</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#appendix-dockerfile-cheat-sheet-__codelineno-3-2"></a><span class="w">    </span>git
</span></code></pre></div></p>
<h2 id="appendix-dockerfile-cheat-sheet-3-copy">3. COPY</h2>
<p>Copies files or directories from the build context to the container's filesystem.
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-4-1"></a><span class="k">COPY</span><span class="w"> </span>&lt;src&gt;<span class="w"> </span>&lt;dest&gt;
</span></code></pre></div>
Example:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-5-1"></a><span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>/app
</span></code></pre></div></p>
<h2 id="appendix-dockerfile-cheat-sheet-4-workdir">4. WORKDIR</h2>
<p>Sets the working directory for any RUN, CMD, ENTRYPOINT, COPY, and ADD instructions that follow it.
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-6-1"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/path/to/directory</span>
</span></code></pre></div>
Example:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-7-1"></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/app</span>
</span></code></pre></div></p>
<h2 id="appendix-dockerfile-cheat-sheet-5-cmd">5. CMD</h2>
<p>Specifies the default command to run when the container starts.
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-8-1"></a><span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;executable&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;param1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;param2&quot;</span><span class="p">]</span>
</span></code></pre></div>
Example:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-9-1"></a><span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;dotnet&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;MyApi.dll&quot;</span><span class="p">]</span>
</span></code></pre></div></p>
<h2 id="appendix-dockerfile-cheat-sheet-6-entrypoint">6. ENTRYPOINT</h2>
<p>Specifies the command to run when the container starts, allowing arguments to be passed.
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-10-1"></a><span class="k">ENTRYPOINT</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;executable&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;param1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;param2&quot;</span><span class="p">]</span>
</span></code></pre></div>
Example:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-11-1"></a><span class="k">ENTRYPOINT</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;dotnet&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;MyApi.dll&quot;</span><span class="p">]</span>
</span></code></pre></div></p>
<h2 id="appendix-dockerfile-cheat-sheet-7-expose">7. EXPOSE</h2>
<p>Informs Docker that the container listens on specific network ports at runtime.
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-12-1"></a><span class="k">EXPOSE</span><span class="w"> </span><span class="s">&lt;port&gt; [&lt;port&gt;/&lt;protocol&gt;...]</span>
</span></code></pre></div>
Example:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-13-1"></a><span class="k">EXPOSE</span><span class="w"> </span><span class="s">80</span>
</span></code></pre></div></p>
<h2 id="appendix-dockerfile-cheat-sheet-8-env">8. ENV</h2>
<p>Sets environment variables.
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-14-1"></a><span class="k">ENV</span><span class="w"> </span>&lt;key&gt;<span class="w"> </span>&lt;value&gt;
</span></code></pre></div>
Example:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-15-1"></a><span class="k">ENV</span><span class="w"> </span><span class="nv">ASPNETCORE_ENVIRONMENT</span><span class="o">=</span>Production
</span></code></pre></div></p>
<h2 id="appendix-dockerfile-cheat-sheet-9-arg">9. ARG</h2>
<p>Defines build-time variables.
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-16-1"></a><span class="k">ARG</span><span class="w"> </span>&lt;name&gt;<span class="o">[=</span>&lt;default<span class="w"> </span>value&gt;<span class="o">]</span>
</span></code></pre></div>
Example:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-17-1"></a><span class="k">ARG</span><span class="w"> </span>CONNECTION_STRING
</span></code></pre></div></p>
<h2 id="appendix-dockerfile-cheat-sheet-10-volume">10. VOLUME</h2>
<p>Creates a mount point and marks it as holding externally mounted volumes from native host or other containers.
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-18-1"></a><span class="k">VOLUME</span><span class="w"> </span><span class="s">/path/to/volume</span>
</span></code></pre></div>
Example:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-19-1"></a><span class="k">VOLUME</span><span class="w"> </span><span class="s">/var/log/app</span>
</span></code></pre></div></p>
<h2 id="appendix-dockerfile-cheat-sheet-11-label">11. LABEL</h2>
<p>Adds metadata to an image.
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-20-1"></a><span class="k">LABEL</span><span class="w"> </span>&lt;key&gt;<span class="o">=</span>&lt;value&gt;<span class="w"> </span>&lt;key&gt;<span class="o">=</span>&lt;value&gt;<span class="w"> </span>...
</span></code></pre></div>
Example:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-21-1"></a><span class="k">LABEL</span><span class="w"> </span><span class="nv">maintainer</span><span class="o">=</span><span class="s2">&quot;John Doe &lt;john@example.com&gt;&quot;</span>
</span></code></pre></div></p>
<h2 id="appendix-dockerfile-cheat-sheet-12-user">12. USER</h2>
<p>Sets the user or UID to use when running the image.
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-22-1"></a><span class="k">USER</span><span class="w"> </span><span class="s">&lt;username | UID&gt;</span>
</span></code></pre></div>
Example:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-23-1"></a><span class="k">USER</span><span class="w"> </span><span class="s">appuser</span>
</span></code></pre></div></p>
<h2 id="appendix-dockerfile-cheat-sheet-13-healthcheck">13. HEALTHCHECK</h2>
<p>Defines a command to periodically check the container's health.
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-24-1"></a><span class="k">HEALTHCHECK</span><span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>CMD<span class="w"> </span>&lt;command&gt;
</span></code></pre></div>
Example:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-25-1"></a><span class="k">HEALTHCHECK</span><span class="w"> </span>--interval<span class="o">=</span>30s<span class="w"> </span>--timeout<span class="o">=</span>3s<span class="w"> </span><span class="se">\</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#appendix-dockerfile-cheat-sheet-__codelineno-25-2"></a><span class="w">  </span><span class="k">CMD</span><span class="w"> </span>curl<span class="w"> </span>-f<span class="w"> </span>http://localhost/health<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</span></code></pre></div></p>
<h2 id="appendix-dockerfile-cheat-sheet-14-onbuild">14. ONBUILD</h2>
<p>Adds a trigger instruction when the image is used as the base for another build.
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-26-1"></a><span class="k">ONBUILD</span><span class="w"> </span>&lt;INSTRUCTION&gt;
</span></code></pre></div>
Example:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-27-1"></a><span class="k">ONBUILD</span><span class="w"> </span><span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>/app
</span></code></pre></div></p>
<h2 id="appendix-dockerfile-cheat-sheet-15-stopsignal">15. STOPSIGNAL</h2>
<p>Sets the system call signal that will be sent to the container to exit.
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-28-1"></a><span class="k">STOPSIGNAL</span><span class="w"> </span><span class="s">signal</span>
</span></code></pre></div>
Example:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-29-1"></a><span class="k">STOPSIGNAL</span><span class="w"> </span><span class="s">SIGTERM</span>
</span></code></pre></div></p>
<h2 id="appendix-dockerfile-cheat-sheet-16-shell">16. SHELL</h2>
<p>Overrides the default shell used for the shell form of commands.
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-30-1"></a><span class="k">SHELL</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;executable&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;parameters&quot;</span><span class="p">]</span>
</span></code></pre></div>
Example:
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-31-1"></a><span class="k">SHELL</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;/bin/bash&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-c&quot;</span><span class="p">]</span>
</span></code></pre></div></p>
<h2 id="appendix-dockerfile-cheat-sheet-cmd-vs-entrypoint">CMD vs ENTRYPOINT</h2>
<p>CMD and ENTRYPOINT are used to specify the default command to run when a container is started. However, they have different behaviors and can be used together in different ways depending on the requirements of your Docker image.</p>
<ul>
<li>
<p><strong>CMD</strong>:</p>
</li>
<li>
<p>Sets default command and/or parameters.</p>
</li>
<li>Can be overridden from the command line.</li>
<li>
<p>Last <code>CMD</code> instruction takes effect if multiple are present.</p>
</li>
<li>
<p><strong>ENTRYPOINT</strong>:</p>
</li>
<li>
<p>Specifies main executable to run.</p>
</li>
<li>Allows arguments to be passed.</li>
<li>Arguments passed to <code>docker run</code> are appended to the <code>ENTRYPOINT</code> command.</li>
<li>Last <code>ENTRYPOINT</code> instruction takes effect if multiple are present.</li>
</ul>
<p><strong>Best Practices:</strong></p>
<ul>
<li>Use <strong>CMD</strong> for default command and parameters.</li>
<li>Use <strong>ENTRYPOINT</strong> for main executable, allowing additional arguments.</li>
</ul>
<p>Example:</p>
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#appendix-dockerfile-cheat-sheet-__codelineno-32-1"></a><span class="k">ENTRYPOINT</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;dotnet&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;MyApi.dll&quot;</span><span class="p">]</span>
</span></code></pre></div>
<p>In this example, <code>dotnet MyApi.dll</code> is the main executable, with any additional arguments passed when running the container.</p>
<h2 id="appendix-dockerfile-cheat-sheet-copy-vs-add">COPY vs ADD</h2>
<p>COPY and ADD are used to copy files and directories from the host machine into the container's filesystem. While they have similar functionalities, there are some differences between them.</p>
<p><em>COPY Instruction:</em></p>
<p>The COPY instruction copies files or directories from the build context (i.e., the directory containing the Dockerfile) into the container's filesystem. It can copy local files/directories as well as files/directories from URLs. However, it does not support extracting files from compressed archives (e.g., .tar.gz).</p>
<p><em>ADD Instruction:</em></p>
<p>The ADD instruction has the same functionality as COPY, but it also supports additional features such as extracting compressed archives (e.g., .tar.gz) and copying files from URLs. However, because of these additional features, it's considered less predictable and is recommended to use COPY instead unless the extra functionality of ADD is specifically required.</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>COPY</th>
<th>ADD</th>
</tr>
</thead>
<tbody>
<tr>
<td>Functionality</td>
<td>Copies files/directories from build context</td>
<td>Same as COPY, plus supports additional features like extracting compressed archives and copying files from URLs</td>
</tr>
<tr>
<td>Predictability</td>
<td>More predictable and straightforward</td>
<td>Provides additional functionality but less predictable</td>
</tr>
<tr>
<td>Best Practice</td>
<td>Preferred for basic file copying tasks</td>
<td>Use sparingly, only when additional features are needed</td>
</tr>
</tbody>
</table>
<p>In summary, <code>COPY</code> is preferred for basic file copying tasks due to its predictability, while <code>ADD</code> offers additional functionality but should be used with caution.</p>
<!-- 
##  Summary

These are some of the most commonly used Dockerfile commands, these can be modified as per specific use cases and advanced scenarios.

1. `FROM`: Specifies the base image for subsequent instructions.
2. `COPY`: Copies files or directories from the build context into the image.
3. `ADD`: Similar to `COPY`, but can also fetch files from remote URLs and extract tar archives.
4. `RUN`: Executes commands in the shell within the image.
5. `WORKDIR`: Sets the working directory for subsequent instructions.
6. `ENV`: Sets environment variables in the image.
7. `EXPOSE`: Declares the ports on which the container listens for connections.
8. `CMD`: Specifies the default command to run when the container starts.
9. `ENTRYPOINT`: Configures the primary command to execute when the container starts.
10. `ARG`: Defines build-time variables.
11. `LABEL`: Adds metadata to the image.
12. `VOLUME`: Creates a mount point and marks it as externally mounted.
13. `USER`: Sets the user or UID to use when running the container.
14. `STOPSIGNAL`: Sets the system call signal that will be sent to the container to stop it.
15. `HEALTHCHECK`: Defines a command to check the container's health status.
16. `SHELL`: Specifies the default shell used for executing commands.
17. `MAINTAINER`: Sets the author field of the generated images.
18. `ONBUILD`: Adds a trigger instruction for when the image is used as a base for another build. -->

<h2 id="appendix-dockerfile-cheat-sheet-references">References</h2>
<ul>
<li><a href="https://docs.docker.com/engine/reference/builder/#overview" target="_blank">Dockerfile reference</a></li>
</ul>
<!-- 

- <https://docs.docker.com/get-started/docker_cheatsheet.pdf> 

--></section></section></div><style>.print-site-enumerate-headings #section-1 > h1:before { content: '1 ' }
.print-site-enumerate-headings #section-2 > h1:before { content: '2 ' }
.print-site-enumerate-headings #introduction-toc > h1:before { content: '2.1 ' }

                .print-site-enumerate-headings #introduction-toc h2:before { content: '2.1.' counter(counter-introduction-toc-2) ' ' }
                .print-site-enumerate-headings #introduction-toc h2 {  counter-increment: counter-introduction-toc-2 }
            
.print-site-enumerate-headings #introduction-about-author > h1:before { content: '2.2 ' }

                .print-site-enumerate-headings #introduction-about-author h2:before { content: '2.2.' counter(counter-introduction-about-author-2) ' ' }
                .print-site-enumerate-headings #introduction-about-author h2 {  counter-increment: counter-introduction-about-author-2 }
            
.print-site-enumerate-headings #introduction-acknowledgments > h1:before { content: '2.3 ' }

                .print-site-enumerate-headings #introduction-acknowledgments h2:before { content: '2.3.' counter(counter-introduction-acknowledgments-2) ' ' }
                .print-site-enumerate-headings #introduction-acknowledgments h2 {  counter-increment: counter-introduction-acknowledgments-2 }
            
.print-site-enumerate-headings #introduction-introduction > h1:before { content: '2.4 ' }

                .print-site-enumerate-headings #introduction-introduction h2:before { content: '2.4.' counter(counter-introduction-introduction-2) ' ' }
                .print-site-enumerate-headings #introduction-introduction h2 {  counter-increment: counter-introduction-introduction-2 }
            
.print-site-enumerate-headings #section-3 > h1:before { content: '3 ' }
.print-site-enumerate-headings #microservices-1.getting-started > h1:before { content: '3.1 ' }

                .print-site-enumerate-headings #microservices-1.getting-started h2:before { content: '3.1.' counter(counter-microservices-1.getting-started-2) ' ' }
                .print-site-enumerate-headings #microservices-1.getting-started h2 {  counter-increment: counter-microservices-1.getting-started-2 }
            
.print-site-enumerate-headings #microservices-2.docker-fundamentals > h1:before { content: '3.2 ' }

                .print-site-enumerate-headings #microservices-2.docker-fundamentals h2:before { content: '3.2.' counter(counter-microservices-2.docker-fundamentals-2) ' ' }
                .print-site-enumerate-headings #microservices-2.docker-fundamentals h2 {  counter-increment: counter-microservices-2.docker-fundamentals-2 }
            
.print-site-enumerate-headings #microservices-3-docker-getting-started > h1:before { content: '3.3 ' }

                .print-site-enumerate-headings #microservices-3-docker-getting-started h2:before { content: '3.3.' counter(counter-microservices-3-docker-getting-started-2) ' ' }
                .print-site-enumerate-headings #microservices-3-docker-getting-started h2 {  counter-increment: counter-microservices-3-docker-getting-started-2 }
            
.print-site-enumerate-headings #microservices-4.aspnet-api > h1:before { content: '3.4 ' }

                .print-site-enumerate-headings #microservices-4.aspnet-api h2:before { content: '3.4.' counter(counter-microservices-4.aspnet-api-2) ' ' }
                .print-site-enumerate-headings #microservices-4.aspnet-api h2 {  counter-increment: counter-microservices-4.aspnet-api-2 }
            
.print-site-enumerate-headings #microservices-5.node-api > h1:before { content: '3.5 ' }

                .print-site-enumerate-headings #microservices-5.node-api h2:before { content: '3.5.' counter(counter-microservices-5.node-api-2) ' ' }
                .print-site-enumerate-headings #microservices-5.node-api h2 {  counter-increment: counter-microservices-5.node-api-2 }
            
.print-site-enumerate-headings #microservices-6.aspnet-app > h1:before { content: '3.6 ' }

                .print-site-enumerate-headings #microservices-6.aspnet-app h2:before { content: '3.6.' counter(counter-microservices-6.aspnet-app-2) ' ' }
                .print-site-enumerate-headings #microservices-6.aspnet-app h2 {  counter-increment: counter-microservices-6.aspnet-app-2 }
            
.print-site-enumerate-headings #microservices-7.react-app > h1:before { content: '3.7 ' }

                .print-site-enumerate-headings #microservices-7.react-app h2:before { content: '3.7.' counter(counter-microservices-7.react-app-2) ' ' }
                .print-site-enumerate-headings #microservices-7.react-app h2 {  counter-increment: counter-microservices-7.react-app-2 }
            
.print-site-enumerate-headings #microservices-8.sqlserver-db > h1:before { content: '3.8 ' }

                .print-site-enumerate-headings #microservices-8.sqlserver-db h2:before { content: '3.8.' counter(counter-microservices-8.sqlserver-db-2) ' ' }
                .print-site-enumerate-headings #microservices-8.sqlserver-db h2 {  counter-increment: counter-microservices-8.sqlserver-db-2 }
            
.print-site-enumerate-headings #microservices-9.postgresql-db > h1:before { content: '3.9 ' }

                .print-site-enumerate-headings #microservices-9.postgresql-db h2:before { content: '3.9.' counter(counter-microservices-9.postgresql-db-2) ' ' }
                .print-site-enumerate-headings #microservices-9.postgresql-db h2 {  counter-increment: counter-microservices-9.postgresql-db-2 }
            
.print-site-enumerate-headings #microservices-10.keycloak > h1:before { content: '3.10 ' }

                .print-site-enumerate-headings #microservices-10.keycloak h2:before { content: '3.10.' counter(counter-microservices-10.keycloak-2) ' ' }
                .print-site-enumerate-headings #microservices-10.keycloak h2 {  counter-increment: counter-microservices-10.keycloak-2 }
            
.print-site-enumerate-headings #microservices-11.drupal > h1:before { content: '3.11 ' }

                .print-site-enumerate-headings #microservices-11.drupal h2:before { content: '3.11.' counter(counter-microservices-11.drupal-2) ' ' }
                .print-site-enumerate-headings #microservices-11.drupal h2 {  counter-increment: counter-microservices-11.drupal-2 }
            
.print-site-enumerate-headings #section-4 > h1:before { content: '4 ' }
.print-site-enumerate-headings #appendix-git-cheat-sheet > h1:before { content: '4.1 ' }

                .print-site-enumerate-headings #appendix-git-cheat-sheet h2:before { content: '4.1.' counter(counter-appendix-git-cheat-sheet-2) ' ' }
                .print-site-enumerate-headings #appendix-git-cheat-sheet h2 {  counter-increment: counter-appendix-git-cheat-sheet-2 }
            
.print-site-enumerate-headings #appendix-docker-cheat-sheet > h1:before { content: '4.2 ' }

                .print-site-enumerate-headings #appendix-docker-cheat-sheet h2:before { content: '4.2.' counter(counter-appendix-docker-cheat-sheet-2) ' ' }
                .print-site-enumerate-headings #appendix-docker-cheat-sheet h2 {  counter-increment: counter-appendix-docker-cheat-sheet-2 }
            
.print-site-enumerate-headings #appendix-dockerfile-cheat-sheet > h1:before { content: '4.3 ' }

                .print-site-enumerate-headings #appendix-dockerfile-cheat-sheet h2:before { content: '4.3.' counter(counter-appendix-dockerfile-cheat-sheet-2) ' ' }
                .print-site-enumerate-headings #appendix-dockerfile-cheat-sheet h2 {  counter-increment: counter-appendix-dockerfile-cheat-sheet-2 }
            </style>









  




                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 <a href="https://anjikeesari.com/"  target="_blank" rel="noopener">Anji Keesari</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/in" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.instagram.com/" target="_blank" rel="noopener" title="www.instagram.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141m0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7m146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8m76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8M398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "/microservices/", "features": ["content.code.copy", "content.code.annotate", "navigation.indexes", "navigation.footer", "content.tooltips", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "navigation.instant", "navigation.tracking", "header.autohide", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
  </body>
</html>